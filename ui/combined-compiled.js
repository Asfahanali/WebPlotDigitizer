var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,b){c!=Array.prototype&&c!=Object.prototype&&(c[a]=b.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var a=0;return $jscomp.iteratorPrototype(function(){return a<c.length?{done:!1,value:c[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.iteratorFromArray=function(c,a){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var b=0,d={next:function(){if(b<c.length){var e=b++;return{value:a(e,c[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(c,a,b,d){if(a){b=$jscomp.global;c=c.split(".");for(d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.checkStringArgs=function(c,a,b){if(null==c)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return c+""};
$jscomp.polyfill("String.prototype.startsWith",function(c){return c?c:function(a,b){var c=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=c.length,f=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var h=0;h<f&&b<e;)if(c[b++]!=a[h++])return!1;return h>=f}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(c){return c?c:function(a,b,c){var e=this.length||0;0>b&&(b=Math.max(0,e+b));if(null==c||c>e)c=e;c=Number(c);0>c&&(c=Math.max(0,e+c));for(b=Number(b||0);b<c;b++)this[b]=a;return this}},"es6-impl","es3");$jscomp.findInternal=function(c,a,b){c instanceof String&&(c=String(c));for(var d=c.length,e=0;e<d;e++){var f=c[e];if(a.call(b,f,e,c))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.findIndex",function(c){return c?c:function(a,b){return $jscomp.findInternal(this,a,b).i}},"es6-impl","es3");$jscomp.polyfill("String.prototype.endsWith",function(c){return c?c:function(a,b){var c=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===b&&(b=c.length);b=Math.max(0,Math.min(b|0,c.length));for(var e=a.length;0<e&&0<b;)if(c[--b]!=a[--e])return!1;return 0>=e}},"es6-impl","es3");
$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();var a=c[Symbol.iterator];return a?a.call(c):$jscomp.arrayIterator(c)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(c){function a(){this.batch_=null}function b(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(c&&!$jscomp.FORCE_POLYFILL_PROMISE)return c;a.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};a.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(a){d(a,
0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};a.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(e){c||(c=!0,a.call(b,e))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new a;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(u){f(u)}}:b}var d,f,h=new e(function(a,
b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return h};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};e.resolve=b;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(c,
e){for(var d=$jscomp.makeIterator(a),f=d.next();!f.done;f=d.next())b(f.value).callWhenSettled_(c,e)})};e.all=function(a){var c=$jscomp.makeIterator(a),d=c.next();return d.done?b([]):new e(function(a,e){function f(b){return function(c){h[b]=c;g--;0==g&&a(h)}}var h=[],g=0;do h.push(void 0),g++,b(d.value).callWhenSettled_(f(h.length-1),e),d=c.next();while(!d.done)})};return e},"es6-impl","es3");var wpd=wpd||{};
wpd.initApp=function(){wpd.browserInfo.checkBrowser();wpd.layoutManager.initialLayout();wpd.loadRemoteData()||wpd.imageManager.loadFromURL("start.png");document.getElementById("loadingCurtain").style.display="none"};
wpd.loadRemoteData=function(){return"undefined"===typeof wpdremote?!1:null!=wpdremote.status&&"fail"===wpdremote.status?(wpd.messagePopup.show("Remote Upload Failed!","Remote Upload Failed!"),!1):"success"===wpdremote.status&&null!=wpdremote.localUrl?(wpd.imageManager.loadFromURL(wpdremote.localUrl),wpd.popup.show("axesList"),!0):!1};document.addEventListener("DOMContentLoaded",wpd.initApp,!0);wpd=wpd||{};
wpd.appData=function(){function c(){null==b&&(b=new wpd.PlotData);return b}var a=!1,b;return{isAligned:function(b){null!=b&&(a=b);return a},getPlotData:c,reset:function(){a=!1;b=null},plotLoaded:function(a){c().topColors=wpd.colorAnalyzer.getTopColors(a)}}}();wpd=wpd||{};
wpd.AutoDetector=function(){return function(){this.fgColor=[0,0,200];this.bgColor=[255,255,255];this.mask=null;this.gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};this.gridLineColor=[255,255,255];this.gridColorDistance=10;this.gridData=null;this.colorDetectionMode="fg";this.colorDistance=120;this.imageData=this.gridBinaryData=this.binaryData=this.algorithm=null;this.imageHeight=this.imageWidth=0;this.gridBackgroundMode=!0;this.reset=function(){this.gridData=this.imageData=this.binaryData=
this.mask=null;this.gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]}};this.generateBinaryDataFromMask=function(){var c,a="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(c=0;c<this.mask.length;c++){var b=this.mask[c];var d=this.imageData.data[4*b];var e=this.imageData.data[4*b+1];var f=this.imageData.data[4*b+2];var h=this.imageData.data[4*b+3];0===h&&(f=e=d=255);d=wpd.dist3d(d,e,f,a[0],a[1],a[2]);"fg"===this.colorDetectionMode?d<=this.colorDistance&&(this.binaryData[b]=!0):
d>=this.colorDistance&&(this.binaryData[b]=!0)}};this.generateBinaryDataUsingFullImage=function(){var c,a="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(c=0;c<this.imageData.data.length/4;c++){var b=this.imageData.data[4*c];var d=this.imageData.data[4*c+1];var e=this.imageData.data[4*c+2];var f=this.imageData.data[4*c+3];0===f&&(e=d=b=255);b=wpd.dist3d(b,d,e,a[0],a[1],a[2]);"fg"===this.colorDetectionMode?b<=this.colorDistance&&(this.binaryData[c]=!0):b>=this.colorDistance&&(this.binaryData[c]=
!0)}};this.generateBinaryData=function(){this.binaryData=[];null==this.imageData?this.imageWidth=this.imageHeight=0:(this.imageHeight=this.imageData.height,this.imageWidth=this.imageData.width,null==this.mask||0===this.mask.length?this.generateBinaryDataUsingFullImage():this.generateBinaryDataFromMask())};this.generateGridBinaryData=function(){this.gridBinaryData=[];if(null==this.imageData)this.imageHeight=this.imageWidth=0;else{this.imageWidth=this.imageData.width;this.imageHeight=this.imageData.height;
var c,a;if(null==this.gridMask.pixels||0===this.gridMask.pixels.length){var b=0;this.gridMask.pixels=[];for(a=0;a<this.imageHeight;a++)for(c=0;c<this.imageWidth;c++){var d=a*this.imageWidth+c;var e=this.imageData.data[4*d];var f=this.imageData.data[4*d+1];var h=this.imageData.data[4*d+2];var g=this.imageData.data[4*d+3];0===g&&(h=f=e=255);e=wpd.dist3d(this.gridLineColor[0],this.gridLineColor[1],this.gridLineColor[2],e,f,h);this.gridBackgroundMode?e>this.gridColorDistance&&(this.gridBinaryData[d]=
!0,this.gridMask.pixels[b]=d,b++):e<this.gridColorDistance&&(this.gridBinaryData[d]=!0,this.gridMask.pixels[b]=d,b++)}this.gridMask.xmin=0;this.gridMask.xmax=this.imageWidth;this.gridMask.ymin=0;this.gridMask.ymax=this.imageHeight}else for(b=0;b<this.gridMask.pixels.length;b++)d=this.gridMask.pixels[b],e=this.imageData.data[4*d],f=this.imageData.data[4*d+1],h=this.imageData.data[4*d+2],e=wpd.dist3d(this.gridLineColor[0],this.gridLineColor[1],this.gridLineColor[2],e,f,h),this.gridBackgroundMode?e>
this.gridColorDistance&&(this.gridBinaryData[d]=!0):e<this.gridColorDistance&&(this.gridBinaryData[d]=!0)}}}}();wpd=wpd||{};
wpd.Calibration=function(){return function(c){var a=[],b=[],d=null==c?2:c,e=[],f=[];this.labels=[];this.getCount=function(){return a.length};this.getDimensions=function(){return d};this.addPoint=function(c,f,k,l,m){var h=a.length,g=e.length;a[h]=c;b[h]=f;e[g]=k;e[g+1]=l;3===d&&(e[g+2]=m)};this.getPoint=function(c){return 0>c||c>=a.length?null:{px:a[c],py:b[c],dx:e[d*c],dy:e[d*c+1],dz:2===d?null:e[d*c+2]}};this.changePointPx=function(c,e,d){0>c||c>=a.length||(a[c]=e,b[c]=d)};this.setDataAt=function(b,
c,f,l){0>b||b>=a.length||(e[d*b]=c,e[d*b+1]=f,3===d&&(e[d*b+2]=l))};this.findNearestPoint=function(c,e,d){d=null==d?50:parseFloat(d);var f=-1,h;for(h=0;h<a.length;h++){var g=Math.sqrt((c-a[h])*(c-a[h])+(e-b[h])*(e-b[h]));if(0>f&&g<=d||0<=f&&g<k){f=h;var k=g}}return f};this.selectPoint=function(a){0>f.indexOf(a)&&(f[f.length]=a)};this.selectNearestPoint=function(a,b,c){a=this.findNearestPoint(a,b,c);0<=a&&this.selectPoint(a)};this.getSelectedPoints=function(){return f};this.unselectAll=function(){f=
[]};this.isPointSelected=function(a){return 0<=f.indexOf(a)};this.dump=function(){console.log(a);console.log(b);console.log(e)}}}();wpd=wpd||{};
wpd.ColorGroup=function(){return function(c){var a=0,b={r:0,g:0,b:0};c=null==c?100:c;this.getPixelCount=function(){return a};this.getAverageColor=function(){return b};this.isColorInGroup=function(d,e,f){return 0===a?!0:(b.r-d)*(b.r-d)+(b.g-e)*(b.g-e)+(b.b-f)*(b.b-f)<=c*c};this.addPixel=function(c,e,f){b.r=(b.r*a+c)/(a+1);b.g=(b.g*a+e)/(a+1);b.b=(b.b*a+f)/(a+1);a+=1}}}();
wpd.colorAnalyzer=function(){return{getTopColors:function(c){var a=[],b,d=[];a[0]=new wpd.ColorGroup(120);for(b=0;b<c.data.length;b+=4){var e=c.data[b];var f=c.data[b+1];var h=c.data[b+2];var g=c.data[b+3];0===g&&(h=f=e=255);var k=!1;for(g=0;g<a.length;g++)if(a[g].isColorInGroup(e,f,h)){a[g].addPixel(e,f,h);k=!0;break}k||(a[a.length]=new wpd.ColorGroup(120),a[a.length-1].addPixel(e,f,h))}a.sort(function(a,b){return a.getPixelCount()>b.getPixelCount()?-1:a.getPixelCount()<b.getPixelCount()?1:0});for(g=
0;g<a.length;g++)b=a[g].getAverageColor(),d[g]={r:parseInt(b.r,10),g:parseInt(b.g,10),b:parseInt(b.b,10),pixels:a[g].getPixelCount(),percentage:100*a[g].getPixelCount()/(.25*c.data.length)};return d}}}();wpd=wpd||{};
wpd.ConnectedPoints=function(){return function(c){var a=[],b=-1,d=-1;this.addConnection=function(b){a[a.length]=b};this.clearAll=function(){a=[]};this.getConnectionAt=function(b){if(b<a.length)return a[b]};this.replaceConnectionAt=function(b,c){b<a.length&&(a[b]=c)};this.deleteConnectionAt=function(b){b<a.length&&a.splice(b,1)};this.connectionCount=function(){return a.length};this.getDistance=function(b){if(b<a.length&&2===c)return Math.sqrt((a[b][0]-a[b][2])*(a[b][0]-a[b][2])+(a[b][1]-a[b][3])*(a[b][1]-
a[b][3]))};this.getAngle=function(b){if(b<a.length&&3===c){var e=wpd.taninverse(-(a[b][5]-a[b][3]),a[b][4]-a[b][2]);b=wpd.taninverse(-(a[b][1]-a[b][3]),a[b][0]-a[b][2]);e=180*(e-b)/Math.PI;return 0>e?e+360:e}};this.getOpenSpline=function(a){return null};this.getClosedSpline=function(a){return null};this.openPathLength=function(a){return 0};this.closedPathLength=function(a){return 0};this.closedPathArea=function(a){return 0};this.findNearestPointAndConnection=function(b,d){var e=-1,f=-1,k,l;for(k=
0;k<a.length;k++)for(l=0;l<2*c;l+=2){var m=(a[k][l]-b)*(a[k][l]-b)+(a[k][l+1]-d)*(a[k][l+1]-d);if(-1===f||m<n){e=k;f=l/2;var n=m}}return{connectionIndex:e,pointIndex:f}};this.selectNearestPoint=function(a,c){a=this.findNearestPointAndConnection(a,c);0<=a.connectionIndex&&(b=a.connectionIndex,d=a.pointIndex)};this.deleteNearestConnection=function(a,b){a=this.findNearestPointAndConnection(a,b);0<=a.connectionIndex&&this.deleteConnectionAt(a.connectionIndex)};this.isPointSelected=function(a,c){return d===
c&&b===a?!0:!1};this.getSelectedConnectionAndPoint=function(){return{connectionIndex:b,pointIndex:d}};this.unselectConnectionAndPoint=function(){d=b=-1};this.setPointAt=function(b,c,d,g){a[b][2*c]=d;a[b][2*c+1]=g};this.getPointAt=function(b,c){return{x:a[b][2*c],y:a[b][2*c+1]}}}}();wpd=wpd||{};
wpd.DataSeries=function(){return function(c){var a=[],b=[],d=!1,e=[];this.name="Default Dataset";this.variableNames=["x","y"];this.hasMetadata=function(){return d};this.setMetadataKeys=function(a){e=a};this.getMetadataKeys=function(){return e};this.addPixel=function(b,c,e){a[a.length]={x:b,y:c,metadata:e};null!=e&&(d=!0)};this.getPixel=function(b){return a[b]};this.setPixelAt=function(b,c,d){b<a.length&&(a[b].x=c,a[b].y=d)};this.setMetadataAt=function(b,c){b<a.length&&(a[b].metadata=c)};this.insertPixel=
function(b,c,d,e){a.splice(b,0,{x:c,y:d,metadata:e})};this.removePixelAtIndex=function(b){b<a.length&&a.splice(b,1)};this.removeLastPixel=function(){this.removePixelAtIndex(a.length-1)};this.findNearestPixel=function(b,c,d){d=null==d?50:parseFloat(d);var e=-1,f;for(f=0;f<a.length;f++){var h=Math.sqrt((b-a[f].x)*(b-a[f].x)+(c-a[f].y)*(c-a[f].y));if(0>e&&h<=d||0<=e&&h<g){e=f;var g=h}}return e};this.removeNearestPixel=function(b,a,c){b=this.findNearestPixel(b,a,c);0<=b&&this.removePixelAtIndex(b)};this.clearAll=
function(){a=[];d=!1;e=[]};this.getCount=function(){return a.length};this.selectPixel=function(a){0<=b.indexOf(a)||(b[b.length]=a)};this.unselectAll=function(){b=[]};this.selectNearestPixel=function(b,a,c){b=this.findNearestPixel(b,a,c);0<=b&&this.selectPixel(b);return b};this.selectNextPixel=function(){for(var c=0;c<b.length;c++)b[c]=(b[c]+1)%a.length};this.selectPreviousPixel=function(){var c;for(c=0;c<b.length;c++){var d=b[c];d=0===d?a.length-1:d-1;b[c]=d}};this.getSelectedPixels=function(){return b}}}();
wpd=wpd||{};
wpd.dateConverter=function(){function c(b){b=b.toString();var a=b.split("/");if(0>=a.length||3<a.length)return null;b=parseInt(a[0],10);var c=parseInt(void 0===a[1]?0:a[1],10);date=parseInt(void 0===a[2]?1:a[2],10);if(isNaN(b)||isNaN(c)||isNaN(date)||12<c||1>c||31<date||1>date)return null;a=new Date;a.setUTCFullYear(b);a.setUTCMonth(c-1);a.setUTCDate(date);b=parseFloat(Date.parse(a));return isNaN(b)?null:b}function a(a,c){c=c.replace("YYYY","yyyy");c=c.replace("YY","yy");c=c.replace("MMMM","mmmm");
c=c.replace("MMM","mmm");c=c.replace("MM","mm");c=c.replace("DD","dd");c=c.replace("yyyy",a.getUTCFullYear());var b=a.getUTCFullYear()%100;c=c.replace("yy",10>b?"0"+b:b);c=c.replace("mmmm","January February March April May June July August September October November December".split(" ")[a.getUTCMonth()]);c=c.replace("mmm","Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]);c=c.replace("mm",a.getUTCMonth()+1);return c=c.replace("dd",a.getUTCDate())}return{parse:function(a){return null==
a||"string"===typeof a&&0>a.indexOf("/")?null:c(a)},getFormatString:function(a){a=a.split("/");var b="yyyy/mm/dd";1<=a.length&&(b="yyyy");2<=a.length&&(b+="/mm");3===a.length&&(b+="/dd");return b},formatDate:a,formatDateNumber:function(b,c){b=parseFloat(b);b=parseInt(864E5*Math.round(b/864E5),10);return a(new Date(b),c)}}}();wpd=wpd||{};
wpd.gridDetectionCore=function(){var c,a,b=.1,d=.1;return{run:function(){var e=[],f,h,g=wpd.appData.getPlotData().getAutoDetector(),k=g.gridMask.xmin,l=g.gridMask.xmax,m=g.gridMask.ymin,n=g.gridMask.ymax,p=g.imageWidth;if(a)for(f=k;f<=l;f++){var r=0;for(h=m;h<n;h++)!0===g.gridBinaryData[h*p+f]&&r++;if(r>d*(n-m))for(h=m;h<n;h++)e[h*p+f]=!0}if(c)for(h=m;h<=n;h++){r=0;for(f=k;f<=l;f++)!0===g.gridBinaryData[h*p+f]&&r++;if(r>b*(l-k))for(f=k;f<=l;f++)e[h*p+f]=!0}wpd.appData.getPlotData().gridData=e},setHorizontalParameters:function(a,
b){c=a;d=Math.abs(parseFloat(b)/100)},setVerticalParameters:function(c,d){a=c;b=Math.abs(parseFloat(d)/100)}}}();wpd=wpd||{};
wpd.InputParser=function(){return function(){this.parse=function(c){this.isDate=this.isValid=!1;this.formatting=null;if(null==c||"string"===typeof c&&(c=c.trim(),0<=c.indexOf("^")))return null;var a=wpd.dateConverter.parse(c);if(null!=a)return this.isDate=this.isValid=!0,this.formatting=wpd.dateConverter.getFormatString(c),a;c=parseFloat(c);return isNaN(c)?null:(this.isValid=!0,c)};this.isDate=this.isValid=!1;this.formatting=null}}();wpd=wpd||{};
wpd.taninverse=function(c,a){var b;0<c?b=Math.atan2(c,a):0>=c&&(b=Math.atan2(c,a)+2*Math.PI);b>=2*Math.PI&&(b=0);return b};wpd.sqDist2d=function(c,a,b,d){return(c-b)*(c-b)+(a-d)*(a-d)};wpd.sqDist3d=function(c,a,b,d,e,f){return(c-d)*(c-d)+(a-e)*(a-e)+(b-f)*(b-f)};wpd.dist2d=function(c,a,b,d){return Math.sqrt(wpd.sqDist2d(c,a,b,d))};wpd.dist3d=function(c,a,b,d,e,f){return Math.sqrt(wpd.sqDist3d(c,a,b,d,e,f))};
wpd.mat=function(){function c(a){return a[0]*a[3]-a[1]*a[2]}return{det2x2:c,inv2x2:function(a){var b=c(a);return[a[3]/b,-a[1]/b,-a[2]/b,a[0]/b]},mult2x2:function(a,b){return[a[0]*b[0]+a[1]*b[2],a[0]*b[1]+a[1]*b[3],a[2]*b[0]+a[3]*b[2],a[2]*b[1]+a[3]*b[3]]},mult2x2Vec:function(a,b){return[a[0]*b[0]+a[1]*b[1],a[2]*b[0]+a[3]*b[1]]},multVec2x2:function(a,b){return[b[0]*a[0]+b[2]*a[1],b[1]*a[0]+b[3]*a[1]]}}}();
wpd.cspline=function(c,a){var b=c.length;c={x:c,y:a,len:b,d:[]};var d=[],e=[],f;if(3>b)return null;e[0]=2;d[0]=3*(a[1]-a[0]);for(f=1;f<b-1;++f)e[f]=4-1/e[f-1],d[f]=3*(a[f+1]-a[f-1])-d[f-1]/e[f-1];e[b-1]=2-1/e[b-2];d[b-1]=3*(a[b-1]-a[b-2])-d[b-2]/e[b-1];f=b-1;for(c.d[f]=d[f]/e[f];0<f;)--f,c.d[f]=(d[f]-c.d[f+1])/e[f];return c};
wpd.cspline_interp=function(c,a){var b=0;if(a>=c.x[c.len-1]||a<c.x[0])return null;for(;a>c.x[b];)b++;b=0<b?b-1:0;a=(a-c.x[b])/(c.x[b+1]-c.x[b]);return c.y[b]+c.d[b]*a+(3*(c.y[b+1]-c.y[b])-2*c.d[b]-c.d[b+1])*a*a+(2*(c.y[b]-c.y[b+1])+c.d[b]+c.d[b+1])*a*a*a};wpd=wpd||{};
wpd.PlotData=function(){return function(){var c=0,a=new wpd.AutoDetector;this.axes=this.topColors=null;this.dataSeriesColl=[];this.backupImageData=this.closedPathMeasurementData=this.openPathMeasurementData=this.distanceMeasurementData=this.angleMeasurementData=this.calibration=this.gridData=null;this.getActiveDataSeries=function(){null==this.dataSeriesColl[c]&&(this.dataSeriesColl[c]=new wpd.DataSeries);return this.dataSeriesColl[c]};this.getDataSeriesCount=function(){return this.dataSeriesColl.length};
this.setActiveDataSeriesIndex=function(a){c=a};this.getActiveDataSeriesIndex=function(){return c};this.getAutoDetector=function(){return a};this.getDataSeriesNames=function(){for(var a=[],c=0;c<this.dataSeriesColl.length;c++)a[c]=this.dataSeriesColl[c].name;return a};this.reset=function(){this.closedPathMeasurementData=this.openPathMeasurementData=this.distanceMeasurementData=this.angleMeasurementData=this.axes=null;this.dataSeriesColl=[];this.backupImageData=this.calibration=this.gridData=null;c=
0;a=new wpd.AutoDetector}}}();wpd=wpd||{};
wpd.AveragingWindowCore=function(){return function(c,a,b,d,e,f){this.run=function(){var h=[],g=0,k=[],l,m,n,p;f.clearAll();for(l=0;l<b;l++){var r=-1;var t=-2*e;for(m=n=0;m<a;m++)!0===c[m*b+l]&&(m>t+e?(r+=1,n=1,t=k[r]=m):(n+=1,k[r]=parseFloat((k[r]*(n-1)+m)/parseFloat(n))));if(0<=r)for(t=l+.5,m=0;m<=r;m++)n=k[m]+.5,h[g]=[],h[g][0]=parseFloat(t),h[g][1]=parseFloat(n),h[g][2]=!0,g+=1}if(0!==g){for(k=0;k<g;k++)if(!0===h[k][2]){l=!0;r=k+1;m=h[k][0];t=h[k][1];n=m;var u=t;for(p=1;!0===l&&r<g;){var w=h[r][0];
var q=h[r][1];Math.abs(w-m)<=d&&Math.abs(q-t)<=e&&!0===h[r][2]&&(n=(n*p+w)/(p+1),u=(u*p+q)/(p+1),p+=1,h[r][2]=!1);w>m+2*d&&(l=!1);r+=1}h[k][2]=!1;f.addPixel(parseFloat(n),parseFloat(u))}return f}}}}();wpd=wpd||{};
wpd.AveragingWindowAlgo=function(){return function(){var c=5,a=5;this.getParamList=function(){return[["\u0394X","Px",10],["\u0394Y","Px",10]]};this.setParam=function(b,d){0===b?c=d:1===b&&(a=d)};this.run=function(b){var d=b.getAutoDetector();b=b.getActiveDataSeries();(new wpd.AveragingWindowCore(d.binaryData,d.imageHeight,d.imageWidth,c,a,b)).run()}}}();wpd=wpd||{};
wpd.AveragingWindowWithStepSizeAlgo=function(){return function(){var c,a,b,d,e,f;this.getParamList=function(){var a=wpd.appData.isAligned(),b=wpd.appData.getPlotData().axes;return a&&b instanceof wpd.XYAxes?(a=b.getBounds(),[["X_min","Units",a.x1],["\u0394X Step","Units",.1],["X_max","Units",a.x2],["Y_min","Units",a.y3],["Y_max","Units",a.y4],["Line width","Px",30]]):[["X_min","Units",0],["\u0394X Step","Units",.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Line width","Px",30]]};
this.setParam=function(h,g){0===h?c=g:1===h?a=g:2===h?b=g:3===h?e=g:4===h?f=g:5===h&&(d=g)};this.run=function(h){var g=h.getAutoDetector(),k=h.getActiveDataSeries();h=h.axes;var l=g.imageWidth,m=g.imageHeight,n,p;k.clearAll();for(n=c;n<=b;n+=a){var r=h.dataToPixel(n,e);var t=r.x;var u=r.y;r=h.dataToPixel(n,f);var w=r.x;var q=r.y;t=Math.sqrt((q-u)*(q-u)+(w-t)*(w-t));w=(f-e)/t;u=!1;var v=q=0;var y=!1;for(p=0;p<=t;p++)r=1*-p*w+f,r=h.dataToPixel(n,r),xi_pix=r.x,yi_pix=r.y,0<=xi_pix&&xi_pix<l&&0<=yi_pix&&
yi_pix<m&&(!0===g.binaryData[parseInt(yi_pix,10)*l+parseInt(xi_pix,10)]?(!1===u&&(v=q=p,u=!0,y=!1),!0===y&&(v=p,y=!1)):!1===y&&(v=p,y=!0),!0===u&&(p>q+d||p==t-1)&&(u=!1,q>v&&(v=p),r=(q+v)/2,r=1*-r*w+f,r=h.dataToPixel(n,r),k.addPixel(parseFloat(r.x),parseFloat(r.y))))}}}}();wpd=wpd||{};
wpd.BarValue=function(){this.avgX=this.avgValBot=this.avgValTop=this.npoints=0;this.append=function(c,a,b){this.avgX=(this.npoints*this.avgX+c)/(this.npoints+1);this.avgValTop=(this.npoints*this.avgValTop+a)/(this.npoints+1);this.avgValBot=(this.npoints*this.avgValBot+b)/(this.npoints+1);this.npoints++};this.isPointInGroup=function(c,a,b,d,e){return 0===this.npoints||Math.abs(this.avgX-c)<=d&&Math.abs(this.avgValTop-a)<=e&&Math.abs(this.avgValBot-b)<=e?!0:!1}};
wpd.BarExtractionAlgo=function(){var c,a;this.getParamList=function(){return"Y"===wpd.appData.getPlotData().axes.getOrientation().axes?[["\u0394X","Px",30],["\u0394Val","Px",10]]:[["\u0394Y","Px",30],["\u0394Val","Px",10]]};this.setParam=function(b,d){0===b?c=parseFloat(d):1===b&&(a=parseFloat(d))};this.run=function(b){var d=b.getAutoDetector(),e=b.getActiveDataSeries(),f=b.axes.getOrientation(),h=[],g,k,l,m=d.imageWidth,n=d.imageHeight,p,r,t=function(b,e,d){p=!1;for(r=0;r<h.length;r++)if(q=h[r],
q.isPointInGroup(b,e,d,c,a)){q.append(b,e,d);p=!0;break}p||(q=new wpd.BarValue,q.append(b,e,d),h.push(q))};e.clearAll();if("Y"===f.axes)for(k=0;k<m;k++){var u=0;var w=n-1;for(l=g=0;l<n;l++)if(d.binaryData[l*m+k]){u=l;g++;break}for(l=n-1;0<=l;l--)if(d.binaryData[l*m+k]){w=l;g++;break}2===g&&t(k,u,w)}else for(l=0;l<n;l++){u=m-1;g=w=0;for(k=m-1;0<=k;k--)if(d.binaryData[l*m+k]){u=k;g++;break}for(k=0;k<m;k++)if(d.binaryData[l*m+k]){w=k;g++;break}2===g&&t(l,u,w)}b.axes.dataPointsHaveLabels&&(d=e.getMetadataKeys(),
null!=d&&"Label"===d[0]||e.setMetadataKeys(["Label"]));for(r=0;r<h.length;r++){var q=h[r];"Y"===f.axes?(u=b.axes.pixelToData(q.avgX,q.avgValTop)[0],w=b.axes.pixelToData(q.avgX,q.avgValBot)[0]):(u=b.axes.pixelToData(q.avgValTop,q.avgX)[0],w=b.axes.pixelToData(q.avgValBot,q.avgX)[0]);d=0>u+w?"increasing"===f.direction?q.avgValBot:q.avgValTop:"increasing"===f.direction?q.avgValTop:q.avgValBot;b.axes.dataPointsHaveLabels?"Y"===f.axes?e.addPixel(q.avgX+.5,d+.5,["Bar"+r]):e.addPixel(d+.5,q.avgX+.5,["Bar"+
r]):"Y"===f.axes?e.addPixel(q.avgX+.5,d+.5):e.addPixel(d+.5,q.avgX+.5)}}};wpd=wpd||{};
wpd.BlobDetectorAlgo=function(){return function(){var c,a;this.getParamList=function(){var a=wpd.appData.isAligned(),c=wpd.appData.getPlotData().axes;return a&&c instanceof wpd.MapAxes?[["Min Diameter","Units",0],["Max Diameter","Units",5E3]]:[["Min Diameter","Px",0],["Max Diameter","Px",5E3]]};this.setParam=function(b,d){0===b?c=parseFloat(d):1===b&&(a=parseFloat(d))};this.run=function(b){var d=b.getAutoDetector(),e=b.getActiveDataSeries(),f=d.imageWidth,h=d.imageHeight,g=[],k=[],l,m,n,p,r;if(!(0>=
f||0>=h||null==d.binaryData||0===d.binaryData.length)){e.clearAll();e.setMetadataKeys(["area","moment"]);for(l=0;l<f;l++)for(m=0;m<h;m++)if(!0===d.binaryData[m*f+l]&&!0!==g[m*f+l]){g[m*f+l]=!0;var t=k.length;k[t]={pixels:[{x:l,y:m}],centroid:{x:l,y:m},area:1,moment:0};for(n=0;n<k[t].pixels.length;){var u=k[t].pixels[n].x;var w=k[t].pixels[n].y;for(p=u-1;p<=u+1;p++)for(r=w-1;r<=w+1;r++)if(0<=p&&0<=r&&p<f&&r<h&&!0!==g[r*f+p]&&!0===d.binaryData[r*f+p]){g[r*f+p]=!0;var q=k[t].pixels.length;k[t].pixels[q]=
{x:p,y:r};k[t].centroid.x=(k[t].centroid.x*q+p)/(q+1);k[t].centroid.y=(k[t].centroid.y*q+r)/(q+1);k[t].area+=1}n+=1}}for(t=0;t<k.length;t++){for(n=k[t].moment=0;n<k[t].pixels.length;n++)k[t].moment=k[t].moment+(k[t].pixels[n].x-k[t].centroid.x)*(k[t].pixels[n].x-k[t].centroid.x)+(k[t].pixels[n].y-k[t].centroid.y)*(k[t].pixels[n].y-k[t].centroid.y);b.axes instanceof wpd.MapAxes&&(k[t].area=b.axes.pixelToDataArea(k[t].area));d=2*Math.sqrt(k[t].area/Math.PI);d<=a&&d>=c&&e.addPixel(k[t].centroid.x+.5,
k[t].centroid.y+.5,[k[t].area,k[t].moment])}}}}}();wpd=wpd||{};
wpd.XStepWithInterpolationAlgo=function(){return function(){var c,a,b,d,e,f;this.getParamList=function(){var a=wpd.appData.isAligned(),b=wpd.appData.getPlotData().axes;return a&&b instanceof wpd.XYAxes?(a=b.getBounds(),[["X_min","Units",a.x1],["\u0394X Step","Units",(a.x2-a.x1)/50],["X_max","Units",a.x2],["Y_min","Units",a.y3],["Y_max","Units",a.y4],["Smoothing","% of \u0394X",0]]):[["X_min","Units",0],["\u0394X Step","Units",.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Smoothing",
"% of \u0394X",0]]};this.setParam=function(h,g){0===h?c=g:1===h?a=g:2===h?b=g:3===h?e=g:4===h?f=g:5===h&&(d=g)};this.run=function(h){var g=h.getAutoDetector(),k=h.getActiveDataSeries();h=h.axes;var l=0,m=g.imageWidth,n=g.imageHeight,p,r,t=[],u=[],w=Math.abs(d/100*a);k.clearAll();var q=h.dataToPixel(c,e);var v=h.dataToPixel(c,f);var y=(f-e)/Math.sqrt((q.x-v.x)*(q.x-v.x)+(q.y-v.y)*(q.y-v.y));v=h.dataToPixel(b,e);v=(b-c)/Math.sqrt((q.x-v.x)*(q.x-v.x)+(q.y-v.y)*(q.y-v.y));0<Math.abs(w/v)&&1>Math.abs(w/
v)&&(w=v);for(q=c;0<v&&q<=b||0>v&&q>=b;){var B=r=0;for(p=e;0<y&&p<=f||0>y&&p>=f;){var x=h.dataToPixel(q,p);0<x.x&&0<x.y&&x.x<m&&x.y<n&&!0===g.binaryData[parseInt(x.y,10)*m+parseInt(x.x,10)]&&(r=(r*B+p)/parseFloat(B+1),B++);p+=y}0<B&&(t[l]=parseFloat(q),u[l]=parseFloat(r),l+=1);q+=v}if(!(0>=t.length||0>=u.length)){if(0<w)for(x=[],l=[],q=t[0];0<v&&q<=t[t.length-1]||0>v&&q>=t[t.length-1];){for(g=B=n=m=0;g<t.length;g++)t[g]<=q+w&&t[g]>=q-w&&(m=(m*B+t[g])/parseFloat(B+1),n=(n*B+u[g])/parseFloat(B+1),B++);
0<B&&(x[x.length]=m,l[l.length]=n);q=0<v?q+w:q-w}else x=t,l=u;if(!(0>=x.length||0>=l.length||(t=[],g=0,q=c,0>v&&0<a||0<v&&0>a))){for(;0<v&&q<=b||0>v&&q>=b;)t[g]=q,g++,q+=a;0>v&&(x=x.reverse(),l=l.reverse());w=wpd.cspline(x,l);if(null!=w)for(u=[],g=0;g<t.length;++g)isNaN(t[g])||(u[g]=wpd.cspline_interp(w,t[g]),null!==u[g]&&(x=h.dataToPixel(t[g],u[g]),k.addPixel(x.x,x.y)))}}}}}();wpd=wpd||{};
wpd.BarAxes=function(){var c=function(){var a=!1,b=!1,c,e,f,h,g,k,l;this.isCalibrated=function(){return a};this.calibrate=function(d,n,p){a=!1;var m=d.getPoint(0);d=d.getPoint(1);c=m.px;e=m.py;f=d.px;h=d.py;g=parseFloat(m.dy);k=parseFloat(d.dy);n?(b=!0,g=Math.log(g)/Math.log(10),k=Math.log(k)/Math.log(10)):b=!1;l=this.calculateOrientation();p||("Y"==l.axes?f=c:h=e,l=this.calculateOrientation());return a=!0};this.pixelToData=function(a,d){var l=[];l[0]=((d-e)*(h-e)+(f-c)*(a-c))/((h-e)*(h-e)+(f-c)*
(f-c))*(k-g)+g;b&&(l[0]=Math.pow(10,l[0]));return l};this.dataToPixel=function(a,b){return{x:0,y:0}};this.pixelToLiveString=function(a,b){return this.pixelToData(a,b)[0].toExponential(4)};this.isLog=function(){return b};this.getTransformationEquations=function(){return{pixelToData:["This will be available in a future release."]}};this.dataPointsHaveLabels=!0;this.dataPointsLabelPrefix="Bar";this.calculateOrientation=function(){var a=180*wpd.taninverse(-(h-e),f-c)/Math.PI,b={axes:"Y",direction:"increasing",
angle:a};30>Math.abs(a-90)?(b.axes="Y",b.direction="increasing"):30>Math.abs(a-270)?(b.axes="Y",b.direction="decreasing"):30>Math.abs(a-0)||30>Math.abs(a-360)?(b.axes="X",b.direction="increasing"):30>Math.abs(a-180)&&(b.axes="X",b.direction="decreasing");return b};this.getOrientation=function(){return l}};c.prototype.numCalibrationPointsRequired=function(){return 2};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["Label","Y"]};return c}();wpd=wpd||{};
wpd.ImageAxes=function(){var c=function(){this.isCalibrated=function(){return!0};this.calibrate=function(){return!0};this.pixelToData=function(a,b){return[a,b]};this.dataToPixel=function(a,b){return{x:a,y:b}};this.pixelToLiveString=function(a,b){a=this.pixelToData(a,b);return a[0].toFixed(2)+", "+a[1].toFixed(2)};this.getTransformationEquations=function(){return{pixelToData:["x_data = x_pixel","y_data = y_pixel"],dataToPixel:["x_pixel = x_data","y_pixel = y_data"]}}};c.prototype.numCalibrationPointsRequired=
function(){return 0};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X","Y"]};return c}();wpd=wpd||{};
wpd.MapAxes=function(){var c=function(){var a=!1,b,c,e;this.isCalibrated=function(){return a};this.calibrate=function(d,h,g){var f=d.getPoint(0);d=d.getPoint(1);e=Math.sqrt((f.px-d.px)*(f.px-d.px)+(f.py-d.py)*(f.py-d.py));b=parseFloat(h);c=g;return a=!0};this.pixelToData=function(a,c){var d=[];d[0]=a*b/e;d[1]=c*b/e;return d};this.pixelToDataDistance=function(a){return a*b/e};this.pixelToDataArea=function(a){return a*b*b/(e*e)};this.dataToPixel=function(a,b,c){return{x:0,y:0}};this.pixelToLiveString=
function(a,b){a=this.pixelToData(a,b);return a[0].toExponential(4)+", "+a[1].toExponential(4)};this.getScaleLength=function(){return b};this.getUnits=function(){return c};this.getTransformationEquations=function(){return{pixelToData:["x_data = "+b/e+"*x_pixel","y_data = "+b/e+"*y_pixel"],dataToPixel:["x_pixel = "+e/b+"*x_data","y_pixel = "+e/b+"*y_data"]}}};c.prototype.numCalibrationPointsRequired=function(){return 2};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X",
"Y"]};return c}();wpd=wpd||{};
wpd.PolarAxes=function(){var c=function(){var a=!1,b=!1,c=!1,e=!1,f,h,g,k,l,m,n,p,r,t,u,w,q,v;processCalibration=function(a,d,x,z){var y=a.getPoint(0),F=a.getPoint(1);a=a.getPoint(2);f=y.px;h=y.py;g=F.px;k=F.py;l=a.px;m=a.py;n=F.dx;p=F.dy;r=a.dx;b=d;c=x;!0===b&&(p*=Math.PI/180);z&&(e=!0,n=Math.log(n)/Math.log(10),r=Math.log(r)/Math.log(10));t=Math.sqrt((g-f)*(g-f)+(k-h)*(k-h));u=Math.sqrt((l-f)*(l-f)+(m-h)*(m-h));w=u-t;q=wpd.taninverse(-(k-h),g-f);v=c?q+p:q-p;return!0};this.isCalibrated=function(){return a};
this.calibrate=function(b,c,e,d){return a=processCalibration(b,c,e,d)};this.isThetaDegrees=function(){return b};this.isThetaClockwise=function(){return c};this.pixelToData=function(a,d){var g=[];xp=parseFloat(a);yp=parseFloat(d);a=(r-n)/w*(Math.sqrt((xp-f)*(xp-f)+(yp-h)*(yp-h))-t)+n;d=c?v-wpd.taninverse(-(yp-h),xp-f):wpd.taninverse(-(yp-h),xp-f)-v;0>d&&(d+=2*Math.PI);!0===b&&(d=180*d/Math.PI);e&&(a=Math.pow(10,a));g[0]=a;g[1]=d;return g};this.dataToPixel=function(a,b){return{x:0,y:0}};this.pixelToLiveString=
function(a,b){a=this.pixelToData(a,b);return a[0].toExponential(4)+", "+a[1].toExponential(4)};this.getTransformationEquations=function(){var a="r = ("+(r-n)/w+")*sqrt((x_pixel - "+f+")^2 + (y_pixel - "+h+")^2) + ("+(n-t*(r-n)/w)+")";var e=c?v-NaN+h+" - y_pixel), (x_pixel - "+f+"))":"atan2(("+h+" - y_pixel), (x_pixel - "+f+")) - ("+v+")";e=b?"theta = (180/PI)*("+e+"), theta = theta + 360 if theta < 0":"theta = "+e+" theta = theta + 2*PI if theta < 0";return{pixelToData:[a,e]}}};c.prototype.numCalibrationPointsRequired=
function(){return 3};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["r","\u03b8"]};return c}();wpd=wpd||{};
wpd.TernaryAxes=function(){var c=function(){var a=!1,b,c,e,f,h,g,k,l,m;this.isCalibrated=function(){return a};this.calibrate=function(d,p,r){var n=d.getPoint(0),u=d.getPoint(1);d.getPoint(2);b=n.px;c=n.py;e=u.px;f=u.py;h=Math.sqrt((b-e)*(b-e)+(c-f)*(c-f));g=wpd.taninverse(-(f-c),e-b);k=Math.sqrt(3);l=p;m=r;return a=!0};this.isRange100=function(){return l};this.isNormalOrientation=function(){return m};this.pixelToData=function(a,e){var d=[];xp=parseFloat(a);yp=parseFloat(e);a=Math.sqrt((xp-b)*(xp-
b)+(yp-c)*(yp-c));var f=wpd.taninverse(-(yp-c),xp-b)-g;e=a*Math.cos(f)/h;f=a*Math.sin(f)/h;a=1-e-f/k;e-=f/k;f=2*f/k;if(0==m){var n=e;e=a;a=f;f=n}1==l&&(a*=100,e*=100,f*=100);d[0]=a;d[1]=e;d[2]=f;return d};this.dataToPixel=function(a,b,c){return{x:0,y:0}};this.pixelToLiveString=function(a,b){a=this.pixelToData(a,b);return a[0].toExponential(4)+", "+a[1].toExponential(4)+", "+a[2].toExponential(4)};this.getTransformationEquations=function(){var a="rp = sqrt((x_pixel - "+b+")^2 + (y_pixel - "+c+")^2)/("+
h+")",d="thetap = atan2(("+c+" -  y_pixel), (x_pixel - "+b+")) - ("+Math.atan2(-(f-c),e-b)+")",g="1 - rp*(cos(thetap) - sin(thetap)/sqrt(3))",k="rp*(cos(thetap) - sin(thetap)/sqrt(3))",u="2*rp*sin(thetap)/sqrt(3)";l&&(g="100*("+g+")",k="100*("+k+")",u="100*("+u+")");g="a_data = "+g;k="b_data = "+k;u="c_data = "+u;if(!m){var w=k;k=g;g=u;u=w}return{pixelToData:[a,d,g,k,u]}}};c.prototype.numCalibrationPointsRequired=function(){return 3};c.prototype.getDimensions=function(){return 3};c.prototype.getAxesLabels=
function(){return["a","b","c"]};return c}();wpd=wpd||{};
wpd.XYAxes=function(){var c=function(){var a=!1,b=!1,c=!1,e=!1,f=!1,h,g,k,l,m,n,p,r,t,u,w,q,v,y,B=[0,0,0,0],x=[0,0,0,0],z=[0,0],J=function(a,d,N){if(4>a.getCount())return!1;var F=a.getPoint(0),M=a.getPoint(1),H=a.getPoint(2);a=a.getPoint(3);var G=new wpd.InputParser;k=F.px;p=F.py;l=M.px;r=M.py;m=H.px;t=H.py;n=a.px;u=a.py;w=F.dx;q=M.dx;v=H.dy;y=a.dy;w=G.parse(w);if(!G.isValid)return!1;e=G.isDate;q=G.parse(q);if(!G.isValid||G.isDate!=e)return!1;h=G.formatting;v=G.parse(v);if(!G.isValid)return!1;f=G.isDate;
y=G.parse(y);if(!G.isValid||G.isDate!=f)return!1;g=G.formatting;b=d;c=N;!0===b&&(w=Math.log(w)/Math.log(10),q=Math.log(q)/Math.log(10));!0===c&&(v=Math.log(v)/Math.log(10),y=Math.log(y)/Math.log(10));B=wpd.mat.mult2x2([w-q,0,0,v-y],wpd.mat.inv2x2([k-l,m-n,p-r,t-u]));x=wpd.mat.inv2x2(B);z[0]=w-B[0]*k-B[1]*p;z[1]=v-B[2]*m-B[3]*t;return!0};this.getBounds=function(){return{x1:b?Math.pow(10,w):w,x2:b?Math.pow(10,q):q,y3:c?Math.pow(10,v):v,y4:c?Math.pow(10,y):y}};this.isCalibrated=function(){return a};
this.calibrate=function(b,c,e){return a=J(b,c,e)};this.pixelToData=function(a,e){var d=[];a=parseFloat(a);e=parseFloat(e);a=wpd.mat.mult2x2Vec(B,[a,e]);a[0]+=z[0];a[1]+=z[1];e=a[0];a=a[1];!0===b&&(e=Math.pow(10,e));!0===c&&(a=Math.pow(10,a));d[0]=e;d[1]=a;return d};this.dataToPixel=function(a,e){b&&(a=Math.log(a)/Math.log(10));c&&(e=Math.log(e)/Math.log(10));a=wpd.mat.mult2x2Vec(x,[a-z[0],e-z[1]]);return{x:a[0],y:a[1]}};this.pixelToLiveString=function(a,b){var c="";a=this.pixelToData(a,b);c=e?c+wpd.dateConverter.formatDateNumber(a[0],
h):c+a[0].toExponential(4);c+=", ";return c=f?c+wpd.dateConverter.formatDateNumber(a[1],g):c+a[1].toExponential(4)};this.isDate=function(a){return 0===a?e:f};this.getInitialDateFormat=function(a){return 0===a?h:g};this.isLogX=function(){return b};this.isLogY=function(){return c};this.getTransformationEquations=function(){var a="("+B[0]+")*x_pixel + ("+B[1]+")*y_pixel + ("+z[0]+")",e="("+B[2]+")*x_pixel + ("+B[3]+")*y_pixel + ("+z[1]+")",d="x_pixel = ("+x[0]+")*x_data + ("+x[1]+")*y_data + ("+(-x[0]*
z[0]-x[1]*z[1])+")",f="y_pixel = ("+x[2]+")*x_data + ("+x[3]+")*y_data + ("+(-x[2]*z[0]-x[3]*z[1])+")",a=b?"x_data = pow(10, "+a+")":"x_data = "+a,e=c?"y_data = pow(10, "+e+")":"y_data = "+e;return b||c?{pixelToData:[a,e]}:{pixelToData:[a,e],dataToPixel:[d,f]}};this.getOrientation=function(){return{axes:"Y",direction:"increasing",angle:90}}};c.prototype.numCalibrationPointsRequired=function(){return 4};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X",
"Y"]};return c}();wpd=wpd||{};
wpd.dataTable=function(){function c(){wpd.graphicsWidget.removeTool();wpd.popup.show("csvWindow");a()}function a(){h=f.getData();document.getElementById("data-table-dataset-control");var a=document.getElementById("data-table-dataset-list"),c=f.getDatasetNames(),g=document.getElementById("data-sort-variables"),k=document.getElementById("dataVariables"),r=document.getElementById("data-date-formatting-container"),t=document.getElementById("data-date-formatting"),u,w="",q="",v="",y=!1;for(u=0;u<c.length;u++)w+=
"<option>"+c[u]+"</option>";a.innerHTML=w;a.selectedIndex=f.getDatasetIndex();k.innerHTML=h.fields.join(", ");r.style.display="none";q+='<option value="raw">'+wpd.gettext("raw")+"</option>";for(u=0;u<h.fields.length;u++)h.isFieldSortable[u]&&(q+='<option value="'+h.fields[u]+'">'+h.fields[u]+"</option>"),null!=h.fieldDateFormat[u]&&(v+="<p>"+h.fields[u]+' <input type="text" length="15" value="'+h.fieldDateFormat[u]+'" id="data-format-string-'+u+'"/></p>',y=!0);h.allowConnectivity&&(q+='<option value="NearestNeighbor">'+
wpd.gettext("nearest-neighbor")+"</option>");g.innerHTML=q;b();y?(r.style.display="inline-block",t.innerHTML=v):r.style.display="hidden";d();e()}function b(){var a=document.getElementById("data-sort-variables").value,b=document.getElementById("data-sort-order");"NearestNeighbor"===a||"raw"===a?b.setAttribute("disabled",!0):b.removeAttribute("disabled")}function d(){if(null!=h&&null!=h.rawData){g=h.rawData.slice(0);var a=document.getElementById("data-sort-variables").value,b="ascending"===document.getElementById("data-sort-order").value,
c="NearestNeighbor"===a;if("raw"!==a)if(!c){var e=h.fields.indexOf(a);0>e||g.sort(function(a,c){return a[e]>c[e]?b?1:-1:a[e]<c[e]?b?-1:1:0})}else if(c)for(var d,f,k,w=g.length,q=h.connectivityFieldIndices,v,y,c=0;c<w-1;c++){a=-1;for(k=c+1;k<w;k++){for(v=f=0;v<q.length;v++)y=q[v],f+=(g[c][y]-g[k][y])*(g[c][y]-g[k][y]);if(f<d||-1===a)d=f,a=k}for(v=0;v<h.fields.length;v++)f=g[a][v],g[a][v]=g[c+1][v],g[c+1][v]=f}}}function e(){if(null!=g){var a=document.getElementById("digitizedDataTable"),b=parseInt(document.getElementById("data-number-format-digits").value,
10),c=document.getElementById("data-number-format-style").value,e=document.getElementById("data-number-format-separator").value,d,f,u=[],e=e.replace(/[^\\]\\t/,"\t").replace(/^\\t/,"\t");k="";for(d=0;d<g.length;d++){var w=[];for(f=0;f<h.fields.length;f++)null!=h.fieldDateFormat[f]?(void 0===u[f]&&(u[f]=document.getElementById("data-format-string-"+f).value),w[f]=wpd.dateConverter.formatDateNumber(g[d][f],u[f])):w[f]="string"===typeof g[d][f]?g[d][f]:"fixed"===c&&0<=b?g[d][f].toFixed(b):"precision"===
c&&0<=b?g[d][f].toPrecision(b):"exponential"===c&&0<=b?g[d][f].toExponential(b):g[d][f];k+=w.join(e);k+="\n"}a.value=k}}var f,h,g,k;return{showTable:function(){f=wpd.plotDataProvider;c()},showAngleData:function(){f=wpd.measurementDataProvider;f.setDataSource("angle");c()},showDistanceData:function(){f=wpd.measurementDataProvider;f.setDataSource("distance");c()},updateSortingControls:b,reSort:function(){b();d();e()},selectAll:function(){var a=document.getElementById("digitizedDataTable");a.focus();
a.select()},generateCSV:function(){var a=f.getDatasetNames()[f.getDatasetIndex()];wpd.download.csv(k,a+".csv")},exportToPlotly:function(){if(null!=g){var a={data:[]},b,c;a.data[0]={};for(b=0;b<g.length;b++)for(c=0;c<h.fields.length;c++){var e=h.fields[c];0===c?e="x":1===c&&(e="y");0===b&&(a.data[0][e]=[]);a.data[0][e][b]=null!=h.fieldDateFormat[c]?wpd.dateConverter.formatDateNumber(g[b][c],"yyyy-mm-dd"):g[b][c]}wpd.plotly.send(a)}},changeDataset:function(){var b=document.getElementById("data-table-dataset-list");
f.setDatasetIndex(b.selectedIndex);a()}}}();wpd=wpd||{};
wpd.graphicsWidget=function(){function c(a){var b=v.getBoundingClientRect();return{x:parseInt(a.pageX-(b.left+window.pageXOffset),10),y:parseInt(a.pageY-(b.top+window.pageYOffset),10)}}function a(a,b){return{x:a/I,y:b/I}}function b(a,b){a=parseInt(a,10);b=parseInt(b,10);M.style.width=a+"px";M.style.height=b+"px";v.width=a;y.width=a;B.width=a;x.width=a;z.width=a;v.height=b;y.height=b;B.height=b;x.height=b;z.height=b;W=a/(1*b);K=a;L=b;if(null!=P){N.fillStyle="rgb(255, 255, 255)";N.fillRect(0,0,K,L);
N.drawImage(J,0,0,K,L);if(null!=C&&void 0!=C.onRedraw)C.onRedraw();if(null!=A&&void 0!=A.onRedraw)A.onRedraw()}}function d(){y.width=y.width;B.width=B.width;x.width=x.width;z.width=z.width;F.width=F.width}function e(){if(null!=C&&void 0!=C.onRemove)C.onRemove();C=null}function f(){var a=wpd.layoutManager.getGraphicsViewportSize();b(a.width,a.height);W>Q?(I=L/(1*D),b(L*Q,L)):(I=K/(1*E),b(K,K/Q))}function h(a){I=a;b(E*I,D*I)}function g(){R=!R;var a=document.getElementById("extended-crosshair-btn");
R?a.classList.add("pressed-button"):a.classList.remove("pressed-button");x.width=x.width}function k(a,b){var c=wpd.zoomView.getSize(),e=wpd.zoomView.getZoomRatio(),d=0,f=0,h=c.width,g=c.height;var k=c.width/e;c=c.height/e;var l=a-k/2;var n=b-c/2;a=l;b=n;var m=l+k;var p=n+c;0>l&&(a=0,d=-l*e);0>n&&(b=0,f=-n*e);l+k>=E&&(m=E,h-=e*(E-(l+k)));n+c>=D&&(p=D,g-=e*(D-(n+c)));k=O.getImageData(parseInt(a,10),parseInt(b,10),parseInt(m-a,10),parseInt(p-b,10));c=S.getImageData(parseInt(a,10),parseInt(b,10),parseInt(m-
a,10),parseInt(p-b,10));for(m=0;m<c.data.length;m+=4)if(0!=c.data[m]||0!=c.data[m+1]||0!=c.data[m+2])l=c.data[m+3]/255,k.data[m]=(1-l)*k.data[m]+l*c.data[m],k.data[m+1]=(1-l)*k.data[m+1]+l*c.data[m+1],k.data[m+2]=(1-l)*k.data[m+2]+l*c.data[m+2];a=e*(parseInt(a,10)-a);e*=parseInt(b,10)-b;wpd.zoomView.setZoomImage(k,parseInt(d+a,10),parseInt(f+e,10),parseInt(h-d,10),parseInt(g-f,10))}function l(b){clearTimeout(X);var e=setTimeout,d=c(b);b=d.x;var d=d.y,f=a(b,d);R&&(x.width=x.width,H.strokeStyle="rgba(0,0,0, 0.5)",
H.beginPath(),H.moveTo(b,0),H.lineTo(b,L),H.moveTo(0,d),H.lineTo(K,d),H.stroke());k(f.x,f.y);wpd.zoomView.setCoords(f.x,f.y);X=e(void 0,10)}function m(){v=document.getElementById("mainCanvas");y=document.getElementById("dataCanvas");B=document.getElementById("drawCanvas");x=document.getElementById("hoverCanvas");z=document.getElementById("topCanvas");J=document.createElement("canvas");F=document.createElement("canvas");N=v.getContext("2d");T=y.getContext("2d");H=x.getContext("2d");G=z.getContext("2d");
V=B.getContext("2d");O=J.getContext("2d");S=F.getContext("2d");M=document.getElementById("canvasDiv");document.addEventListener("keydown",function(a){U&&220===a.keyCode&&(a.preventDefault(),g())},!1);z.addEventListener("mousemove",l,!1);z.addEventListener("dragover",function(a){a.preventDefault()},!0);z.addEventListener("drop",function(a){a.preventDefault();wpd.busyNote.show();a=a.dataTransfer.files;1===a.length&&wpd.imageManager.loadFromFile(a[0])},!0);z.addEventListener("mousemove",p,!1);z.addEventListener("click",
r,!1);z.addEventListener("mouseup",u,!1);z.addEventListener("mousedown",w,!1);z.addEventListener("mouseout",q,!0);document.addEventListener("mouseup",t,!1);document.addEventListener("mousedown",function(a){U=a.target===z?!0:!1},!1);document.addEventListener("keydown",function(a){if(U&&null!=A&&void 0!=A.onKeyDown)A.onKeyDown(a)},!0);wpd.zoomView.initZoom();window.addEventListener("paste",function(a){if(void 0!==a.clipboardData&&(a=a.clipboardData.items,void 0!==a))for(var b=0;b<a.length;b++)if(-1!==
a[b].type.indexOf("image")){wpd.busyNote.show();var c=a[b].getAsFile();wpd.imageManager.loadFromFile(c)}},!1)}function n(){if(null!=A&&void 0!=A.onRemove)A.onRemove();A=null}function p(b){if(null!=A&&void 0!=A.onMouseMove){var e=c(b),d=a(e.x,e.y);A.onMouseMove(b,e,d)}}function r(b){if(null!=A&&void 0!=A.onMouseClick){var e=c(b),d=a(e.x,e.y);A.onMouseClick(b,e,d)}}function t(b){if(null!=A&&void 0!=A.onDocumentMouseUp){var e=c(b),d=a(e.x,e.y);A.onDocumentMouseUp(b,e,d)}}function u(b){if(null!=A&&void 0!=
A.onMouseUp){var e=c(b),d=a(e.x,e.y);A.onMouseUp(b,e,d)}}function w(b){if(null!=A&&void 0!=A.onMouseDown){var e=c(b),d=a(e.x,e.y);A.onMouseDown(b,e,d)}}function q(b){if(null!=A&&void 0!=A.onMouseOut){var e=c(b),d=a(e.x,e.y);A.onMouseOut(b,e,d)}}var v,y,B,x,z,J,F,M,N,T,V,H,G,O,S,K,L,E,D,Q,W,P,I,R=!1,X,A,C,U=!1;return{zoomIn:function(){h(1.2*I)},zoomOut:function(){h(I/1.2)},zoomFit:f,zoom100perc:function(){h(1)},toggleExtendedCrosshairBtn:g,setZoomRatio:h,getZoomRatio:function(){return I},runImageOp:function(a){var b=
a(P,E,D);a=b.imageData;var c=b.width,g=b.height,b=b.keepZoom;n();e();E=c;D=g;Q=E/(1*D);J.width=E;J.height=D;F.width=E;F.height=D;O.putImageData(a,0,0);P=a;v.width=v.width;d();b?h(I):f()},setTool:function(a){if(null!=A&&void 0!=A.onRemove)A.onRemove();A=a;if(null!=A&&void 0!=A.onAttach)A.onAttach()},removeTool:n,getAllContexts:function(){return{mainCtx:N,dataCtx:T,drawCtx:V,hoverCtx:H,topCtx:G,oriImageCtx:O,oriDataCtx:S}},resetData:function(){F.width=F.width;y.width=y.width},resetHover:function(){x.width=
x.width},imagePx:a,screenPx:function(a,b){return{x:a*I,y:b*I}},updateZoomOnEvent:function(b){b=c(b);b=a(b.x,b.y);k(b.x,b.y);wpd.zoomView.setCoords(b.x,b.y)},updateZoomToImagePosn:function(a,b){k(a,b);wpd.zoomView.setCoords(a,b)},getDisplaySize:function(){return{width:K,height:L}},getImageSize:function(){return{width:E,height:D}},copyImageDataLayerToScreen:function(){T.drawImage(F,0,0,K,L)},setRepainter:function(a){if(null==C||void 0==C.painterName||null==a||void 0==a.painterName||C.painterName!=a.painterName){if(null!=
C&&void 0!=C.onRemove)C.onRemove();C=a;if(null!=C&&void 0!=C.onAttach)C.onAttach()}},removeRepainter:e,forceHandlerRepaint:function(){if(null!=C&&void 0!=C.onForcedRedraw)C.onForcedRedraw()},getRepainter:function(){return C},saveImage:function(){var a=document.createElement("canvas"),b=a.getContext("2d"),c;a.width=E;a.height=D;b.drawImage(J,0,0,E,D);var e=b.getImageData(0,0,E,D);var d=S.getImageData(0,0,E,D);for(c=0;c<e.data.length;c+=4)if(0!=d.data[c]||0!=d.data[c+1]||0!=d.data[c+2]){var f=d.data[c+
3]/255;e.data[c]=(1-f)*e.data[c]+f*d.data[c];e.data[c+1]=(1-f)*e.data[c+1]+f*d.data[c+1];e.data[c+2]=(1-f)*e.data[c+2]+f*d.data[c+2]}b.putImageData(e,0,0);window.open(a.toDataURL(),"_blank")},loadImage:function(a){null==v&&m();n();e();E=a.width;D=a.height;Q=E/(1*D);J.width=E;J.height=D;F.width=E;F.height=D;O.drawImage(a,0,0,E,D);P=O.getImageData(0,0,E,D);v.width=v.width;d();f();return P},getImagePNG:function(){for(var a=J.toDataURL("image/png"),a=atob(a.split(",")[1]),b=a.length,c=new Uint8Array(b);b--;)c[b]=
a.charCodeAt(b);return imageFile=new Blob([c],{type:"image/png",encoding:"utf-8"})}}}();wpd=wpd||{};
wpd.layoutManager=function(){function c(){var a=parseInt(document.body.offsetWidth,10),b=parseInt(document.body.offsetHeight,10);e.style.height=b+"px";f.style.height=b-280+"px";h.style.width=a-e.offsetWidth-5+"px";h.style.height=b+"px";d.style.height=b-45+"px";g.style.height=b-45+"px";wpd.sidebar.resize()}function a(a){clearTimeout(b);b=setTimeout(c,80)}var b,d,e,f,h,g;return{initialLayout:function(){d=document.getElementById("graphicsContainer");e=document.getElementById("sidebarContainer");f=document.getElementById("sidebarControlsContainer");
h=document.getElementById("mainContainer");g=document.getElementById("left-side-container");c();window.addEventListener("resize",a,!1);wpd.tree.init()},getGraphicsViewportSize:function(){return{width:d.offsetWidth,height:d.offsetHeight}}}}();wpd=wpd||{};
wpd.popup=function(){function c(c){var d=document.createElement("div");d.className="popup-drag-mask";d.style.display="inline-block";d.addEventListener("mousemove",a,!1);d.addEventListener("mouseup",b,!1);d.addEventListener("mouseout",e,!1);document.body.appendChild(d);h={dragMaskDiv:d,initialMouseX:c.pageX,initialMouseY:c.pageY,initialWindowX:g.offsetLeft,initialWindowY:g.offsetTop};c.preventDefault();c.stopPropagation()}function a(a){d(a);a.stopPropagation();a.preventDefault()}function b(a){d(a);
f();a.stopPropagation();a.preventDefault()}function d(a){var b=h.initialWindowX+a.pageX-h.initialMouseX;a=h.initialWindowY+a.pageY-h.initialMouseY;var c=parseInt(document.body.offsetWidth,10),e=parseInt(document.body.offsetHeight,10),d=parseInt(g.offsetWidth,10),f=parseInt(g.offsetHeight,10);b+.7*d<c&&0<b&&0<a&&a+.5*f<e&&(g.style.top=a+"px",g.style.left=b+"px")}function e(a){f()}function f(){null!=h&&null!=h.dragMaskDiv&&(h.dragMaskDiv.removeEventListener("mouseout",e,!1),h.dragMaskDiv.removeEventListener("mouseup",
b,!1),h.dragMaskDiv.removeEventListener("mousemove",a,!1),h.dragMaskDiv.style.display="none",document.body.removeChild(h.dragMaskDiv),h=null)}var h=null,g=null;return{show:function(a){document.getElementById("shadow").style.visibility="visible";a=document.getElementById(a);var b=parseInt(window.innerWidth,10),e=parseInt(window.innerHeight,10),d=parseInt(a.offsetWidth,10),f=parseInt(a.offsetHeight,10),e=(e-f)/2;a.style.left=(b-d)/2+"px";a.style.top=(60<e?60:e)+"px";a.style.visibility="visible";for(b=
0;b<a.childNodes.length;b++)if("popupheading"===a.childNodes[b].className){a.childNodes[b].addEventListener("mousedown",c,!1);break}g=a},close:function(a){document.getElementById("shadow").style.visibility="hidden";document.getElementById(a).style.visibility="hidden";f();g=null}}}();
wpd.busyNote=function(){var c,a=!1;return{show:function(){a||(null==c&&(c=document.createElement("div"),c.id="wait",c.innerHTML='<p align="center">'+wpd.gettext("processing")+"...</p>"),document.body.appendChild(c),a=!0)},close:function(){null!=c&&!0===a&&(document.body.removeChild(c),a=!1)}}}();
wpd.messagePopup=function(){var c;return{show:function(a,b,d){wpd.popup.show("messagePopup");document.getElementById("message-popup-heading").innerHTML=a;document.getElementById("message-popup-text").innerHTML=b;c=d},close:function(){wpd.popup.close("messagePopup");null!=c&&c()}}}();
wpd.okCancelPopup=function(){var c,a;return{show:function(b,d,e,f){wpd.popup.show("okCancelPopup");document.getElementById("ok-cancel-popup-heading").innerHTML=b;document.getElementById("ok-cancel-popup-text").innerHTML=d;c=e;a=f},ok:function(){wpd.popup.close("okCancelPopup");c()},cancel:function(){wpd.popup.close("okCancelPopup");a()}}}();wpd.unsupported=function(){wpd.messagePopup.show(wpd.gettext("unsupported"),wpd.gettext("unsupported-text"))};wpd=wpd||{};
wpd.sidebar=function(){function c(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)a[b].style.display="none"}return{show:function(a){c();a=document.getElementById(a);a.style.display="inline-block";a.style.height=parseInt(document.body.offsetHeight,10)-280+"px"},clear:c,resize:function(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)"inline-block"===a[b].style.display&&(a[b].style.height=parseInt(document.body.offsetHeight,10)-280+"px")}}}();
wpd=wpd||{};wpd.toolbar=function(){function c(){var a=document.getElementsByClassName("toolbar"),b;for(b=0;b<a.length;b++)a[b].style.visibility="hidden"}return{show:function(a){c();document.getElementById(a).style.visibility="visible"},clear:c}}();wpd=wpd||{};
wpd.transformationEquations=function(){return{show:function(){if(!1===wpd.appData.isAligned())wpd.messagePopup.show(wpd.gettext("transformation-eqns"),wpd.gettext("transformation-eqns-text"));else{wpd.popup.show("axes-transformation-equations-window");var c=document.getElementById("axes-transformation-equation-list"),a="",b=wpd.appData.getPlotData().axes,d=b.getTransformationEquations(),a=a+"<p><b>Axes Type</b>: ";b instanceof wpd.XYAxes?a+="XY</p>":b instanceof wpd.PolarAxes?a+="Polar</p>":b instanceof
wpd.TernaryAxes?a+="Ternary</p>":b instanceof wpd.MapAxes?a+="Map</p>":b instanceof wpd.ImageAxes&&(a+="Image</p>");if(null!=d.pixelToData){a+="<p><b>Pixel to Data</b></p><ol>";for(b=0;b<d.pixelToData.length;b++)a+='<li><p class="footnote">'+d.pixelToData[b]+"</p></li>";a+="</ol>"}a+="<p>&nbsp;</p>";if(null!=d.dataToPixel){a+="<p><b>Data to Pixel</b></p><ol>";for(b=0;b<d.dataToPixel.length;b++)a+='<li><p class="footnote">'+d.dataToPixel[b]+"</p></li>";a+="</ol>"}c.innerHTML=a}}}}();wpd=wpd||{};
wpd.TreeWidget=function(c){var a=this;this.$mainElem=c;this.treeData=null;this.$mainElem.addEventListener("click",function(b){return a._onclick(b)});this.idmap=[];this.itemCount=0;this.selectedPath=null};
wpd.TreeWidget.prototype._renderFolder=function(c,a,b){b=b?'<ul class="tree-list">':'<ul class="tree-list-root">';for(var d=0;d<c.length;d++){var e=c[d];this.itemCount++;if("string"===typeof e)b+='<li title="'+e+'">',b+='<span class="tree-item" id="tree-item-id-'+this.itemCount+'">'+e+"</span>",this.idmap[this.itemCount]=a+"/"+e;else if("object"===typeof e){b+="<li>";var f=Object.keys(e)[0];b+='<span class="tree-folder" id="tree-item-id-'+this.itemCount+'">'+f+"</span>";this.idmap[this.itemCount]=
a+"/"+f;b+=this._renderFolder(e[f],a+"/"+f,!0)}b+="</li>"}return b+"</ul>"};wpd.TreeWidget.prototype.render=function(c){this.idmap=[];this.itemCount=0;this.treeData=c;this.$mainElem.innerHTML=this._renderFolder(this.treeData,"",!1);this.selectedPath=null};
wpd.TreeWidget.prototype._unselectAll=function(){var c=this.$mainElem.querySelectorAll(".tree-folder"),a=this.$mainElem.querySelectorAll(".tree-item");c.forEach(function(a){a.classList.remove("tree-selected")});a.forEach(function(a){a.classList.remove("tree-selected")});this.selectedPath=null};
wpd.TreeWidget.prototype.selectPath=function(c,a){var b=this.idmap.indexOf(c);0<=b&&(this._unselectAll(),this.selectedPath=c,b=document.getElementById("tree-item-id-"+b),b.classList.add("tree-selected"),null!=this.itemSelectionCallback&&this.itemSelectionCallback(b,c,a))};
wpd.TreeWidget.prototype._onclick=function(c){var a=c.target.classList.contains("tree-item"),b=c.target.classList.contains("tree-folder");if(a||b)this._unselectAll(),c.target.classList.add("tree-selected"),null!=this.itemSelectionCallback&&(a=parseInt(c.target.id.replace("tree-item-id-",""),10),isNaN(a)||this.itemSelectionCallback(c.target,this.idmap[a],!1))};wpd.TreeWidget.prototype.onItemSelection=function(c){this.itemSelectionCallback=c};wpd.TreeWidget.prototype.getSelectedPath=function(){return this.selectedPath};
wpd.tree=function(){function c(){if(null!=e){var b=[],c=wpd.appData.getPlotData(),d=c.axes,k={};null==d?k[wpd.gettext("axes")]=[]:k[wpd.gettext("axes")]=[d instanceof wpd.XYAxes?wpd.gettext("axes-name-xy"):d instanceof wpd.ImageAxes?wpd.gettext("axes-name-image"):d instanceof wpd.BarAxes?wpd.gettext("axes-name-bar"):d instanceof wpd.PolarAxes?wpd.gettext("axes-name-polar"):d instanceof wpd.TernaryAxes?wpd.gettext("axes-name-ternary"):d instanceof wpd.MapAxes?wpd.gettext("axes-name-map"):"Unknown Axes"];
b.push(k);d=c.getDataSeriesNames();k={};k[wpd.gettext("datasets")]=d;b.push(k);d=[];null!=c.angleMeasurementData&&d.push(wpd.gettext("angle"));null!=c.distanceMeasurementData&&d.push(wpd.gettext("distance"));c={};c[wpd.gettext("measurements")]=d;b.push(c);e.render(b);a(null)}}function a(a){document.querySelectorAll(".tree-widget").forEach(function(b){b.style.display=b.id===a?"inline":"none"})}function b(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.sidebar.clear()}function d(c,
e,d){e==="/"+wpd.gettext("datasets")?(b(),a("dataset-group-tree-widget")):e==="/"+wpd.gettext("axes")?(b(),a("axes-group-tree-widget")):e==="/"+wpd.gettext("measurements")?(b(),a("measurement-group-tree-widget")):e==="/"+wpd.gettext("measurements")+"/"+wpd.gettext("distance")?(d||wpd.measurement.start(wpd.measurementModes.distance),a("distance-item-tree-widget")):e==="/"+wpd.gettext("measurements")+"/"+wpd.gettext("angle")?(d||wpd.measurement.start(wpd.measurementModes.angle),a("angle-item-tree-widget")):
e.startsWith("/"+wpd.gettext("datasets")+"/")?(d||(c=wpd.appData.getPlotData(),e=c.getDataSeriesNames().indexOf(e.replace("/"+wpd.gettext("datasets")+"/","")),c.setActiveDataSeriesIndex(e),wpd.acquireData.load()),a("dataset-item-tree-widget")):e.startsWith("/"+wpd.gettext("axes")+"/")?(b(),a("axes-item-tree-widget")):(b(),a(null))}var e=null;return{init:function(){var a=document.getElementById("tree-container");e=new wpd.TreeWidget(a);e.onItemSelection(d);c()},refresh:function(){c()},refreshPreservingSelection:function(){if(null!=
e){var a=e.getSelectedPath();c();e.selectPath(a,!0)}else c()},selectPath:function(a,b){e.selectPath(a,b)},addMeasurement:function(a){wpd.measurement.start(a);c();a===wpd.measurementModes.distance?wpd.tree.selectPath("/"+wpd.gettext("measurements")+"/"+wpd.gettext("distance"),!0):a===wpd.measurementModes.angle&&wpd.tree.selectPath("/"+wpd.gettext("measurements")+"/"+wpd.gettext("angle"),!0)}}}();wpd=wpd||{};
wpd.webcamCapture=function(){function c(){void 0!=a&&a.stop();wpd.popup.close("webcamCapture")}var a;return{start:function(){if(null==(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia))wpd.messagePopup.show(wpd.gettext("webcam-capture"),wpd.gettext("webcam-capture-text"));else{wpd.popup.show("webcamCapture");var b=document.getElementById("webcamVideo");navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||
navigator.msGetUserMedia;navigator.getUserMedia({video:!0},function(c){a=c;b.src=window.URL.createObjectURL(c)},function(){})}},cancel:function(){c()},capture:function(){var a=document.createElement("canvas"),d=document.getElementById("webcamVideo"),e=a.getContext("2d");a.width=d.videoWidth;a.height=d.videoHeight;e.drawImage(d,0,0);var f=e.getImageData(0,0,a.width,a.height);c();wpd.graphicsWidget.runImageOp(function(){return{imageData:f,width:a.width,height:a.height}})}}}();wpd=wpd||{};
wpd.zoomView=function(){function c(){var a=document.getElementById("zoomCrossHair"),b=a.getContext("2d");a.width=a.width;b.strokeStyle="black"===g?"rgba(0,0,0,1)":"red"===g?"rgba(255,0,0,1)":"yellow"===g?"rgba(255,255,0,1)":"rgba(0,0,0,1)";b.beginPath();b.moveTo(125,0);b.lineTo(125,250);b.moveTo(0,125);b.lineTo(250,125);b.stroke()}var a,b,d,e,f,h,g="black";return{initZoom:function(){a=document.getElementById("zoomCanvas");b=a.getContext("2d");d=document.createElement("canvas");e=d.getContext("2d");
f=document.getElementById("mousePosition");h=5;c()},setZoomImage:function(c,f,g,n,p){d.width=n/h;d.height=p/h;e.putImageData(c,0,0);a.width=a.width;b.drawImage(d,f,g,n,p)},setCoords:function(a,b){if(wpd.appData.isAligned()){var c=wpd.appData.getPlotData();f.innerHTML=c.axes.pixelToLiveString(a,b)}else f.innerHTML=a.toFixed(2)+", "+b.toFixed(2)},setZoomRatio:function(a){h=a},getZoomRatio:function(){return h},getSize:function(){return{width:250,height:250}},showSettingsWindow:function(){document.getElementById("zoom-magnification-value").value=
h;document.getElementById("zoom-crosshair-color-value").value=g;wpd.popup.show("zoom-settings-popup")},applySettings:function(){h=document.getElementById("zoom-magnification-value").value;g=document.getElementById("zoom-crosshair-color-value").value;c();wpd.popup.close("zoom-settings-popup")}}}();wpd=wpd||{};
wpd.xyCalibration=function(){function c(){wpd.popup.show("xyAlignment")}return{start:function(){wpd.popup.show("xyAxesInfo")},reload:function(){var a=new wpd.AxesCornersTool(4,2,["X1","X2","Y1","Y2"],!0);wpd.graphicsWidget.setTool(a)},pickCorners:function(){wpd.popup.close("xyAxesInfo");var a=new wpd.AxesCornersTool(4,2,["X1","X2","Y1","Y2"]);wpd.graphicsWidget.setTool(a)},getCornerValues:c,align:function(){var a=document.getElementById("xmin").value,b=document.getElementById("xmax").value,d=document.getElementById("ymin").value,
e=document.getElementById("ymax").value,f=document.getElementById("xlog").checked,h=document.getElementById("ylog").checked,g=new wpd.XYAxes,k=wpd.alignAxes.getActiveCalib();if(f&&(0==parseFloat(a)||0==parseFloat(b))||h&&(0==parseFloat(d)||0==parseFloat(e)))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-log-inputs"),wpd.gettext("calibration-enter-valid-log"),c),!1;k.setDataAt(0,a,d);k.setDataAt(1,b,d);k.setDataAt(2,a,d);k.setDataAt(3,b,e);if(!g.calibrate(k,
f,h))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-inputs"),wpd.gettext("calibration-enter-valid"),c),!1;a=wpd.appData.getPlotData();a.axes=g;a.calibration=k;wpd.popup.close("xyAlignment");return!0}}}();
wpd.barCalibration=function(){function c(){wpd.popup.show("barAlignment")}return{start:function(){wpd.popup.show("barAxesInfo")},reload:function(){var a=new wpd.AxesCornersTool(2,2,["P1","P2"],!0);wpd.graphicsWidget.setTool(a)},pickCorners:function(){wpd.popup.close("barAxesInfo");var a=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(a)},getCornerValues:c,align:function(){var a=document.getElementById("bar-axes-p1").value,b=document.getElementById("bar-axes-p2").value,d=document.getElementById("bar-axes-log-scale").checked,
e=document.getElementById("bar-axes-rotated").checked,f=new wpd.BarAxes,h=wpd.alignAxes.getActiveCalib();h.setDataAt(0,0,a);h.setDataAt(1,0,b);if(!f.calibrate(h,d,e))return wpd.popup.close("barAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-inputs"),wpd.gettext("calibration-enter-valid"),c),!1;a=wpd.appData.getPlotData();a.axes=f;a.calibration=h;wpd.popup.close("barAlignment");return!0}}}();
wpd.polarCalibration=function(){return{start:function(){wpd.popup.show("polarAxesInfo")},reload:function(){var c=new wpd.AxesCornersTool(3,2,["Origin","P1","P2"],!0);wpd.graphicsWidget.setTool(c)},pickCorners:function(){wpd.popup.close("polarAxesInfo");var c=new wpd.AxesCornersTool(3,2,["Origin","P1","P2"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("polarAlignment")},align:function(){var c=parseFloat(document.getElementById("polar-r1").value),a=parseFloat(document.getElementById("polar-theta1").value),
b=parseFloat(document.getElementById("polar-r2").value),d=parseFloat(document.getElementById("polar-theta2").value),e=document.getElementById("polar-degrees").checked;document.getElementById("polar-radians");var f=document.getElementById("polar-clockwise").checked,h=document.getElementById("polar-log-scale").checked,g=new wpd.PolarAxes,k=wpd.alignAxes.getActiveCalib();k.setDataAt(1,c,a);k.setDataAt(2,b,d);g.calibrate(k,e,f,h);c=wpd.appData.getPlotData();c.axes=g;c.calibration=k;wpd.popup.close("polarAlignment");
return!0}}}();
wpd.ternaryCalibration=function(){return{start:function(){wpd.popup.show("ternaryAxesInfo")},reload:function(){var c=new wpd.AxesCornersTool(3,3,["A","B","C"],!0);wpd.graphicsWidget.setTool(c)},pickCorners:function(){wpd.popup.close("ternaryAxesInfo");var c=new wpd.AxesCornersTool(3,3,["A","B","C"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("ternaryAlignment")},align:function(){document.getElementById("range0to1");var c=document.getElementById("range0to100").checked,a=
document.getElementById("ternarynormal").checked,b=new wpd.TernaryAxes,d=wpd.alignAxes.getActiveCalib();b.calibrate(d,c,a);c=wpd.appData.getPlotData();c.axes=b;c.calibration=d;wpd.popup.close("ternaryAlignment");return!0}}}();
wpd.mapCalibration=function(){return{start:function(){wpd.popup.show("mapAxesInfo")},reload:function(){var c=new wpd.AxesCornersTool(2,2,["P1","P2"],!0);wpd.graphicsWidget.setTool(c)},pickCorners:function(){wpd.popup.close("mapAxesInfo");var c=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("mapAlignment")},align:function(){var c=parseFloat(document.getElementById("scaleLength").value),a=document.getElementById("scaleUnits").value,
b=new wpd.MapAxes,d=wpd.alignAxes.getActiveCalib();b.calibrate(d,c,a);c=wpd.appData.getPlotData();c.axes=b;c.calibration=d;wpd.popup.close("mapAlignment");return!0}}}();
wpd.AxesCornersTool=function(){return function(c,a,b,d){var e=0,f=new wpd.Calibration(a),h=!0;d?(e=c,f=wpd.alignAxes.getActiveCalib(),h=!1):(e=0,f=new wpd.Calibration(a),h=!0,f.labels=b,wpd.alignAxes.setActiveCalib(f),wpd.graphicsWidget.resetData());this.onMouseClick=function(a,b,d){h?(e+=1,b=wpd.alignAxes.getActiveCalib(),b.addPoint(d.x,d.y,0,0),b.unselectAll(),b.selectPoint(e-1),wpd.graphicsWidget.forceHandlerRepaint(),e===c&&(h=!1,wpd.alignAxes.calibrationCompleted())):(b=wpd.alignAxes.getActiveCalib(),
b.unselectAll(),b.selectNearestPoint(d.x,d.y),wpd.graphicsWidget.forceHandlerRepaint());wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){var b=wpd.alignAxes.getActiveCalib();if(0!==b.getSelectedPoints().length){var c=b.getPoint(b.getSelectedPoints()[0]),e=c.px,c=c.py,d=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))c-=d;else if(wpd.keyCodes.isDown(a.keyCode))c+=d;else if(wpd.keyCodes.isLeft(a.keyCode))e-=
d;else if(wpd.keyCodes.isRight(a.keyCode))e+=d;else return;b.changePointPx(b.getSelectedPoints()[0],e,c);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e,c);a.preventDefault();a.stopPropagation()}}}}();
wpd.AlignmentCornersRepainter=function(){return function(){this.painterName="AlignmentCornersReptainer";this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()};this.onRedraw=function(){var c=wpd.alignAxes.getActiveCalib();if(null!=c){var a;for(a=0;a<c.getCount();a++){var b=c.getPoint(a);b={x:b.px,y:b.py};var d=c.isPointSelected(a)?"rgba(0,200,0,1)":"rgba(200,0,0,1)";wpd.graphicsHelper.drawPoint(b,d,c.labels[a])}}}}}();
wpd.alignAxes=function(){var c,a;return{start:function(){xyEl=document.getElementById("r_xy");polarEl=document.getElementById("r_polar");ternaryEl=document.getElementById("r_ternary");mapEl=document.getElementById("r_map");imageEl=document.getElementById("r_image");barEl=document.getElementById("r_bar");wpd.popup.close("axesList");if(!0===xyEl.checked)a=wpd.xyCalibration;else if(!0===barEl.checked)a=wpd.barCalibration;else if(!0===polarEl.checked)a=wpd.polarCalibration;else if(!0===ternaryEl.checked)a=
wpd.ternaryCalibration;else if(!0===mapEl.checked)a=wpd.mapCalibration;else if(!0===imageEl.checked){a=null;var b=new wpd.ImageAxes;b.calibrate();wpd.appData.getPlotData().axes=b;wpd.appData.isAligned(!0);wpd.acquireData.load();wpd.tree.refresh();b=wpd.appData.getPlotData().dataSeriesColl;0<b.length&&(b=b[0].name,wpd.tree.selectPath("/"+wpd.gettext("datasets")+"/"+b,!0))}null!=a&&(a.start(),wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter))},calibrationCompleted:function(){wpd.sidebar.show("axes-calibration-sidebar")},
getCornerValues:function(){a.getCornerValues()},align:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();if(a.align()){wpd.appData.isAligned(!0);wpd.acquireData.load();wpd.tree.refresh();var b=wpd.appData.getPlotData().dataSeriesColl;0<b.length&&(b=b[0].name,wpd.tree.selectPath("/"+wpd.gettext("datasets")+"/"+b,!0))}},getActiveCalib:function(){return c},setActiveCalib:function(a){c=a},editAlignment:function(){wpd.appData.isAligned()&&null!=
a?wpd.popup.show("edit-or-reset-calibration-popup"):wpd.popup.show("axesList")},reloadCalibrationForEditing:function(){wpd.popup.close("edit-or-reset-calibration-popup");a.reload();wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter);wpd.graphicsWidget.forceHandlerRepaint();wpd.sidebar.show("axes-calibration-sidebar")}}}();wpd=wpd||{};
wpd.autoExtraction=function(){return{start:function(){wpd.colorPicker.init();wpd.algoManager.updateAlgoList()},changeDataset:function(){var c=document.getElementById("automatic-sidebar-dataset-list").selectedIndex;wpd.appData.getPlotData().setActiveDataSeriesIndex(c);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()}}}();
wpd.algoManager=function(){function c(){var a=document.getElementById("auto-extract-algo-name").value,c=wpd.appData.getPlotData().getAutoDetector();c.algorithm="averagingWindow"===a?new wpd.AveragingWindowAlgo:"XStepWithInterpolation"===a?new wpd.XStepWithInterpolationAlgo:"XStep"===a?new wpd.AveragingWindowWithStepSizeAlgo:"blobDetector"===a?new wpd.BlobDetectorAlgo:"barExtraction"===a||"histogram"===a?new wpd.BarExtractionAlgo:new wpd.AveragingWindowAlgo;var c=c.algorithm,a=document.getElementById("algo-parameter-container"),
c=c.getParamList(),e,f="<table>";for(e=0;e<c.length;e++)f+="<tr><td>"+c[e][0]+'</td><td><input type="text" size=3 id="algo-param-'+e+'" class="algo-params" value="'+c[e][2]+'"/></td><td>'+c[e][1]+"</td></tr>";a.innerHTML=f+"</table>"}var a;return{updateAlgoList:function(){var b="",d=wpd.appData.getPlotData().axes,e=document.getElementById("auto-extract-algo-name");d!==a&&(a=d,d instanceof wpd.BarAxes||(b+='<option value="averagingWindow">'+wpd.gettext("averaging-window")+"</option>"),d instanceof
wpd.XYAxes&&(b+='<option value="XStepWithInterpolation">'+wpd.gettext("x-step-with-interpolation")+"</option>",b+='<option value="XStep">'+wpd.gettext("x-step")+"</option>"),d instanceof wpd.BarAxes||(b+='<option value="blobDetector">'+wpd.gettext("blob-detector")+"</option>"),d instanceof wpd.BarAxes&&(b+='<option value="barExtraction">'+wpd.gettext("bar-extraction")+"</option>"),d instanceof wpd.XYAxes&&(b+='<option value="histogram">'+wpd.gettext("histogram")+"</option>"),e.innerHTML=b,c())},applyAlgoSelection:c,
run:function(){wpd.busyNote.show();setTimeout(function(){var a=wpd.appData.getPlotData().getAutoDetector(),c=a.algorithm,e=new wpd.DataPointsRepainter,f=document.getElementsByClassName("algo-params"),h,g=wpd.graphicsWidget.getAllContexts(),k=wpd.graphicsWidget.getImageSize();for(h=0;h<f.length;h++){var l=f[h].id;l=parseInt(l.replace("algo-param-",""),10);c.setParam(l,parseFloat(f[h].value))}wpd.graphicsWidget.removeTool();a.imageData=g.oriImageCtx.getImageData(0,0,k.width,k.height);a.generateBinaryData();
wpd.graphicsWidget.setRepainter(e);c.run(wpd.appData.getPlotData());wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount();wpd.busyNote.close();return!0},10)}}}();wpd=wpd||{};
wpd.colorSelectionWidget=function(){function c(){document.getElementById("color-selection-selected-color-box").style.backgroundColor="rgb("+a[0]+","+a[1]+","+a[2]+")";document.getElementById("color-selection-red").value=a[0];document.getElementById("color-selection-green").value=a[1];document.getElementById("color-selection-blue").value=a[2];var b=document.getElementById("color-selection-options"),c=wpd.appData.getPlotData().topColors,e=10<c.length?10:c.length,d,l="";for(d=0;d<e;d++){var m="rgb("+
c[d].r+","+c[d].g+","+c[d].b+");";var n=c[d].percentage.toFixed(3)+"%";l+='<div class="colorOptionBox" style="background-color: '+m+'" title="'+n+'" onclick="wpd.colorSelectionWidget.selectTopColor('+d+');"></div>'}b.innerHTML=l;wpd.popup.show("color-selection-widget")}var a,b,d,e;return{setParams:function(c){a=c.color;b=c.triggerElementId;d=c.title;e=c.setColorDelegate;document.getElementById("color-selection-title").innerHTML=d},startPicker:c,pickColor:function(){wpd.popup.close("color-selection-widget");
var b=new wpd.ColorPickerTool;b.onComplete=function(b){a=b;e(b);wpd.graphicsWidget.removeTool();c()};wpd.graphicsWidget.setTool(b)},setColor:function(){var c=[];c[0]=parseInt(document.getElementById("color-selection-red").value,10);c[1]=parseInt(document.getElementById("color-selection-green").value,10);c[2]=parseInt(document.getElementById("color-selection-blue").value,10);a=c;e(c);wpd.popup.close("color-selection-widget");c=document.getElementById(b);c.style.backgroundColor="rgb("+a[0]+","+a[1]+
","+a[2]+")";c.style.color=200>a[0]+a[1]+a[2]?"rgb(255,255,255)":"rgb(0,0,0)"},selectTopColor:function(b){var d=[],f=wpd.appData.getPlotData().topColors;d[0]=f[b].r;d[1]=f[b].g;d[2]=f[b].b;a=d;e(d);c()},paintFilteredColor:function(a,b){var c=wpd.graphicsWidget.getAllContexts();wpd.appData.getPlotData().getAutoDetector();var e=wpd.graphicsWidget.getImageSize(),d;var f=c.oriDataCtx.getImageData(0,0,e.width,e.height);if(null!=b&&0!==b.length){for(d=0;d<b.length;d++){var h=b[d];!0===a[h]?(parseInt(h/
e.width,10),f.data[4*h]=255,f.data[4*h+1]=255,f.data[4*h+2]=0,f.data[4*h+3]=255):(f.data[4*h]=0,f.data[4*h+1]=0,f.data[4*h+2]=0,f.data[4*h+3]=150)}c.oriDataCtx.putImageData(f,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}}}}();
wpd.colorPicker=function(){function c(){return{color:wpd.appData.getPlotData().getAutoDetector().fgColor,triggerElementId:"color-button",title:wpd.gettext("specify-foreground-color"),setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().fgColor=a}}}function a(){return{color:wpd.appData.getPlotData().getAutoDetector().bgColor,triggerElementId:"color-button",title:wpd.gettext("specify-background-color"),setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().bgColor=
a}}}function b(){var a=document.getElementById("color-button"),b=document.getElementById("color-distance-value"),c=wpd.appData.getPlotData().getAutoDetector(),h=document.getElementById("color-detection-mode-select");var g="fg"===c.colorDetectionMode?c.fgColor:c.bgColor;color_distance=c.colorDistance;a.style.backgroundColor="rgb("+g[0]+","+g[1]+","+g[2]+")";b.value=color_distance;h.value=c.colorDetectionMode}return{startPicker:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();
wpd.graphicsWidget.resetData();"fg"===wpd.appData.getPlotData().getAutoDetector().colorDetectionMode?wpd.colorSelectionWidget.setParams(c()):wpd.colorSelectionWidget.setParams(a());wpd.colorSelectionWidget.startPicker()},changeDetectionMode:function(){var a=document.getElementById("color-detection-mode-select");wpd.appData.getPlotData().getAutoDetector().colorDetectionMode=a.value;b()},changeColorDistance:function(){var a=parseFloat(document.getElementById("color-distance-value").value);wpd.appData.getPlotData().getAutoDetector().colorDistance=
a},init:b,testColorDetection:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.ColorFilterRepainter);var a=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getAutoDetector(),c=wpd.graphicsWidget.getImageSize();b.imageData=a.oriImageCtx.getImageData(0,0,c.width,c.height);b.generateBinaryData();wpd.colorSelectionWidget.paintFilteredColor(b.binaryData,b.mask)}}}();
wpd.ColorPickerTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts();this.onMouseClick=function(a,b,d){var e=c.oriImageCtx.getImageData(d.x,d.y,1,1);a=e.data[0];b=e.data[1];d=e.data[2];0===e.data[3]&&(d=b=a=255);this.onComplete([a,b,d])};this.onComplete=function(a){}}}();
wpd.ColorFilterRepainter=function(){return function(){this.painterName="colorFilterRepainter";this.onRedraw=function(){var c=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(c.binaryData,c.mask)}}}();wpd=wpd||{};
wpd.plotDataProvider=function(){return{getDatasetNames:function(){var c=wpd.appData.getPlotData(),a=[],b;for(b=0;b<c.dataSeriesColl.length;b++)a[b]=c.dataSeriesColl[b].name;return a},getDatasetIndex:function(){return wpd.appData.getPlotData().getActiveDataSeriesIndex()},setDatasetIndex:function(c){wpd.appData.getPlotData().setActiveDataSeriesIndex(c);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},getData:function(){if(wpd.appData.getPlotData().axes instanceof wpd.BarAxes){var c=
[],a=wpd.appData.getPlotData(),b=a.getActiveDataSeries(),a=a.axes,d;for(d=0;d<b.getCount();d++){var e=b.getPixel(d);var f=a.pixelToData(e.x,e.y);c[d]=[];e=null==e.metadata?"Bar"+d:e.metadata[0];c[d][0]=e;c[d][1]=f[0]}return{fields:["Label","Value"],fieldDateFormat:[],rawData:c,allowConnectivity:!1,connectivityFieldIndices:[],isFieldSortable:[!1,!0]}}b=wpd.appData.getPlotData();c=b.getActiveDataSeries();b=b.axes;a=[];d=[];f=[];e=[];var h,g,k=c.hasMetadata(),l=c.getMetadataKeys(),m=!0===k?l.length:
0;for(h=0;h<c.getCount();h++){var n=c.getPixel(h);var p=b.pixelToData(n.x,n.y);f[h]=[];for(g=0;g<p.length;g++)f[h][g]=p[g];for(g=0;g<m;g++){var r=null==n.metadata||null==n.metadata[g]?0:n.metadata[g];f[h][p.length+g]=r}}c=b.getAxesLabels();k&&(c=c.concat(l));for(g=0;g<c.length;g++)g<b.getDimensions()&&(d[g]=g,null!=b.isDate&&b.isDate(g)&&(a[g]=b.getInitialDateFormat(g))),e[g]=!0;return{fields:c,fieldDateFormat:a,rawData:f,allowConnectivity:!0,connectivityFieldIndices:d,isFieldSortable:e}}}}();
wpd.measurementDataProvider=function(){var c="distance";return{getDatasetNames:function(){if("angle"===c)return["Angle Measurements"];if("distance"===c)return["Distance Measurements"]},getDatasetIndex:function(){return 0},setDatasetIndex:function(a){},setDataSource:function(a){c=a},getData:function(){var a=[],b=[],d=[],e=wpd.appData.getPlotData(),f=e.axes,h=wpd.appData.isAligned()&&f instanceof wpd.MapAxes;if("distance"===c){d=e.distanceMeasurementData;for(a=0;a<d.connectionCount();a++)b[a]=[],b[a][0]=
"Dist"+a,b[a][1]=h?f.pixelToDataDistance(d.getDistance(a)):d.getDistance(a);a=["Label","Distance"];d=[!1,!0]}else if("angle"===c){d=e.angleMeasurementData;for(a=0;a<d.connectionCount();a++)b[a]=[],b[a][0]="Theta"+a,b[a][1]=d.getAngle(a);a=["Label","Angle"];d=[!1,!0]}return{fields:a,fieldDateFormat:[],rawData:b,allowConnectivity:!1,connectivityFieldIndices:[],isFieldSortable:d}}}}();wpd=wpd||{};
wpd.graphicsHelper=function(){return{drawPoint:function(c,a,b){var d=wpd.graphicsWidget.screenPx(c.x,c.y),e=wpd.graphicsWidget.getAllContexts(),f=wpd.graphicsWidget.getImageSize().height;if(null!=b){e.dataCtx.font="15px sans-serif";var h=e.dataCtx.measureText(b).width;e.dataCtx.fillStyle="rgba(255, 255, 255, 0.7)";e.dataCtx.fillRect(d.x-13,d.y-8,h+5,35);e.dataCtx.fillStyle=a;e.dataCtx.fillText(b,d.x-10,d.y+18)}e.dataCtx.beginPath();e.dataCtx.fillStyle=a;e.dataCtx.strokeStyle="rgb(255, 255, 255)";
e.dataCtx.arc(d.x,d.y,4,0,2*Math.PI,!0);e.dataCtx.fill();e.dataCtx.stroke();null!=b&&(e.oriDataCtx.font="15px sans-serif",e.oriDataCtx.fillStyle=a,e.oriDataCtx.fillText(b,c.x-10,c.y+18));e.oriDataCtx.beginPath();e.oriDataCtx.fillStyle=a;e.oriDataCtx.strokeStyle="rgb(255, 255, 255)";e.oriDataCtx.arc(c.x,c.y,1500<f?4:2,0,2*Math.PI,!0);e.oriDataCtx.fill();e.oriDataCtx.stroke()}}}();wpd=wpd||{};
wpd.gridDetection=function(){function c(a,b,c){var e=wpd.appData.getPlotData().backupImageData,d;for(d=0;d<e.data.length;d++)a.data[d]=e.data[d];return{imageData:a,width:b,height:c,keepZoom:!0}}function a(){wpd.graphicsWidget.removeTool();wpd.appData.getPlotData().gridData=null;wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();null!=wpd.appData.getPlotData().backupImageData&&wpd.graphicsWidget.runImageOp(c)}function b(a,b,c){var e=wpd.appData.getPlotData().gridData,d=wpd.appData.getPlotData().topColors[0],
f,h;null==d&&(d={r:255,g:0,b:0});if(null!=e)for(f=0;f<c;f++)for(h=0;h<b;h++){var n=4*(f*b+h);!0===e[n/4]&&(a.data[n]=d.r,a.data[n+1]=d.g,a.data[n+2]=d.b,a.data[n+3]=255)}return{imageData:a,width:b,height:c}}function d(){var a=parseFloat(document.getElementById("grid-color-distance").value);wpd.appData.getPlotData().getAutoDetector().gridColorDistance=a}return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();wpd.sidebar.show("grid-detection-sidebar");
var a=document.getElementById("grid-color-picker-button"),b=document.getElementById("grid-background-mode"),c=wpd.appData.getPlotData().getAutoDetector(),d=c.gridLineColor,c=c.gridBackgroundMode;null!=d&&(a.style.backgroundColor="rgb("+d[0]+","+d[1]+","+d[2]+")",a.style.color=200>d[0]+d[1]+d[2]?"rgb(255,255,255)":"rgb(0,0,0)");b.checked=c;a=wpd.appData.getPlotData().getAutoDetector();b=wpd.graphicsWidget.getAllContexts();d=wpd.graphicsWidget.getImageSize();a.imageData=b.oriImageCtx.getImageData(0,
0,d.width,d.height)},markBox:function(){var a=new wpd.GridBoxTool;wpd.graphicsWidget.setTool(a)},clearMask:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.appData.getPlotData().getAutoDetector().gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};wpd.graphicsWidget.resetData()},viewMask:function(){var a=new wpd.GridViewMaskTool;wpd.graphicsWidget.setTool(a)},grabMask:function(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.graphicsWidget.getImageSize(),
a=a.oriDataCtx.getImageData(0,0,b.width,b.height),c=[],d,k=0,l=wpd.appData.getPlotData().getAutoDetector();for(d=0;d<a.data.length;d+=4)if(255===a.data[d]&&255===a.data[d+1]&&0===a.data[d+2]){c[k]=d/4;k++;var m=parseInt(d/4%b.width,10);var n=parseInt(d/4/b.width,10);1===k?(l.gridMask.xmin=m,l.gridMask.xmax=m,l.gridMask.ymin=n,l.gridMask.ymax=n):(m<l.gridMask.xmin&&(l.gridMask.xmin=m),m>l.gridMask.xmax&&(l.gridMask.xmax=m),n<l.gridMask.ymin&&(l.gridMask.ymin=n),n>l.gridMask.ymax&&(l.gridMask.ymax=
n))}l.gridMask.pixels=c},startColorPicker:function(){wpd.colorSelectionWidget.setParams({color:wpd.appData.getPlotData().getAutoDetector().gridLineColor,triggerElementId:"grid-color-picker-button",title:"Specify Grid Line Color",setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().gridLineColor=a}});wpd.colorSelectionWidget.startPicker()},changeColorDistance:d,changeBackgroundMode:function(){var a=document.getElementById("grid-background-mode").checked;wpd.appData.getPlotData().getAutoDetector().gridBackgroundMode=
a},testColor:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.GridColorFilterRepainter);var a=wpd.appData.getPlotData().getAutoDetector();d();a.generateGridBinaryData();wpd.colorSelectionWidget.paintFilteredColor(a.gridBinaryData,a.gridMask.pixels)},run:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();a();var c=wpd.appData.getPlotData().getAutoDetector(),d=wpd.graphicsWidget.getAllContexts(),
h=wpd.graphicsWidget.getImageSize(),g=document.getElementById("grid-horiz-perc"),k=document.getElementById("grid-vert-perc"),l=document.getElementById("grid-horiz-enable").checked,m=document.getElementById("grid-vert-enable").checked;document.getElementById("grid-background-mode");var n=wpd.appData.getPlotData();null==n.backupImageData&&(n.backupImageData=d.oriImageCtx.getImageData(0,0,h.width,h.height));c.imageData=d.oriImageCtx.getImageData(0,0,h.width,h.height);c.generateGridBinaryData();wpd.gridDetectionCore.setHorizontalParameters(l,
g.value);wpd.gridDetectionCore.setVerticalParameters(m,k.value);wpd.gridDetectionCore.run();wpd.graphicsWidget.runImageOp(b);wpd.appData.getPlotData().gridData=null},reset:a}}();wpd.GridColorFilterRepainter=function(){return function(){this.painterName="gridColorFilterRepainter";this.onRedraw=function(){var c=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(c.gridBinaryData,c.gridMask.pixels)}}}();
wpd.GridBoxTool=function(){return function(){var c=!1,a,b,d=wpd.graphicsWidget.getAllContexts(),e,f,h=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(b.x,b.y,f.x-b.x,f.y-b.y)},g=function(f,h,g){!1!==c&&(clearTimeout(e),c=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,0.8)",d.dataCtx.fillRect(b.x,b.y,h.x-b.x,h.y-b.y),d.oriDataCtx.fillStyle="rgba(255,255,0,0.8)",d.oriDataCtx.fillRect(a.x,a.y,g.x-a.x,g.y-a.y))},k=null,l=null;
this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-box").classList.add("pressed-button");document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onMouseDown=function(d,e,f){!0!==c&&(c=!0,a=f,b=e)};this.onMouseMove=function(a,b,d){!1!==c&&(f=b,clearTimeout(e),e=setTimeout(h,2))};this.onMouseOut=function(a,b,d){!0===c&&(clearTimeout(e),k=b,l=d)};this.onDocumentMouseUp=function(a,b,c){null!=k&&null!=l?g(a,k,l):
g(a,b,c);l=k=null};this.onMouseUp=function(a,b,c){g(a,b,c)};this.onRemove=function(){document.getElementById("grid-mask-box").classList.remove("pressed-button");document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridMaskPainter=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData().getAutoDetector(),b=function(){if(null!=a.gridMask.pixels&&0!==a.gridMask.pixels.length){var b=wpd.graphicsWidget.getImageSize();imgData=c.oriDataCtx.getImageData(0,0,b.width,b.height);for(b=0;b<a.gridMask.pixels.length;b++){var e=a.gridMask.pixels[b];imgData.data[4*e]=255;imgData.data[4*e+1]=255;imgData.data[4*e+2]=0;imgData.data[4*e+3]=200}c.oriDataCtx.putImageData(imgData,0,0);
wpd.graphicsWidget.copyImageDataLayerToScreen()}};this.painterName="gridMaskPainter";this.onRedraw=function(){wpd.gridDetection.grabMask();b()};this.onAttach=function(){wpd.graphicsWidget.resetData();b()}}}();wpd=wpd||{};
wpd.imageOps=function(){function c(a,c,e){var b,d,g;for(b=0;b<e;b++)for(d=0;d<c/2;d++){var k=4*(b*c+d);var l=4*((b+1)*c-(d+1));for(g=0;4>g;g++){var m=a.data[k+g];a.data[k+g]=a.data[l+g];a.data[l+g]=m}}return{imageData:a,width:c,height:e}}function a(a,c,e){var b,d,g;for(b=0;b<e/2;b++)for(d=0;d<c;d++){var k=4*(b*c+d);var l=4*((e-(b+2))*c+d);for(g=0;4>g;g++){var m=a.data[k+g];a.data[k+g]=a.data[l+g];a.data[l+g]=m}}return{imageData:a,width:c,height:e}}return{hflip:function(){wpd.graphicsWidget.runImageOp(c)},
vflip:function(){wpd.graphicsWidget.runImageOp(a)}}}();wpd=wpd||{};wpd.keyCodes=function(){return{isUp:function(c){return 38===c},isDown:function(c){return 40===c},isLeft:function(c){return 37===c},isRight:function(c){return 39===c},isTab:function(c){return 9===c},isDel:function(c){return 46===c},isBackspace:function(c){return 8===c},isAlphabet:function(c,a){return 90<c||65>c?!1:String.fromCharCode(c).toLowerCase()===a},isEnter:function(c){return 13===c},isEsc:function(c){return 27===c}}}();
wpd=wpd||{};
wpd.acquireData=function(){function c(){var a=new wpd.ManualSelectionTool;wpd.graphicsWidget.setTool(a)}function a(){var a=new wpd.DeleteDataPointTool;wpd.graphicsWidget.setTool(a)}function b(){wpd.appData.getPlotData().getActiveDataSeries().clearAll();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.dataPointCounter.setCount();wpd.graphicsWidget.removeRepainter()}function d(){wpd.sidebar.show("acquireDataSidebar");var a=wpd.appData.getPlotData().axes;document.getElementById("edit-data-labels").style.display=a instanceof
wpd.BarAxes?"inline-block":"none";wpd.dataPointCounter.setCount()}function e(){wpd.graphicsWidget.setTool(new wpd.AdjustDataPointTool)}function f(){wpd.graphicsWidget.setTool(new wpd.EditLabelsTool)}return{load:function(){wpd.appData.isAligned()?(wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.resetData(),d(),wpd.autoExtraction.start(),wpd.dataPointCounter.setCount(),wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter),c(),wpd.graphicsWidget.forceHandlerRepaint(),
wpd.dataPointCounter.setCount()):wpd.messagePopup.show(wpd.gettext("acquire-data"),wpd.gettext("acquire-data-calibration"))},manualSelection:c,adjustPoints:e,deletePoint:a,clearAll:function(){0>=wpd.appData.getPlotData().getActiveDataSeries().getCount()||wpd.okCancelPopup.show(wpd.gettext("clear-data-points"),wpd.gettext("clear-data-points-text"),b,function(){})},undo:function(){wpd.appData.getPlotData().getActiveDataSeries().removeLastPixel();wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();
wpd.dataPointCounter.setCount()},showSidebar:d,switchToolOnKeyPress:function(b){switch(b){case "d":a();break;case "a":c();break;case "s":e();break;case "e":f()}},isToolSwitchKey:function(a){return wpd.keyCodes.isAlphabet(a,"a")||wpd.keyCodes.isAlphabet(a,"s")||wpd.keyCodes.isAlphabet(a,"d")||wpd.keyCodes.isAlphabet(a,"e")?!0:!1},changeDataset:function(a){a=a.selectedIndex;wpd.appData.getPlotData().setActiveDataSeriesIndex(a);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},
editLabels:f}}();
wpd.dataPointLabelEditor=function(){function c(){var a=document.getElementById("data-point-label-field").value;null!=a&&0<a.length&&(b.setMetadataAt(d,[a]),wpd.graphicsWidget.resetData(),wpd.graphicsWidget.forceHandlerRepaint());wpd.popup.close("data-point-label-editor");wpd.graphicsWidget.setTool(e)}function a(){wpd.popup.close("data-point-label-editor");wpd.graphicsWidget.setTool(e)}var b,d,e;return{show:function(a,c,g){var f=a.getPixel(c).metadata[0];b=a;d=c;e=g;wpd.graphicsWidget.removeTool();wpd.popup.show("data-point-label-editor");
a=document.getElementById("data-point-label-field");a.value=f;a.focus()},ok:c,cancel:a,keydown:function(b){wpd.keyCodes.isEnter(b.keyCode)?c():wpd.keyCodes.isEsc(b.keyCode)&&a();b.stopPropagation()}}}();
wpd.ManualSelectionTool=function(){return function(){var c=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("manual-select-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(a,b,d){b=c.getActiveDataSeries();if(c.axes.dataPointsHaveLabels){var e=b.getMetadataKeys();null!=e&&"Label"===e[0]||b.setMetadataKeys(["Label"]);e=c.axes.dataPointsLabelPrefix+b.getCount();b.addPixel(d.x,d.y,[e]);wpd.graphicsHelper.drawPoint(d,
"rgb(200,0,0)",e)}else b.addPixel(d.x,d.y),wpd.graphicsHelper.drawPoint(d,"rgb(200,0,0)");wpd.graphicsWidget.updateZoomOnEvent(a);wpd.dataPointCounter.setCount();c.axes.dataPointsHaveLabels&&a.shiftKey&&wpd.dataPointLabelEditor.show(b,b.getCount()-1,this)};this.onRemove=function(){document.getElementById("manual-select-button").classList.remove("pressed-button")};this.onKeyDown=function(a){var b=c.getActiveDataSeries(),d=b.getCount()-1,e=b.getPixel(d),f=.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))e.y-=
f;else if(wpd.keyCodes.isDown(a.keyCode))e.y+=f;else if(wpd.keyCodes.isLeft(a.keyCode))e.x-=f;else if(wpd.keyCodes.isRight(a.keyCode))e.x+=f;else{wpd.acquireData.isToolSwitchKey(a.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(a.keyCode).toLowerCase());return}b.setPixelAt(d,e.x,e.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e.x,e.y);a.preventDefault()}}}();
wpd.DeleteDataPointTool=function(){return function(){wpd.graphicsWidget.getAllContexts();var c=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("delete-point-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(a,b,d){c.getActiveDataSeries().removeNearestPixel(d.x,d.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a);wpd.dataPointCounter.setCount()};
this.onKeyDown=function(a){wpd.acquireData.isToolSwitchKey(a.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(a.keyCode).toLowerCase())};this.onRemove=function(){document.getElementById("delete-point-button").classList.remove("pressed-button")}}}();
wpd.DataPointsRepainter=function(){return function(){var c=function(){var a=wpd.appData.getPlotData(),b=a.getActiveDataSeries();var c=b.getMetadataKeys();var e=!1;if(null!=a.axes)for(a.axes.dataPointsHaveLabels&&null!=c&&"Label"===c[0]&&(e=!0),c=0;c<b.getCount();c++){var f=b.getPixel(c);var h=(h=0<=b.getSelectedPixels().indexOf(c))?"rgb(0,200,0)":"rgb(200,0,0)";if(e){var g=f.metadata[0];null==g&&(g=a.axes.dataPointsLabelPrefix+c);wpd.graphicsHelper.drawPoint(f,h,g)}else wpd.graphicsHelper.drawPoint(f,
h)}};this.painterName="dataPointsRepainter";this.onAttach=function(){wpd.graphicsWidget.resetData();c()};this.onRedraw=function(){c()};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();c()}}}();
wpd.AdjustDataPointTool=function(){return function(){this.onAttach=function(){document.getElementById("manual-adjust-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter);wpd.toolbar.show("adjustDataPointsToolbar")};this.onRemove=function(){wpd.appData.getPlotData().getActiveDataSeries().unselectAll();wpd.graphicsWidget.forceHandlerRepaint();document.getElementById("manual-adjust-button").classList.remove("pressed-button");wpd.toolbar.clear()};this.onMouseClick=
function(c,a,b){a=wpd.appData.getPlotData().getActiveDataSeries();a.unselectAll();a.selectNearestPixel(b.x,b.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(c)};this.onKeyDown=function(c){if(wpd.acquireData.isToolSwitchKey(c.keyCode))wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(c.keyCode).toLowerCase());else{var a=wpd.appData.getPlotData().getActiveDataSeries(),b=a.getSelectedPixels()[0];if(null!=b){var d=a.getPixel(b),e=d.x,d=d.y,f=!0===c.shiftKey?5/wpd.graphicsWidget.getZoomRatio():
.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(c.keyCode))d-=f;else if(wpd.keyCodes.isDown(c.keyCode))d+=f;else if(wpd.keyCodes.isLeft(c.keyCode))e-=f;else if(wpd.keyCodes.isRight(c.keyCode))e+=f;else if(wpd.keyCodes.isAlphabet(c.keyCode,"q"))a.selectPreviousPixel(),b=a.getSelectedPixels()[0],d=a.getPixel(b),e=d.x,d=d.y;else if(wpd.keyCodes.isAlphabet(c.keyCode,"w"))a.selectNextPixel(),b=a.getSelectedPixels()[0],d=a.getPixel(b),e=d.x,d=d.y;else if(wpd.keyCodes.isAlphabet(c.keyCode,"e")){if(wpd.appData.getPlotData().axes.dataPointsHaveLabels){b=
a.getSelectedPixels()[0];c.preventDefault();c.stopPropagation();wpd.dataPointLabelEditor.show(a,b,this);return}}else{if(wpd.keyCodes.isDel(c.keyCode)||wpd.keyCodes.isBackspace(c.keyCode))a.removePixelAtIndex(b),a.unselectAll(),0<=a.findNearestPixel(e,d)&&(a.selectNearestPixel(e,d),b=a.getSelectedPixels()[0],d=a.getPixel(b),e=d.x,d=d.y),wpd.graphicsWidget.resetData(),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.updateZoomToImagePosn(e,d),wpd.dataPointCounter.setCount(),c.preventDefault(),
c.stopPropagation();return}a.setPixelAt(b,e,d);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e,d);c.preventDefault();c.stopPropagation()}}}}}();
wpd.EditLabelsTool=function(){this.onAttach=function(){document.getElementById("edit-data-labels").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onRemove=function(){document.getElementById("edit-data-labels").classList.remove("pressed-button");wpd.appData.getPlotData().getActiveDataSeries().unselectAll()};this.onMouseClick=function(c,a,b){a=wpd.appData.getPlotData().getActiveDataSeries();a.unselectAll();b=a.selectNearestPixel(b.x,b.y);0<=b&&(wpd.graphicsWidget.forceHandlerRepaint(),
wpd.graphicsWidget.updateZoomOnEvent(c),wpd.dataPointLabelEditor.show(a,b,this))};this.onKeyDown=function(c){wpd.acquireData.isToolSwitchKey(c.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(c.keyCode).toLowerCase())}};wpd.dataPointCounter=function(){return{setCount:function(){var c=document.getElementsByClassName("data-point-counter"),a;for(a=0;a<c.length;a++)c[a].innerHTML=wpd.appData.getPlotData().getActiveDataSeries().getCount()}}}();wpd=wpd||{};
wpd.dataMask=function(){function c(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.graphicsWidget.getImageSize(),a=a.oriDataCtx.getImageData(0,0,b.width,b.height),b=[],c,e=0,f=wpd.appData.getPlotData().getAutoDetector();for(c=0;c<a.data.length;c+=4)255===a.data[c]&&255===a.data[c+1]&&0===a.data[c+2]&&(b[e]=c/4,e++);f.mask=b}return{grabMask:c,markBox:function(){var a=new wpd.BoxMaskTool;wpd.graphicsWidget.setTool(a)},markPen:function(){var a=new wpd.PenMaskTool;wpd.graphicsWidget.setTool(a)},eraseMarks:function(){var a=
new wpd.EraseMaskTool;wpd.graphicsWidget.setTool(a)},viewMask:function(){var a=new wpd.ViewMaskTool;wpd.graphicsWidget.setTool(a)},clearMask:function(){wpd.graphicsWidget.resetData();c()}}}();
wpd.BoxMaskTool=function(){return function(){var c=!1,a,b,d=wpd.graphicsWidget.getAllContexts(),e,f,h=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(b.x,b.y,f.x-b.x,f.y-b.y)},g=function(f,h,g){!1!==c&&(clearTimeout(e),c=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,1)",d.dataCtx.fillRect(b.x,b.y,h.x-b.x,h.y-b.y),d.oriDataCtx.fillStyle="rgba(255,255,0,1)",d.oriDataCtx.fillRect(a.x,a.y,g.x-a.x,g.y-a.y))},k=null,l=null;this.onAttach=
function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("box-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button")};this.onMouseDown=function(e,d,f){!0!==c&&(c=!0,a=f,b=d)};this.onMouseMove=function(a,b,d){!1!==c&&(f=b,clearTimeout(e),e=setTimeout(h,2))};this.onMouseOut=function(a,b,d){!0===c&&(clearTimeout(e),k=b,l=d)};this.onDocumentMouseUp=function(a,b,c){null!=k&&null!=l?g(a,k,l):g(a,b,c);l=k=null};this.onMouseUp=
function(a,b,c){g(a,b,c)};this.onRemove=function(){document.getElementById("box-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.PenMaskTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=!1,b,d,e,f=function(){c.dataCtx.strokeStyle="rgba(255,255,0,1)";c.dataCtx.lineTo(d.x,d.y);c.dataCtx.stroke();c.oriDataCtx.strokeStyle="rgba(255,255,0,1)";c.oriDataCtx.lineTo(e.x,e.y);c.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("pen-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button");
wpd.toolbar.show("paintToolbar")};this.onMouseDown=function(b,e,d){!0!==a&&(b=parseInt(document.getElementById("paintThickness").value,10),a=!0,c.dataCtx.strokeStyle="rgba(255,255,0,1)",c.dataCtx.lineWidth=b*wpd.graphicsWidget.getZoomRatio(),c.dataCtx.beginPath(),c.dataCtx.moveTo(e.x,e.y),c.oriDataCtx.strokeStyle="rgba(255,255,0,1)",c.oriDataCtx.lineWidth=b,c.oriDataCtx.beginPath(),c.oriDataCtx.moveTo(d.x,d.y))};this.onMouseMove=function(c,g,k){!1!==a&&(d=g,e=k,clearTimeout(b),b=setTimeout(f,2))};
this.onMouseUp=function(e,d,f){clearTimeout(b);c.dataCtx.closePath();c.dataCtx.lineWidth=1;c.oriDataCtx.closePath();c.oriDataCtx.lineWidth=1;a=!1};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onRemove=function(){document.getElementById("pen-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();
wpd.EraseMaskTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=!1,b,d,e,f=function(){c.dataCtx.globalCompositeOperation="destination-out";c.oriDataCtx.globalCompositeOperation="destination-out";c.dataCtx.strokeStyle="rgba(255,255,0,1)";c.dataCtx.lineTo(d.x,d.y);c.dataCtx.stroke();c.oriDataCtx.strokeStyle="rgba(255,255,0,1)";c.oriDataCtx.lineTo(e.x,e.y);c.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("erase-mask").classList.add("pressed-button");
document.getElementById("view-mask").classList.add("pressed-button");wpd.toolbar.show("eraseToolbar")};this.onMouseDown=function(b,e,d){!0!==a&&(b=parseInt(document.getElementById("eraseThickness").value,10),a=!0,c.dataCtx.globalCompositeOperation="destination-out",c.oriDataCtx.globalCompositeOperation="destination-out",c.dataCtx.strokeStyle="rgba(0,0,0,1)",c.dataCtx.lineWidth=b*wpd.graphicsWidget.getZoomRatio(),c.dataCtx.beginPath(),c.dataCtx.moveTo(e.x,e.y),c.oriDataCtx.strokeStyle="rgba(0,0,0,1)",
c.oriDataCtx.lineWidth=b,c.oriDataCtx.beginPath(),c.oriDataCtx.moveTo(d.x,d.y))};this.onMouseMove=function(c,g,k){!1!==a&&(d=g,e=k,clearTimeout(b),b=setTimeout(f,2))};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onMouseUp=function(e,d,f){clearTimeout(b);c.dataCtx.closePath();c.dataCtx.lineWidth=1;c.oriDataCtx.closePath();c.oriDataCtx.lineWidth=1;c.dataCtx.globalCompositeOperation="source-over";c.oriDataCtx.globalCompositeOperation="source-over";a=!1};this.onRemove=function(){document.getElementById("erase-mask").classList.remove("pressed-button");
document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();wpd.ViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("view-mask").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.MaskPainter=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData().getAutoDetector(),b=function(){if(null!=a.mask&&0!==a.mask.length){var b=wpd.graphicsWidget.getImageSize();imgData=c.oriDataCtx.getImageData(0,0,b.width,b.height);for(b=0;b<a.mask.length;b++){var e=a.mask[b];imgData.data[4*e]=255;imgData.data[4*e+1]=255;imgData.data[4*e+2]=0;imgData.data[4*e+3]=255}c.oriDataCtx.putImageData(imgData,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}};
this.painterName="dataMaskPainter";this.onRedraw=function(){wpd.dataMask.grabMask();b()};this.onAttach=function(){wpd.graphicsWidget.resetData();b()}}}();wpd=wpd||{};
wpd.measurementModes={distance:{name:"distance",connectivity:2,addButtonId:"add-pair-button",deleteButtonId:"delete-pair-button",sidebarId:"measure-distances-sidebar",init:function(){var c=wpd.appData.getPlotData();null==c.distanceMeasurementData&&(c.distanceMeasurementData=new wpd.ConnectedPoints(2))},clear:function(){wpd.appData.getPlotData().distanceMeasurementData=new wpd.ConnectedPoints(2)},getData:function(){return wpd.appData.getPlotData().distanceMeasurementData}},angle:{name:"angle",connectivity:3,
addButtonId:"add-angle-button",deleteButtonId:"delete-angle-button",sidebarId:"measure-angles-sidebar",init:function(){var c=wpd.appData.getPlotData();null==c.angleMeasurementData&&(c.angleMeasurementData=new wpd.ConnectedPoints(3))},clear:function(){wpd.appData.getPlotData().angleMeasurementData=new wpd.ConnectedPoints(3)},getData:function(){return wpd.appData.getPlotData().angleMeasurementData}},openPath:{name:"open-path",connectivity:-1,addButtonId:"add-open-path-button",deleteButtonId:"delete-open-path-button",
sidebarId:"measure-open-path-sidebar",init:function(){var c=wpd.appData.getPlotData();null==c.openPathMeasurementData&&(c.openPathMeasurementData=new wpd.ConnectedPoints)},clear:function(){wpd.appData.getPlotData().openPathMeasurementData=new wpd.ConnectedPoints},getData:function(){return wpd.appData.getPlotData().openPathMeasurementData}},closedPath:{name:"closed-path",connectivity:-1,addButtonId:"add-closed-path-button",deleteButtonId:"delete-closed-path-button",sidebarId:"measure-closed-path-sidebar",
init:function(){var c=wpd.appData.getPlotData();null==c.closedPathMeasurementData&&(c.closedPathMeasurementData=new wpd.ConnectedPoints)},clear:function(){wpd.appData.getPlotData().closedPathMeasurementData=new wpd.ConnectedPoints},getData:function(){return wpd.appData.getPlotData().closedPathMeasurementData}}};
wpd.measurement=function(){var c;return{start:function(a){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();a.init();wpd.sidebar.show(a.sidebarId);wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(a));wpd.graphicsWidget.forceHandlerRepaint();c=a},addItem:function(){wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c))},deleteItem:function(){wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c))},clearAll:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();
c.clear()}}}();
wpd.AddMeasurementTool=function(){return function(c){var a=wpd.graphicsWidget.getAllContexts(),b=0,d=!0,e=[];this.onAttach=function(){document.getElementById(c.addButtonId).classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onRemove=function(){document.getElementById(c.addButtonId).classList.remove("pressed-button")};this.onKeyDown=function(a){wpd.keyCodes.isAlphabet(a.keyCode,"a")?(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c))):wpd.keyCodes.isAlphabet(a.keyCode,
"d")?(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c))):(wpd.keyCodes.isEnter(a.keyCode)||wpd.keyCodes.isEsc(a.keyCode))&&!0===d&&0>c.connectivity&&(d=!1,c.getData().addConnection(e),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c)))};this.onMouseClick=function(f,h,g){if(d){wpd.graphicsWidget.resetHover();e[2*b]=g.x;e[2*b+1]=g.y;b+=1;if(b===c.connectivity){d=!1;c.getData().addConnection(e);wpd.graphicsWidget.forceHandlerRepaint();
wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c));return}if(1<b){var k=wpd.graphicsWidget.screenPx(e[2*(b-2)],e[2*(b-2)+1]);a.dataCtx.beginPath();a.dataCtx.strokeStyle="rgb(0,0,10)";a.dataCtx.moveTo(k.x,k.y);a.dataCtx.lineTo(h.x,h.y);a.dataCtx.stroke();a.oriDataCtx.beginPath();a.oriDataCtx.strokeStyle="rgb(0,0,10)";a.oriDataCtx.moveTo(e[2*(b-2)],e[2*(b-2)+1]);a.oriDataCtx.lineTo(g.x,g.y);a.oriDataCtx.stroke()}a.dataCtx.beginPath();a.dataCtx.fillStyle="rgb(200, 0, 0)";a.dataCtx.arc(h.x,
h.y,3,0,2*Math.PI,!0);a.dataCtx.fill();a.oriDataCtx.beginPath();a.oriDataCtx.fillStyle="rgb(200,0,0)";a.oriDataCtx.arc(g.x,g.y,3,0,2*Math.PI,!0);a.oriDataCtx.fill()}wpd.graphicsWidget.updateZoomOnEvent(f)};this.onMouseMove=function(c,h,g){d&&1<=b&&(wpd.graphicsWidget.resetHover(),c=wpd.graphicsWidget.screenPx(e[2*(b-1)],e[2*(b-1)+1]),a.hoverCtx.beginPath(),a.hoverCtx.strokeStyle="rgb(0,0,0)",a.hoverCtx.moveTo(c.x,c.y),a.hoverCtx.lineTo(h.x,h.y),a.hoverCtx.stroke())}}}();
wpd.DeleteMeasurementTool=function(){return function(c){wpd.graphicsWidget.getAllContexts();wpd.appData.getPlotData();this.onAttach=function(){document.getElementById(c.deleteButtonId).classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onRemove=function(){document.getElementById(c.deleteButtonId).classList.remove("pressed-button")};this.onKeyDown=function(a){wpd.keyCodes.isAlphabet(a.keyCode,"a")?wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c)):
wpd.keyCodes.isAlphabet(a.keyCode,"d")&&wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c))};this.onMouseClick=function(a,b,d){c.getData().deleteNearestConnection(d.x,d.y);wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c));wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a)}}}();
wpd.AdjustMeasurementTool=function(){return function(c){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onMouseClick=function(a,b,d){c.getData().selectNearestPoint(d.x,d.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){if(wpd.keyCodes.isAlphabet(a.keyCode,"a"))wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c));else if(wpd.keyCodes.isAlphabet(a.keyCode,"d"))wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c));
else{var b=c.getData(),d=b.getSelectedConnectionAndPoint();if(0<=d.connectionIndex&&0<=d.pointIndex){var e=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():.5/wpd.graphicsWidget.getZoomRatio(),f=b.getPointAt(d.connectionIndex,d.pointIndex);if(wpd.keyCodes.isUp(a.keyCode))f.y-=e;else if(wpd.keyCodes.isDown(a.keyCode))f.y+=e;else if(wpd.keyCodes.isLeft(a.keyCode))f.x-=e;else if(wpd.keyCodes.isRight(a.keyCode))f.x+=e;else return;b.setPointAt(d.connectionIndex,d.pointIndex,f.x,f.y);wpd.graphicsWidget.forceHandlerRepaint();
wpd.graphicsWidget.updateZoomToImagePosn(f.x,f.y);a.preventDefault();a.stopPropagation()}}}}}();
wpd.MeasurementRepainter=function(){return function(c){var a=wpd.graphicsWidget.getAllContexts(),b=function(b,c,e,d,l,m,n,p){a.dataCtx.beginPath();a.dataCtx.strokeStyle="rgb(0,0,10)";a.dataCtx.moveTo(b,c);a.dataCtx.lineTo(e,d);a.dataCtx.stroke();a.oriDataCtx.beginPath();a.oriDataCtx.strokeStyle="rgb(0,0,10)";a.oriDataCtx.moveTo(l,m);a.oriDataCtx.lineTo(n,p);a.oriDataCtx.stroke()},d=function(b,c,e,d,l){a.dataCtx.beginPath();a.dataCtx.fillStyle=l?"rgb(0, 200, 0)":"rgb(200, 0, 0)";a.dataCtx.arc(b,c,
3,0,2*Math.PI,!0);a.dataCtx.fill();a.oriDataCtx.beginPath();a.oriDataCtx.fillStyle=l?"rgb(0,200,0)":"rgb(200,0,0)";a.oriDataCtx.arc(e,d,3,0,2*Math.PI,!0);a.oriDataCtx.fill()},e=function(b,c,e,d,l){b=parseInt(b,10);c=parseInt(c,10);e=parseInt(e,10);d=parseInt(d,10);a.dataCtx.font="14px sans-serif";var f=a.dataCtx.measureText(l).width;a.dataCtx.fillStyle="rgba(255, 255, 255, 0.7)";a.dataCtx.fillRect(b-5,c-15,f+10,25);a.dataCtx.fillStyle="rgb(200, 0, 0)";a.dataCtx.fillText(l,b,c);a.oriDataCtx.font="14px sans-serif";
f=a.oriDataCtx.measureText(l).width;a.oriDataCtx.fillStyle="rgba(255, 255, 255, 0.7)";a.oriDataCtx.fillRect(e-5,d-15,f+10,25);a.oriDataCtx.fillStyle="rgb(200, 0, 0)";a.oriDataCtx.fillText(l,e,d)};this.painterName="measurementRepainter-"+c.name;this.onAttach=function(){wpd.graphicsWidget.resetData()};this.onRedraw=function(){if(c.name===wpd.measurementModes.distance.name){var f=wpd.appData.getPlotData().distanceMeasurementData,h=f.connectionCount(),g,k=wpd.appData.getPlotData().axes;for(g=0;g<h;g++){var l=
f.getConnectionAt(g);var m=l[0];var n=l[1];var p=l[2];l=l[3];var r=f.isPointSelected(g,0);var t=f.isPointSelected(g,1);var u=!0===wpd.appData.isAligned()&&k instanceof wpd.MapAxes?"Dist"+g.toString()+": "+k.pixelToDataDistance(f.getDistance(g)).toFixed(2)+" "+k.getUnits():"Dist"+g.toString()+": "+f.getDistance(g).toFixed(2)+" px";var w=wpd.graphicsWidget.screenPx(m,n);var q=wpd.graphicsWidget.screenPx(p,l);b(w.x,w.y,q.x,q.y,m,n,p,l);d(w.x,w.y,m,n,r);d(q.x,q.y,p,l,t);e(.5*(w.x+q.x),.5*(w.y+q.y),.5*
(m+p),.5*(n+l),u)}}else if(c.name===wpd.measurementModes.angle.name){var f=wpd.appData.getPlotData().angleMeasurementData,h=f.connectionCount();for(g=0;g<h;g++){p=f.getConnectionAt(g);q=p[0];u=p[1];m=p[2];n=p[3];r=p[4];t=p[5];var v=f.isPointSelected(g,0);var y=f.isPointSelected(g,1);var B=f.isPointSelected(g,2);k="Theta"+g.toString()+": "+f.getAngle(g).toFixed(2)+"\u00b0";w=Math.atan2(u-n,q-m);l=Math.atan2(t-n,r-m);var x=wpd.graphicsWidget.screenPx(q,u);p=wpd.graphicsWidget.screenPx(m,n);var z=wpd.graphicsWidget.screenPx(r,
t);b(x.x,x.y,p.x,p.y,q,u,m,n);b(p.x,p.y,z.x,z.y,m,n,r,t);d(x.x,x.y,q,u,v);d(p.x,p.y,m,n,y);d(z.x,z.y,r,t,B);q=p.x;u=p.y;r=m;t=n;a.dataCtx.beginPath();a.dataCtx.strokeStyle="rgb(0,0,10)";a.dataCtx.arc(q,u,15,w,l,!0);a.dataCtx.stroke();a.oriDataCtx.beginPath();a.oriDataCtx.strokeStyle="rgb(0,0,10)";a.oriDataCtx.arc(r,t,15,w,l,!0);a.oriDataCtx.stroke();e(p.x+10,p.y+15,m+10,n+15,k)}}};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()}}}();wpd=wpd||{};
wpd.perspective=function(){return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();wpd.popup.show("perspective-info")},pickCorners:function(){},run:function(){},revert:function(){}}}();wpd.perspectiveCornersRepainter=function(){this.painterName="perspectiveCornersRepainter";this.onRedraw=function(){}};wpd.perspectiveCornersTool=function(){this.onAttach=function(){};this.onMouseDown=function(){};this.onRemove=function(){}};
wpd=wpd||{};wpd.ajax=function(){return{get:function(c,a){if(null!=a){var b=new XMLHttpRequest;b.onload=function(c){200===this.status&&a(b)};b.open("GET",c,!0);b.send()}},post:function(c,a,b){if(null!=b){var d=new XMLHttpRequest;d.onload=function(a){200===this.status&&b(d)};d.open("POST",c,!0);d.setRequestHeader("Content-type","application/json");d.send(a)}}}}();wpd=wpd||{};
wpd.args=function(){return{getValue:function(c){var a,b=window.location.search.substring(1).split("&");for(a=0;a<b.length;a++){var d=b[a].split("=");if(d[0]===c)return unescape(d[1])}return null}}}();wpd=wpd||{};
wpd.dataExport=function(){return{show:function(){},generateCSV:function(){wpd.popup.close("export-all-data-popup");var c=wpd.appData.getPlotData(),a=c.axes,b=c.dataSeriesColl,d;if(null==a||null==b||0===b.length)wpd.messagePopup.show(wpd.gettext("no-datasets-to-export-error"),wpd.gettext("no-datasets-to-export"));else{for(var e=a.getAxesLabels(),f=e.length,h=b.length*f,g=0,k,l=[],m=[],n=[],c=0;c<b.length;c++)for(k=b[c].getCount(),k>g&&(g=k),l.push(b[c].name),d=0;d<f;d++)0!==d&&l.push(""),m.push(e[d]);
for(c=0;c<g;c++){k=[];for(d=0;d<h;d++)k.push("");n.push(k)}for(c=0;c<b.length;c++)for(k=b[c].getCount(),d=0;d<k;d++){var e=b[c].getPixel(d),p=d,h=a,r=e,e=h.pixelToData(r.x,r.y);if(h instanceof wpd.XYAxes)for(p=0;1>=p;p++)h.isDate(p)&&(r=h.getInitialDateFormat(p),e[p]=wpd.dateConverter.formatDateNumber(e[p],r));else h instanceof wpd.BarAxes&&(e=["",e[0]],e[0]=null==r.metadata?"Bar"+p:r.metadata[0]);h=e;for(e=0;e<f;e++)n[d][c*f+e]=h[e]}a=l.join(",")+"\n"+m.join(",")+"\n";for(c=0;c<g;c++)a+=n[c].join(",")+
"\n";wpd.download.csv(a,"wpd_datasets.csv")}},exportToPlotly:function(){wpd.popup.close("export-all-data-popup");var c=wpd.appData.getPlotData(),a=c.dataSeriesColl,b,d,e=wpd.plotDataProvider,f={data:[]};if(null==c.axes||null==a||0===a.length)wpd.messagePopup.show(wpd.gettext("no-datasets-to-export-error"),wpd.gettext("no-datasets-to-export"));else{for(c=0;c<a.length;c++){e.setDatasetIndex(c);var h=e.getData();f.data[c]={};for(b=0;2>b;b++){var g=0===b?"x":"y";f.data[c][g]=[];for(d=0;d<h.rawData.length;d++)f.data[c][g][d]=
null!=h.fieldDateFormat[b]?wpd.dateConverter(h.rawData[d][b],"yyyy-mm-dd"):h.rawData[d][b]}}wpd.plotly.send(f)}}}}();wpd=wpd||{};
wpd.download=function(){function c(a,c){var b=document.createElement("a");b.href=URL.createObjectURL(new Blob([a]),{type:"text/plain"});b.download=c.replace(/[^a-zA-Z\d+\.\-_\s]/g,"_");b.style.display="none";document.body.appendChild(b);b.click();document.body.removeChild(b)}function a(a,c){var b=document.createElement("div");var d=document.createElement("form");var h=document.createElement("textarea");var g=document.createElement("input");g.type="hidden";d.setAttribute("method","post");d.setAttribute("action",
"internal/download/text");h.setAttribute("name","data");h.setAttribute("id","data");g.setAttribute("name","filename");g.setAttribute("id","filename");g.value=c.replace(/[^a-zA-Z\d+\.\-_\s]/g,"_");d.appendChild(h);d.appendChild(g);b.appendChild(d);document.body.appendChild(b);b.style.display="none";h.innerHTML=a;d.submit();document.body.removeChild(b)}return{json:function(b,d){null==d&&(d="wpd_plot_data.json");wpd.browserInfo.downloadAttributeSupported?c(b,d):a(b,d)},csv:function(b,d){null==d&&(d=
"data.csv");wpd.browserInfo.downloadAttributeSupported?c(b,d):a(b,d)}}}();wpd=wpd||{};
wpd.plotly=function(){return{send:function(c){var a=document.createElement("div"),b=document.createElement("form"),d=document.createElement("textarea");b.setAttribute("method","post");b.setAttribute("action","https://plot.ly/external");b.setAttribute("target","_blank");d.setAttribute("name","data");d.setAttribute("id","data");b.appendChild(d);a.appendChild(b);document.body.appendChild(a);a.style.display="none";c=JSON.stringify(c);d.innerHTML=c;b.submit();document.body.removeChild(a)}}}();
wpd=wpd||{};
wpd.saveResume=function(){function c(a){var b=wpd.appData.getPlotData();a=a.wpd;var c;b.reset();wpd.appData.isAligned(!1);if(null!=a.axesType&&("ImageAxes"===a.axesType||null!=a.calibration&&null!=a.axesParameters)){if("ImageAxes"!==a.axesType){var d="TernaryAxes"===a.axesType?new wpd.Calibration(3):new wpd.Calibration(2);for(c=0;c<a.calibration.length;c++)d.addPoint(a.calibration[c].px,a.calibration[c].py,a.calibration[c].dx,a.calibration[c].dy,a.calibration[c].dz);b.calibration=d}if("XYAxes"===a.axesType){if(b.axes=
new wpd.XYAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isLogX,a.axesParameters.isLogY))return}else if("BarAxes"===a.axesType){if(b.axes=new wpd.BarAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isLog))return}else if("PolarAxes"===a.axesType){if(b.axes=new wpd.PolarAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isDegrees,a.axesParameters.isClockwise))return}else if("TernaryAxes"===a.axesType){if(b.axes=new wpd.TernaryAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isRange100,
a.axesParameters.isNormalOrientation))return}else if("MapAxes"===a.axesType){if(b.axes=new wpd.MapAxes,!b.axes.calibrate(b.calibration,a.axesParameters.scaleLength,a.axesParameters.unitString))return}else"ImageAxes"===a.axesType&&(b.axes=new wpd.ImageAxes);wpd.appData.isAligned(!0);if(null!=a.dataSeries){for(c=0;c<a.dataSeries.length;c++){var e=a.dataSeries[c];b.dataSeriesColl[c]=new wpd.DataSeries;var l=b.dataSeriesColl[c];l.name=e.name;null!=e.metadataKeys&&l.setMetadataKeys(e.metadataKeys);for(d=
0;d<e.data.length;d++)l.addPixel(e.data[d].x,e.data[d].y,e.data[d].metadata)}if(null!=a.distanceMeasurementData)for(b.distanceMeasurementData=new wpd.ConnectedPoints(2),c=0;c<a.distanceMeasurementData.length;c++)b.distanceMeasurementData.addConnection(a.distanceMeasurementData[c]);if(null!=a.angleMeasurementData)for(b.angleMeasurementData=new wpd.ConnectedPoints(3),c=0;c<a.angleMeasurementData.length;c++)b.angleMeasurementData.addConnection(a.angleMeasurementData[c]);wpd.tree.refresh()}}}function a(){var a=
wpd.appData.getPlotData(),b=a.calibration,c={wpd:{version:[3,8],axesType:null,axesParameters:null,calibration:null,dataSeries:[],distanceMeasurementData:null,angleMeasurementData:null}},d;if(null!=b)for(c.wpd.calibration=[],d=0;d<b.getCount();d++)c.wpd.calibration[d]=b.getPoint(d);null!=a.axes&&(a.axes instanceof wpd.XYAxes?(c.wpd.axesType="XYAxes",c.wpd.axesParameters={isLogX:a.axes.isLogX(),isLogY:a.axes.isLogY()}):a.axes instanceof wpd.BarAxes?(c.wpd.axesType="BarAxes",c.wpd.axesParameters={isLog:a.axes.isLog()}):
a.axes instanceof wpd.PolarAxes?(c.wpd.axesType="PolarAxes",c.wpd.axesParameters={isDegrees:a.axes.isThetaDegrees(),isClockwise:a.axes.isThetaClockwise()}):a.axes instanceof wpd.TernaryAxes?(c.wpd.axesType="TernaryAxes",c.wpd.axesParameters={isRange100:a.axes.isRange100(),isNormalOrientation:a.axes.isNormalOrientation()}):a.axes instanceof wpd.MapAxes?(c.wpd.axesType="MapAxes",c.wpd.axesParameters={scaleLength:a.axes.getScaleLength(),unitString:a.axes.getUnits()}):a.axes instanceof wpd.ImageAxes&&
(c.wpd.axesType="ImageAxes"));for(d=0;d<a.dataSeriesColl.length;d++){b=a.dataSeriesColl[d];c.wpd.dataSeries[d]={name:b.name,data:[]};var k=b.getMetadataKeys();null!=k&&(c.wpd.dataSeries[d].metadataKeys=k);for(k=0;k<b.getCount();k++){var l=b.getPixel(k);c.wpd.dataSeries[d].data[k]=l;c.wpd.dataSeries[d].data[k].value=a.axes.pixelToData(l.x,l.y)}}if(null!=a.distanceMeasurementData)for(c.wpd.distanceMeasurementData=[],d=0;d<a.distanceMeasurementData.connectionCount();d++)c.wpd.distanceMeasurementData[d]=
a.distanceMeasurementData.getConnectionAt(d);if(null!=a.angleMeasurementData)for(c.wpd.angleMeasurementData=[],d=0;d<a.angleMeasurementData.connectionCount();d++)c.wpd.angleMeasurementData[d]=a.angleMeasurementData.getConnectionAt(d);return JSON.stringify(c)}function b(a){var b=new FileReader;b.onload=function(){var a=JSON.parse(b.result);c(a);wpd.graphicsWidget.resetData();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.appData.isAligned()&&wpd.acquireData.load();wpd.messagePopup.show(wpd.gettext("import-json"),
wpd.gettext("json-data-loaded"))};b.readAsText(file)}function d(a){wpd.busyNote.show();var b=new tarball.TarReader;b.readFile(a).then(function(a){wpd.busyNote.close();var d=a.findIndex(function(a){return a.name.endsWith("/info.json")});if(0<=d){a=a[d].name.replace("/info.json","");d=b.getFileBlob(a+"/image.png","image/png");d.name="image.png";var e=JSON.parse(b.getTextFile(a+"/wpd.json"));wpd.imageManager.loadFromFile(d,!0).then(function(){c(e);wpd.appData.isAligned()&&wpd.acquireData.load()})}},
function(a){console.log(a)})}return{save:function(){wpd.popup.show("export-json-window")},load:function(){wpd.popup.show("import-json-window")},downloadJSON:function(){var b="wpd_project.json".replace(/[^a-zA-Z\d+\.\-_\s]/g,"_");wpd.download.json(a(),b);wpd.popup.close("export-json-window")},downloadProject:function(){var b="wpd_project".replace(/[^a-zA-Z\d+\.\-_\s]/g,"_"),c=a(),d=wpd.graphicsWidget.getImagePNG(),g=JSON.stringify({version:[4,0],json:"wpd.json",image:"image.png"}),k=new tarball.TarWriter;
k.addFolder(b+"/");k.addTextFile(b+"/info.json",g);k.addTextFile(b+"/wpd.json",c);k.addFile(b+"/image.png",d);k.download(b+".tar");wpd.popup.close("export-json-window")},read:function(){var a=document.getElementById("import-json-file");wpd.popup.close("import-json-window");1===a.files.length&&(a=a.files[0],"application/json"==a.type?b(a):d(a))}}}();wpd=wpd||{};
wpd.scriptInjector=function(){return{start:function(){wpd.popup.show("runScriptPopup")},cancel:function(){wpd.popup.close("runScriptPopup")},load:function(){var c=document.getElementById("runScriptFileInput");wpd.popup.close("runScriptPopup");if(1==c.files.length){var a=new FileReader;a.onload=function(){"undefined"!==typeof wpdscript&&(wpdscript=null);eval(a.result);"wpdscript"!==typeof wpdscript&&(window.wpdscript=wpdscript,wpdscript.run())};a.readAsText(c.files[0])}}}}();wpd=wpd||{};
wpd.websocket=function(){function c(){e=!0}function a(){e=!1;f={}}function b(a){if(null!=a.data)if(console.log(a.data),a=JSON.parse(a.data),null!=a){var b=f[a.timestamp];null!=b&&b.requestId===a.id&&(b.callback(a.message),delete f[a.timestamp])}else alert("Server announcement: "+a),console.log(a)}var d,e,f={};return{connect:function(e){d=new WebSocket(e);d.onopen=c;d.onmessage=b;d.onclose=a},registerRequest:function(a,b){},registerNotification:function(a,b){},request:function(a,b,c){var g=Date.now();
b=JSON.stringify({type:"request",timestamp:g,id:a,message:b});f[g]={requestId:a,callback:c};e&&(console.log(b),d.send(b))},notify:function(a,b){var c=Date.now();a=JSON.stringify({type:"notification",timestamp:c,id:a,message:b});e&&(console.log(a),d.send(a))}}}();wpd=wpd||{};
wpd.browserInfo=function(){return{checkBrowser:function(){window.FileReader||alert("\tWARNING!\nYour web browser is not supported. This program might not behave as intended. Please use a recent version of Google Chrome, Firefox or Safari browser.")},downloadAttributeSupported:"download"in document.createElement("a")}}();wpd=wpd||{};
wpd.dataSeriesManagement=function(){function c(a){return 0<=wpd.appData.getPlotData().getDataSeriesNames().indexOf(a)?!0:!1}function a(){var a=wpd.appData.getPlotData().getActiveDataSeries();document.getElementById("rename-dataset-name-input").value=a.name;wpd.popup.show("rename-dataset-popup")}return{showAddDataset:function(){if(wpd.appData.isAligned()){for(var a=document.getElementById("add-single-dataset-name-input"),d=wpd.appData.getPlotData().getDataSeriesCount(),e=wpd.gettext("dataset")+" "+
d;c(e);)d++,e=wpd.gettext("dataset")+" "+d;a.value=e;wpd.popup.show("add-dataset-popup")}else wpd.messagePopup.show(wpd.gettext("acquire-data"),wpd.gettext("acquire-data-calibration"))},showRenameDataset:a,renameDataset:function(){var b=document.getElementById("rename-dataset-name-input");wpd.popup.close("rename-dataset-popup");if(c(b.value.trim()))wpd.messagePopup.show(wpd.gettext("rename-dataset-error"),wpd.gettext("dataset-exists-error"),a);else{var d=wpd.appData.getPlotData().getActiveDataSeries();
d.name=b.value.trim();wpd.tree.refresh();wpd.tree.selectPath("/"+wpd.gettext("datasets")+"/"+d.name,!0)}},addSingleDataset:function(){var a=document.getElementById("add-single-dataset-name-input");wpd.popup.close("add-dataset-popup");if(c(a.value.trim()))wpd.messagePopup.show(wpd.gettext("add-dataset-error"),wpd.gettext("dataset-exists-error"),function(){wpd.popup.show("add-dataset-popup")});else{var d=wpd.appData.getPlotData(),e=new wpd.DataSeries;e.name=a.value.trim();d.dataSeriesColl.push(e);wpd.tree.refreshPreservingSelection()}},
addMultipleDatasets:function(){var a=document.getElementById("add-multiple-datasets-count-input"),a=parseInt(a.value,0);wpd.popup.close("add-dataset-popup");if(0<a){for(var d=wpd.appData.getPlotData(),e=wpd.appData.getPlotData().getDataSeriesCount(),f=wpd.gettext("dataset")+" ",h=0;h<a;){var g=f+e;if(!c(g)){var k=new wpd.DataSeries;k.name=g;d.dataSeriesColl.push(k);h++}e++}wpd.tree.refreshPreservingSelection()}else wpd.messagePopup(wpd.gettext("add-dataset-error"),wpd.gettext("add-dataset-count-error"),
function(){wpd.popup.show("add-dataset-popup")})},deleteDataset:function(){wpd.okCancelPopup.show(wpd.gettext("delete-dataset"),wpd.gettext("delete-dataset-text"),function(){var a=wpd.appData.getPlotData(),c=a.getActiveDataSeriesIndex();0<=c&&(a.dataSeriesColl.splice(c,1),wpd.tree.refresh(),wpd.tree.selectPath("/"+wpd.gettext("datasets")))})}}}();wpd=wpd||{};wpd.gettext=function(c){return(c=document.getElementById("i18n-string-"+c))?c.innerHTML:"i18n string"};wpd=wpd||{};
wpd.imageManager=function(){function c(b,c){return new Promise(function(d,e){if(b.type.match("image.*")){wpd.busyNote.show();var f=new FileReader;f.onload=function(){a(f.result,c).then(d)};f.readAsDataURL(b)}else if("application/pdf"==b.type){wpd.busyNote.show();var h=new FileReader;h.onload=function(){PDFJS.getDocument(h.result).then(function(b){b.getPage(1).then(function(b){var f=b.getViewport(3),g=document.createElement("canvas"),h=g.getContext("2d");g.width=f.width;g.height=f.height;b.render({canvasContext:h,
viewport:f}).promise.then(function(){var b=g.toDataURL();a(b,c).then(d)},function(a){console.log(a);wpd.busyNote.close();e(a)})})})};h.readAsDataURL(b)}else console.log(b.type),wpd.messagePopup.show(wpd.gettext("invalid-file"),wpd.gettext("invalid-file-text"))})}function a(a,c){return new Promise(function(d,e){var f=new Image;f.onload=function(){wpd.appData.reset();wpd.sidebar.clear();var a=wpd.graphicsWidget.loadImage(f);wpd.appData.plotLoaded(a);wpd.busyNote.close();wpd.tree.refresh();b?wpd.sidebar.show("start-sidebar"):
c||wpd.popup.show("axesList");b=!1;d()};f.src=a})}var b=!0;return{saveImage:function(){wpd.graphicsWidget.saveImage()},loadFromURL:a,loadFromFile:c,load:function(){var a=document.getElementById("fileLoadBox");1==a.files.length&&c(a.files[0]);wpd.popup.close("loadNewImage")}}}();

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,b,a){c!=Array.prototype&&c!=Object.prototype&&(c[b]=a.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var b=0;return $jscomp.iteratorPrototype(function(){return b<c.length?{done:!1,value:c[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.iteratorFromArray=function(c,b){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var a=0,d={next:function(){if(a<c.length){var e=a++;return{value:b(e,c[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(c,b,a,d){if(b){a=$jscomp.global;c=c.split(".");for(d=0;d<c.length-1;d++){var e=c[d];e in a||(a[e]={});a=a[e]}c=c[c.length-1];d=a[c];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6-impl","es3");
$jscomp.checkStringArgs=function(c,b,a){if(null==c)throw new TypeError("The 'this' value for String.prototype."+a+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+a+" must not be a regular expression");return c+""};
$jscomp.polyfill("String.prototype.startsWith",function(c){return c?c:function(b,a){var c=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var e=c.length,f=b.length;a=Math.max(0,Math.min(a|0,c.length));for(var g=0;g<f&&a<e;)if(c[a++]!=b[g++])return!1;return g>=f}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(c){return c?c:function(b,a,c){var d=this.length||0;0>a&&(a=Math.max(0,d+a));if(null==c||c>d)c=d;c=Number(c);0>c&&(c=Math.max(0,d+c));for(a=Number(a||0);a<c;a++)this[a]=b;return this}},"es6-impl","es3");var wpd=wpd||{};wpd.initApp=function(){wpd.browserInfo.checkBrowser();wpd.layoutManager.initialLayout();wpd.loadRemoteData()||wpd.graphicsWidget.loadImageFromURL("start.png");document.getElementById("loadingCurtain").style.display="none"};
wpd.loadRemoteData=function(){return"undefined"===typeof wpdremote?!1:null!=wpdremote.status&&"fail"===wpdremote.status?(wpd.messagePopup.show("Remote Upload Failed!","Remote Upload Failed!"),!1):"success"===wpdremote.status&&null!=wpdremote.localUrl?(wpd.graphicsWidget.loadImageFromURL(wpdremote.localUrl),wpd.popup.show("axesList"),!0):!1};document.addEventListener("DOMContentLoaded",wpd.initApp,!0);wpd=wpd||{};
wpd.appData=function(){function c(){null==a&&(a=new wpd.PlotData);return a}var b=!1,a;return{isAligned:function(a){null!=a&&(b=a);return b},getPlotData:c,reset:function(){b=!1;a=null},plotLoaded:function(a){c().topColors=wpd.colorAnalyzer.getTopColors(a)}}}();wpd=wpd||{};
wpd.AutoDetector=function(){return function(){this.fgColor=[0,0,200];this.bgColor=[255,255,255];this.mask=null;this.gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};this.gridLineColor=[255,255,255];this.gridColorDistance=10;this.gridData=null;this.colorDetectionMode="fg";this.colorDistance=120;this.imageData=this.gridBinaryData=this.binaryData=this.algorithm=null;this.imageHeight=this.imageWidth=0;this.gridBackgroundMode=!0;this.reset=function(){this.gridData=this.imageData=this.binaryData=
this.mask=null;this.gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]}};this.generateBinaryDataFromMask=function(){var c,b="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(c=0;c<this.mask.length;c++){var a=this.mask[c];var d=this.imageData.data[4*a];var e=this.imageData.data[4*a+1];var f=this.imageData.data[4*a+2];var g=this.imageData.data[4*a+3];0===g&&(f=e=d=255);d=wpd.dist3d(d,e,f,b[0],b[1],b[2]);"fg"===this.colorDetectionMode?d<=this.colorDistance&&(this.binaryData[a]=!0):
d>=this.colorDistance&&(this.binaryData[a]=!0)}};this.generateBinaryDataUsingFullImage=function(){var c,b="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(c=0;c<this.imageData.data.length/4;c++){var a=this.imageData.data[4*c];var d=this.imageData.data[4*c+1];var e=this.imageData.data[4*c+2];var f=this.imageData.data[4*c+3];0===f&&(e=d=a=255);a=wpd.dist3d(a,d,e,b[0],b[1],b[2]);"fg"===this.colorDetectionMode?a<=this.colorDistance&&(this.binaryData[c]=!0):a>=this.colorDistance&&(this.binaryData[c]=
!0)}};this.generateBinaryData=function(){this.binaryData=[];null==this.imageData?this.imageWidth=this.imageHeight=0:(this.imageHeight=this.imageData.height,this.imageWidth=this.imageData.width,null==this.mask||0===this.mask.length?this.generateBinaryDataUsingFullImage():this.generateBinaryDataFromMask())};this.generateGridBinaryData=function(){this.gridBinaryData=[];if(null==this.imageData)this.imageHeight=this.imageWidth=0;else{this.imageWidth=this.imageData.width;this.imageHeight=this.imageData.height;
var c,b;if(null==this.gridMask.pixels||0===this.gridMask.pixels.length){var a=0;this.gridMask.pixels=[];for(b=0;b<this.imageHeight;b++)for(c=0;c<this.imageWidth;c++){var d=b*this.imageWidth+c;var e=this.imageData.data[4*d];var f=this.imageData.data[4*d+1];var g=this.imageData.data[4*d+2];var h=this.imageData.data[4*d+3];0===h&&(g=f=e=255);e=wpd.dist3d(this.gridLineColor[0],this.gridLineColor[1],this.gridLineColor[2],e,f,g);this.gridBackgroundMode?e>this.gridColorDistance&&(this.gridBinaryData[d]=
!0,this.gridMask.pixels[a]=d,a++):e<this.gridColorDistance&&(this.gridBinaryData[d]=!0,this.gridMask.pixels[a]=d,a++)}this.gridMask.xmin=0;this.gridMask.xmax=this.imageWidth;this.gridMask.ymin=0;this.gridMask.ymax=this.imageHeight}else for(a=0;a<this.gridMask.pixels.length;a++)d=this.gridMask.pixels[a],e=this.imageData.data[4*d],f=this.imageData.data[4*d+1],g=this.imageData.data[4*d+2],e=wpd.dist3d(this.gridLineColor[0],this.gridLineColor[1],this.gridLineColor[2],e,f,g),this.gridBackgroundMode?e>
this.gridColorDistance&&(this.gridBinaryData[d]=!0):e<this.gridColorDistance&&(this.gridBinaryData[d]=!0)}}}}();wpd=wpd||{};
wpd.Calibration=function(){return function(c){var b=[],a=[],d=null==c?2:c,e=[],f=[];this.labels=[];this.getCount=function(){return b.length};this.getDimensions=function(){return d};this.addPoint=function(c,f,k,l,m){var g=b.length,h=e.length;b[g]=c;a[g]=f;e[h]=k;e[h+1]=l;3===d&&(e[h+2]=m)};this.getPoint=function(c){return 0>c||c>=b.length?null:{px:b[c],py:a[c],dx:e[d*c],dy:e[d*c+1],dz:2===d?null:e[d*c+2]}};this.changePointPx=function(c,d,e){0>c||c>=b.length||(b[c]=d,a[c]=e)};this.setDataAt=function(a,
c,f,l){0>a||a>=b.length||(e[d*a]=c,e[d*a+1]=f,3===d&&(e[d*a+2]=l))};this.findNearestPoint=function(c,d,e){e=null==e?50:parseFloat(e);var f=-1,g;for(g=0;g<b.length;g++){var h=Math.sqrt((c-b[g])*(c-b[g])+(d-a[g])*(d-a[g]));if(0>f&&h<=e||0<=f&&h<k){f=g;var k=h}}return f};this.selectPoint=function(a){0>f.indexOf(a)&&(f[f.length]=a)};this.selectNearestPoint=function(a,b,c){a=this.findNearestPoint(a,b,c);0<=a&&this.selectPoint(a)};this.getSelectedPoints=function(){return f};this.unselectAll=function(){f=
[]};this.isPointSelected=function(a){return 0<=f.indexOf(a)};this.dump=function(){console.log(b);console.log(a);console.log(e)}}}();wpd=wpd||{};
wpd.ColorGroup=function(){return function(c){var b=0,a={r:0,g:0,b:0};c=null==c?100:c;this.getPixelCount=function(){return b};this.getAverageColor=function(){return a};this.isColorInGroup=function(d,e,f){return 0===b?!0:(a.r-d)*(a.r-d)+(a.g-e)*(a.g-e)+(a.b-f)*(a.b-f)<=c*c};this.addPixel=function(c,e,f){a.r=(a.r*b+c)/(b+1);a.g=(a.g*b+e)/(b+1);a.b=(a.b*b+f)/(b+1);b+=1}}}();
wpd.colorAnalyzer=function(){return{getTopColors:function(c){var b=[],a,d=[];b[0]=new wpd.ColorGroup(120);for(a=0;a<c.data.length;a+=4){var e=c.data[a];var f=c.data[a+1];var g=c.data[a+2];var h=c.data[a+3];0===h&&(g=f=e=255);var k=!1;for(h=0;h<b.length;h++)if(b[h].isColorInGroup(e,f,g)){b[h].addPixel(e,f,g);k=!0;break}k||(b[b.length]=new wpd.ColorGroup(120),b[b.length-1].addPixel(e,f,g))}b.sort(function(a,b){return a.getPixelCount()>b.getPixelCount()?-1:a.getPixelCount()<b.getPixelCount()?1:0});for(h=
0;h<b.length;h++)a=b[h].getAverageColor(),d[h]={r:parseInt(a.r,10),g:parseInt(a.g,10),b:parseInt(a.b,10),pixels:b[h].getPixelCount(),percentage:100*b[h].getPixelCount()/(.25*c.data.length)};return d}}}();wpd=wpd||{};
wpd.ConnectedPoints=function(){return function(c){var b=[],a=-1,d=-1;this.addConnection=function(a){b[b.length]=a};this.clearAll=function(){b=[]};this.getConnectionAt=function(a){if(a<b.length)return b[a]};this.replaceConnectionAt=function(a,c){a<b.length&&(b[a]=c)};this.deleteConnectionAt=function(a){a<b.length&&b.splice(a,1)};this.connectionCount=function(){return b.length};this.getDistance=function(a){if(a<b.length&&2===c)return Math.sqrt((b[a][0]-b[a][2])*(b[a][0]-b[a][2])+(b[a][1]-b[a][3])*(b[a][1]-
b[a][3]))};this.getAngle=function(a){if(a<b.length&&3===c){var d=wpd.taninverse(-(b[a][5]-b[a][3]),b[a][4]-b[a][2]);a=wpd.taninverse(-(b[a][1]-b[a][3]),b[a][0]-b[a][2]);d=180*(d-a)/Math.PI;return 0>d?d+360:d}};this.getOpenSpline=function(a){return null};this.getClosedSpline=function(a){return null};this.openPathLength=function(a){return 0};this.closedPathLength=function(a){return 0};this.closedPathArea=function(a){return 0};this.findNearestPointAndConnection=function(a,d){var f=-1,e=-1,k,l;for(k=
0;k<b.length;k++)for(l=0;l<2*c;l+=2){var m=(b[k][l]-a)*(b[k][l]-a)+(b[k][l+1]-d)*(b[k][l+1]-d);if(-1===e||m<n){f=k;e=l/2;var n=m}}return{connectionIndex:f,pointIndex:e}};this.selectNearestPoint=function(b,c){b=this.findNearestPointAndConnection(b,c);0<=b.connectionIndex&&(a=b.connectionIndex,d=b.pointIndex)};this.deleteNearestConnection=function(a,b){a=this.findNearestPointAndConnection(a,b);0<=a.connectionIndex&&this.deleteConnectionAt(a.connectionIndex)};this.isPointSelected=function(b,c){return d===
c&&a===b?!0:!1};this.getSelectedConnectionAndPoint=function(){return{connectionIndex:a,pointIndex:d}};this.unselectConnectionAndPoint=function(){d=a=-1};this.setPointAt=function(a,c,d,h){b[a][2*c]=d;b[a][2*c+1]=h};this.getPointAt=function(a,c){return{x:b[a][2*c],y:b[a][2*c+1]}}}}();wpd=wpd||{};
wpd.DataSeries=function(){return function(c){var b=[],a=[],d=!1,e=[];this.name="Default Dataset";this.variableNames=["x","y"];this.hasMetadata=function(){return d};this.setMetadataKeys=function(a){e=a};this.getMetadataKeys=function(){return e};this.addPixel=function(a,c,e){b[b.length]={x:a,y:c,metadata:e};null!=e&&(d=!0)};this.getPixel=function(a){return b[a]};this.setPixelAt=function(a,c,d){a<b.length&&(b[a].x=c,b[a].y=d)};this.setMetadataAt=function(a,c){a<b.length&&(b[a].metadata=c)};this.insertPixel=
function(a,c,d,e){b.splice(a,0,{x:c,y:d,metadata:e})};this.removePixelAtIndex=function(a){a<b.length&&b.splice(a,1)};this.removeLastPixel=function(){this.removePixelAtIndex(b.length-1)};this.findNearestPixel=function(a,c,d){d=null==d?50:parseFloat(d);var e=-1,f;for(f=0;f<b.length;f++){var g=Math.sqrt((a-b[f].x)*(a-b[f].x)+(c-b[f].y)*(c-b[f].y));if(0>e&&g<=d||0<=e&&g<h){e=f;var h=g}}return e};this.removeNearestPixel=function(a,b,c){a=this.findNearestPixel(a,b,c);0<=a&&this.removePixelAtIndex(a)};this.clearAll=
function(){b=[];d=!1;e=[]};this.getCount=function(){return b.length};this.selectPixel=function(b){0<=a.indexOf(b)||(a[a.length]=b)};this.unselectAll=function(){a=[]};this.selectNearestPixel=function(a,b,c){a=this.findNearestPixel(a,b,c);0<=a&&this.selectPixel(a);return a};this.selectNextPixel=function(){for(var c=0;c<a.length;c++)a[c]=(a[c]+1)%b.length};this.selectPreviousPixel=function(){var c;for(c=0;c<a.length;c++){var d=a[c];d=0===d?b.length-1:d-1;a[c]=d}};this.getSelectedPixels=function(){return a}}}();
wpd=wpd||{};
wpd.dateConverter=function(){function c(a){a=a.toString();var b=a.split("/");if(0>=b.length||3<b.length)return null;a=parseInt(b[0],10);var c=parseInt(void 0===b[1]?0:b[1],10);date=parseInt(void 0===b[2]?1:b[2],10);if(isNaN(a)||isNaN(c)||isNaN(date)||12<c||1>c||31<date||1>date)return null;b=new Date;b.setUTCFullYear(a);b.setUTCMonth(c-1);b.setUTCDate(date);a=parseFloat(Date.parse(b));return isNaN(a)?null:a}function b(a,b){b=b.replace("YYYY","yyyy");b=b.replace("YY","yy");b=b.replace("MMMM","mmmm");
b=b.replace("MMM","mmm");b=b.replace("MM","mm");b=b.replace("DD","dd");b=b.replace("yyyy",a.getUTCFullYear());var c=a.getUTCFullYear()%100;b=b.replace("yy",10>c?"0"+c:c);b=b.replace("mmmm","January February March April May June July August September October November December".split(" ")[a.getUTCMonth()]);b=b.replace("mmm","Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]);b=b.replace("mm",a.getUTCMonth()+1);return b=b.replace("dd",a.getUTCDate())}return{parse:function(a){return null==
a||"string"===typeof a&&0>a.indexOf("/")?null:c(a)},getFormatString:function(a){a=a.split("/");var b="yyyy/mm/dd";1<=a.length&&(b="yyyy");2<=a.length&&(b+="/mm");3===a.length&&(b+="/dd");return b},formatDate:b,formatDateNumber:function(a,c){a=parseFloat(a);a=parseInt(864E5*Math.round(a/864E5),10);return b(new Date(a),c)}}}();wpd=wpd||{};
wpd.gridDetectionCore=function(){var c,b,a=.1,d=.1;return{run:function(){var e=[],f,g,h=wpd.appData.getPlotData().getAutoDetector(),k=h.gridMask.xmin,l=h.gridMask.xmax,m=h.gridMask.ymin,n=h.gridMask.ymax,p=h.imageWidth;if(b)for(f=k;f<=l;f++){var r=0;for(g=m;g<n;g++)!0===h.gridBinaryData[g*p+f]&&r++;if(r>d*(n-m))for(g=m;g<n;g++)e[g*p+f]=!0}if(c)for(g=m;g<=n;g++){r=0;for(f=k;f<=l;f++)!0===h.gridBinaryData[g*p+f]&&r++;if(r>a*(l-k))for(f=k;f<=l;f++)e[g*p+f]=!0}wpd.appData.getPlotData().gridData=e},setHorizontalParameters:function(a,
b){c=a;d=Math.abs(parseFloat(b)/100)},setVerticalParameters:function(c,d){b=c;a=Math.abs(parseFloat(d)/100)}}}();wpd=wpd||{};
wpd.InputParser=function(){return function(){this.parse=function(c){this.isDate=this.isValid=!1;this.formatting=null;if(null==c||"string"===typeof c&&(c=c.trim(),0<=c.indexOf("^")))return null;var b=wpd.dateConverter.parse(c);if(null!=b)return this.isDate=this.isValid=!0,this.formatting=wpd.dateConverter.getFormatString(c),b;c=parseFloat(c);return isNaN(c)?null:(this.isValid=!0,c)};this.isDate=this.isValid=!1;this.formatting=null}}();wpd=wpd||{};
wpd.taninverse=function(c,b){var a;0<c?a=Math.atan2(c,b):0>=c&&(a=Math.atan2(c,b)+2*Math.PI);a>=2*Math.PI&&(a=0);return a};wpd.sqDist2d=function(c,b,a,d){return(c-a)*(c-a)+(b-d)*(b-d)};wpd.sqDist3d=function(c,b,a,d,e,f){return(c-d)*(c-d)+(b-e)*(b-e)+(a-f)*(a-f)};wpd.dist2d=function(c,b,a,d){return Math.sqrt(wpd.sqDist2d(c,b,a,d))};wpd.dist3d=function(c,b,a,d,e,f){return Math.sqrt(wpd.sqDist3d(c,b,a,d,e,f))};
wpd.mat=function(){function c(b){return b[0]*b[3]-b[1]*b[2]}return{det2x2:c,inv2x2:function(b){var a=c(b);return[b[3]/a,-b[1]/a,-b[2]/a,b[0]/a]},mult2x2:function(b,a){return[b[0]*a[0]+b[1]*a[2],b[0]*a[1]+b[1]*a[3],b[2]*a[0]+b[3]*a[2],b[2]*a[1]+b[3]*a[3]]},mult2x2Vec:function(b,a){return[b[0]*a[0]+b[1]*a[1],b[2]*a[0]+b[3]*a[1]]},multVec2x2:function(b,a){return[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1]]}}}();
wpd.cspline=function(c,b){var a=c.length;c={x:c,y:b,len:a,d:[]};var d=[],e=[],f;if(3>a)return null;e[0]=2;d[0]=3*(b[1]-b[0]);for(f=1;f<a-1;++f)e[f]=4-1/e[f-1],d[f]=3*(b[f+1]-b[f-1])-d[f-1]/e[f-1];e[a-1]=2-1/e[a-2];d[a-1]=3*(b[a-1]-b[a-2])-d[a-2]/e[a-1];f=a-1;for(c.d[f]=d[f]/e[f];0<f;)--f,c.d[f]=(d[f]-c.d[f+1])/e[f];return c};
wpd.cspline_interp=function(c,b){var a=0;if(b>=c.x[c.len-1]||b<c.x[0])return null;for(;b>c.x[a];)a++;a=0<a?a-1:0;b=(b-c.x[a])/(c.x[a+1]-c.x[a]);return c.y[a]+c.d[a]*b+(3*(c.y[a+1]-c.y[a])-2*c.d[a]-c.d[a+1])*b*b+(2*(c.y[a]-c.y[a+1])+c.d[a]+c.d[a+1])*b*b*b};wpd=wpd||{};
wpd.PlotData=function(){return function(){var c=0,b=new wpd.AutoDetector;this.axes=this.topColors=null;this.dataSeriesColl=[];this.backupImageData=this.closedPathMeasurementData=this.openPathMeasurementData=this.distanceMeasurementData=this.angleMeasurementData=this.calibration=this.gridData=null;this.getActiveDataSeries=function(){null==this.dataSeriesColl[c]&&(this.dataSeriesColl[c]=new wpd.DataSeries);return this.dataSeriesColl[c]};this.getDataSeriesCount=function(){return this.dataSeriesColl.length};
this.setActiveDataSeriesIndex=function(a){c=a};this.getActiveDataSeriesIndex=function(){return c};this.getAutoDetector=function(){return b};this.getDataSeriesNames=function(){for(var a=[],b=0;b<this.dataSeriesColl.length;b++)a[b]=this.dataSeriesColl[b].name;return a};this.reset=function(){this.closedPathMeasurementData=this.openPathMeasurementData=this.distanceMeasurementData=this.angleMeasurementData=this.axes=null;this.dataSeriesColl=[];this.backupImageData=this.calibration=this.gridData=null;c=
0;b=new wpd.AutoDetector}}}();wpd=wpd||{};
wpd.AveragingWindowCore=function(){return function(c,b,a,d,e,f){this.run=function(){var g=[],h=0,k=[],l,m,n,p;f.clearAll();for(l=0;l<a;l++){var r=-1;var t=-2*e;for(m=n=0;m<b;m++)!0===c[m*a+l]&&(m>t+e?(r+=1,n=1,t=k[r]=m):(n+=1,k[r]=parseFloat((k[r]*(n-1)+m)/parseFloat(n))));if(0<=r)for(t=l+.5,m=0;m<=r;m++)n=k[m]+.5,g[h]=[],g[h][0]=parseFloat(t),g[h][1]=parseFloat(n),g[h][2]=!0,h+=1}if(0!==h){for(k=0;k<h;k++)if(!0===g[k][2]){l=!0;r=k+1;m=g[k][0];t=g[k][1];n=m;var u=t;for(p=1;!0===l&&r<h;){var v=g[r][0];
var q=g[r][1];Math.abs(v-m)<=d&&Math.abs(q-t)<=e&&!0===g[r][2]&&(n=(n*p+v)/(p+1),u=(u*p+q)/(p+1),p+=1,g[r][2]=!1);v>m+2*d&&(l=!1);r+=1}g[k][2]=!1;f.addPixel(parseFloat(n),parseFloat(u))}return f}}}}();wpd=wpd||{};
wpd.AveragingWindowAlgo=function(){return function(){var c=5,b=5;this.getParamList=function(){return[["\u0394X","Px",10],["\u0394Y","Px",10]]};this.setParam=function(a,d){0===a?c=d:1===a&&(b=d)};this.run=function(a){var d=a.getAutoDetector();a=a.getActiveDataSeries();(new wpd.AveragingWindowCore(d.binaryData,d.imageHeight,d.imageWidth,c,b,a)).run()}}}();wpd=wpd||{};
wpd.AveragingWindowWithStepSizeAlgo=function(){return function(){var c,b,a,d,e,f;this.getParamList=function(){var a=wpd.appData.isAligned(),b=wpd.appData.getPlotData().axes;return a&&b instanceof wpd.XYAxes?(a=b.getBounds(),[["X_min","Units",a.x1],["\u0394X Step","Units",.1],["X_max","Units",a.x2],["Y_min","Units",a.y3],["Y_max","Units",a.y4],["Line width","Px",30]]):[["X_min","Units",0],["\u0394X Step","Units",.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Line width","Px",30]]};
this.setParam=function(g,h){0===g?c=h:1===g?b=h:2===g?a=h:3===g?e=h:4===g?f=h:5===g&&(d=h)};this.run=function(g){var h=g.getAutoDetector(),k=g.getActiveDataSeries();g=g.axes;var l=h.imageWidth,m=h.imageHeight,n,p;k.clearAll();for(n=c;n<=a;n+=b){var r=g.dataToPixel(n,e);var t=r.x;var u=r.y;r=g.dataToPixel(n,f);var v=r.x;var q=r.y;t=Math.sqrt((q-u)*(q-u)+(v-t)*(v-t));v=(f-e)/t;u=!1;var w=q=0;var z=!1;for(p=0;p<=t;p++)r=1*-p*v+f,r=g.dataToPixel(n,r),xi_pix=r.x,yi_pix=r.y,0<=xi_pix&&xi_pix<l&&0<=yi_pix&&
yi_pix<m&&(!0===h.binaryData[parseInt(yi_pix,10)*l+parseInt(xi_pix,10)]?(!1===u&&(w=q=p,u=!0,z=!1),!0===z&&(w=p,z=!1)):!1===z&&(w=p,z=!0),!0===u&&(p>q+d||p==t-1)&&(u=!1,q>w&&(w=p),r=(q+w)/2,r=1*-r*v+f,r=g.dataToPixel(n,r),k.addPixel(parseFloat(r.x),parseFloat(r.y))))}}}}();wpd=wpd||{};
wpd.BarValue=function(){this.avgX=this.avgValBot=this.avgValTop=this.npoints=0;this.append=function(c,b,a){this.avgX=(this.npoints*this.avgX+c)/(this.npoints+1);this.avgValTop=(this.npoints*this.avgValTop+b)/(this.npoints+1);this.avgValBot=(this.npoints*this.avgValBot+a)/(this.npoints+1);this.npoints++};this.isPointInGroup=function(c,b,a,d,e){return 0===this.npoints||Math.abs(this.avgX-c)<=d&&Math.abs(this.avgValTop-b)<=e&&Math.abs(this.avgValBot-a)<=e?!0:!1}};
wpd.BarExtractionAlgo=function(){var c,b;this.getParamList=function(){return"Y"===wpd.appData.getPlotData().axes.getOrientation().axes?[["\u0394X","Px",30],["\u0394Val","Px",10]]:[["\u0394Y","Px",30],["\u0394Val","Px",10]]};this.setParam=function(a,d){0===a?c=parseFloat(d):1===a&&(b=parseFloat(d))};this.run=function(a){var d=a.getAutoDetector(),e=a.getActiveDataSeries(),f=a.axes.getOrientation(),g=[],h,k,l,m=d.imageWidth,n=d.imageHeight,p,r,t=function(a,d,e){p=!1;for(r=0;r<g.length;r++)if(q=g[r],
q.isPointInGroup(a,d,e,c,b)){q.append(a,d,e);p=!0;break}p||(q=new wpd.BarValue,q.append(a,d,e),g.push(q))};e.clearAll();if("Y"===f.axes)for(k=0;k<m;k++){var u=0;var v=n-1;for(l=h=0;l<n;l++)if(d.binaryData[l*m+k]){u=l;h++;break}for(l=n-1;0<=l;l--)if(d.binaryData[l*m+k]){v=l;h++;break}2===h&&t(k,u,v)}else for(l=0;l<n;l++){u=m-1;h=v=0;for(k=m-1;0<=k;k--)if(d.binaryData[l*m+k]){u=k;h++;break}for(k=0;k<m;k++)if(d.binaryData[l*m+k]){v=k;h++;break}2===h&&t(l,u,v)}a.axes.dataPointsHaveLabels&&(d=e.getMetadataKeys(),
null!=d&&"Label"===d[0]||e.setMetadataKeys(["Label"]));for(r=0;r<g.length;r++){var q=g[r];"Y"===f.axes?(u=a.axes.pixelToData(q.avgX,q.avgValTop)[0],v=a.axes.pixelToData(q.avgX,q.avgValBot)[0]):(u=a.axes.pixelToData(q.avgValTop,q.avgX)[0],v=a.axes.pixelToData(q.avgValBot,q.avgX)[0]);d=0>u+v?"increasing"===f.direction?q.avgValBot:q.avgValTop:"increasing"===f.direction?q.avgValTop:q.avgValBot;a.axes.dataPointsHaveLabels?"Y"===f.axes?e.addPixel(q.avgX+.5,d+.5,["Bar"+r]):e.addPixel(d+.5,q.avgX+.5,["Bar"+
r]):"Y"===f.axes?e.addPixel(q.avgX+.5,d+.5):e.addPixel(d+.5,q.avgX+.5)}}};wpd=wpd||{};
wpd.BlobDetectorAlgo=function(){return function(){var c,b;this.getParamList=function(){var a=wpd.appData.isAligned(),b=wpd.appData.getPlotData().axes;return a&&b instanceof wpd.MapAxes?[["Min Diameter","Units",0],["Max Diameter","Units",5E3]]:[["Min Diameter","Px",0],["Max Diameter","Px",5E3]]};this.setParam=function(a,d){0===a?c=parseFloat(d):1===a&&(b=parseFloat(d))};this.run=function(a){var d=a.getAutoDetector(),e=a.getActiveDataSeries(),f=d.imageWidth,g=d.imageHeight,h=[],k=[],l,m,n,p,r;if(!(0>=
f||0>=g||null==d.binaryData||0===d.binaryData.length)){e.clearAll();e.setMetadataKeys(["area","moment"]);for(l=0;l<f;l++)for(m=0;m<g;m++)if(!0===d.binaryData[m*f+l]&&!0!==h[m*f+l]){h[m*f+l]=!0;var t=k.length;k[t]={pixels:[{x:l,y:m}],centroid:{x:l,y:m},area:1,moment:0};for(n=0;n<k[t].pixels.length;){var u=k[t].pixels[n].x;var v=k[t].pixels[n].y;for(p=u-1;p<=u+1;p++)for(r=v-1;r<=v+1;r++)if(0<=p&&0<=r&&p<f&&r<g&&!0!==h[r*f+p]&&!0===d.binaryData[r*f+p]){h[r*f+p]=!0;var q=k[t].pixels.length;k[t].pixels[q]=
{x:p,y:r};k[t].centroid.x=(k[t].centroid.x*q+p)/(q+1);k[t].centroid.y=(k[t].centroid.y*q+r)/(q+1);k[t].area+=1}n+=1}}for(t=0;t<k.length;t++){for(n=k[t].moment=0;n<k[t].pixels.length;n++)k[t].moment=k[t].moment+(k[t].pixels[n].x-k[t].centroid.x)*(k[t].pixels[n].x-k[t].centroid.x)+(k[t].pixels[n].y-k[t].centroid.y)*(k[t].pixels[n].y-k[t].centroid.y);a.axes instanceof wpd.MapAxes&&(k[t].area=a.axes.pixelToDataArea(k[t].area));d=2*Math.sqrt(k[t].area/Math.PI);d<=b&&d>=c&&e.addPixel(k[t].centroid.x+.5,
k[t].centroid.y+.5,[k[t].area,k[t].moment])}}}}}();wpd=wpd||{};
wpd.XStepWithInterpolationAlgo=function(){return function(){var c,b,a,d,e,f;this.getParamList=function(){var a=wpd.appData.isAligned(),b=wpd.appData.getPlotData().axes;return a&&b instanceof wpd.XYAxes?(a=b.getBounds(),[["X_min","Units",a.x1],["\u0394X Step","Units",(a.x2-a.x1)/50],["X_max","Units",a.x2],["Y_min","Units",a.y3],["Y_max","Units",a.y4],["Smoothing","% of \u0394X",0]]):[["X_min","Units",0],["\u0394X Step","Units",.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Smoothing",
"% of \u0394X",0]]};this.setParam=function(g,h){0===g?c=h:1===g?b=h:2===g?a=h:3===g?e=h:4===g?f=h:5===g&&(d=h)};this.run=function(g){var h=g.getAutoDetector(),k=g.getActiveDataSeries();g=g.axes;var l=0,m=h.imageWidth,n=h.imageHeight,p,r,t=[],u=[],v=Math.abs(d/100*b);k.clearAll();var q=g.dataToPixel(c,e);var w=g.dataToPixel(c,f);var z=(f-e)/Math.sqrt((q.x-w.x)*(q.x-w.x)+(q.y-w.y)*(q.y-w.y));w=g.dataToPixel(a,e);w=(a-c)/Math.sqrt((q.x-w.x)*(q.x-w.x)+(q.y-w.y)*(q.y-w.y));0<Math.abs(v/w)&&1>Math.abs(v/
w)&&(v=w);for(q=c;0<w&&q<=a||0>w&&q>=a;){var A=r=0;for(p=e;0<z&&p<=f||0>z&&p>=f;){var x=g.dataToPixel(q,p);0<x.x&&0<x.y&&x.x<m&&x.y<n&&!0===h.binaryData[parseInt(x.y,10)*m+parseInt(x.x,10)]&&(r=(r*A+p)/parseFloat(A+1),A++);p+=z}0<A&&(t[l]=parseFloat(q),u[l]=parseFloat(r),l+=1);q+=w}if(!(0>=t.length||0>=u.length)){if(0<v)for(x=[],l=[],q=t[0];0<w&&q<=t[t.length-1]||0>w&&q>=t[t.length-1];){for(h=A=n=m=0;h<t.length;h++)t[h]<=q+v&&t[h]>=q-v&&(m=(m*A+t[h])/parseFloat(A+1),n=(n*A+u[h])/parseFloat(A+1),A++);
0<A&&(x[x.length]=m,l[l.length]=n);q=0<w?q+v:q-v}else x=t,l=u;if(!(0>=x.length||0>=l.length||(t=[],h=0,q=c,0>w&&0<b||0<w&&0>b))){for(;0<w&&q<=a||0>w&&q>=a;)t[h]=q,h++,q+=b;0>w&&(x=x.reverse(),l=l.reverse());v=wpd.cspline(x,l);if(null!=v)for(u=[],h=0;h<t.length;++h)isNaN(t[h])||(u[h]=wpd.cspline_interp(v,t[h]),null!==u[h]&&(x=g.dataToPixel(t[h],u[h]),k.addPixel(x.x,x.y)))}}}}}();wpd=wpd||{};
wpd.BarAxes=function(){var c=function(){var b=!1,a=!1,c,e,f,g,h,k,l;this.isCalibrated=function(){return b};this.calibrate=function(d,n,p){b=!1;var m=d.getPoint(0);d=d.getPoint(1);c=m.px;e=m.py;f=d.px;g=d.py;h=parseFloat(m.dy);k=parseFloat(d.dy);n?(a=!0,h=Math.log(h)/Math.log(10),k=Math.log(k)/Math.log(10)):a=!1;l=this.calculateOrientation();p||("Y"==l.axes?f=c:g=e,l=this.calculateOrientation());return b=!0};this.pixelToData=function(b,d){var l=[];l[0]=((d-e)*(g-e)+(f-c)*(b-c))/((g-e)*(g-e)+(f-c)*
(f-c))*(k-h)+h;a&&(l[0]=Math.pow(10,l[0]));return l};this.dataToPixel=function(a,b){return{x:0,y:0}};this.pixelToLiveString=function(a,b){return this.pixelToData(a,b)[0].toExponential(4)};this.isLog=function(){return a};this.getTransformationEquations=function(){return{pixelToData:["This will be available in a future release."]}};this.dataPointsHaveLabels=!0;this.dataPointsLabelPrefix="Bar";this.calculateOrientation=function(){var a=180*wpd.taninverse(-(g-e),f-c)/Math.PI,b={axes:"Y",direction:"increasing",
angle:a};30>Math.abs(a-90)?(b.axes="Y",b.direction="increasing"):30>Math.abs(a-270)?(b.axes="Y",b.direction="decreasing"):30>Math.abs(a-0)||30>Math.abs(a-360)?(b.axes="X",b.direction="increasing"):30>Math.abs(a-180)&&(b.axes="X",b.direction="decreasing");return b};this.getOrientation=function(){return l};this.name="Bar"};c.prototype.numCalibrationPointsRequired=function(){return 2};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["Label","Y"]};return c}();
wpd=wpd||{};
wpd.ImageAxes=function(){var c=function(){this.isCalibrated=function(){return!0};this.calibrate=function(){return!0};this.pixelToData=function(b,a){return[b,a]};this.dataToPixel=function(b,a){return{x:b,y:a}};this.pixelToLiveString=function(b,a){b=this.pixelToData(b,a);return b[0].toFixed(2)+", "+b[1].toFixed(2)};this.getTransformationEquations=function(){return{pixelToData:["x_data = x_pixel","y_data = y_pixel"],dataToPixel:["x_pixel = x_data","y_pixel = y_data"]}};this.name="Image"};c.prototype.numCalibrationPointsRequired=
function(){return 0};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X","Y"]};return c}();wpd=wpd||{};
wpd.MapAxes=function(){var c=function(){var b=!1,a,c,e;this.isCalibrated=function(){return b};this.calibrate=function(d,g,h){var f=d.getPoint(0);d=d.getPoint(1);e=Math.sqrt((f.px-d.px)*(f.px-d.px)+(f.py-d.py)*(f.py-d.py));a=parseFloat(g);c=h;return b=!0};this.pixelToData=function(b,c){var d=[];d[0]=b*a/e;d[1]=c*a/e;return d};this.pixelToDataDistance=function(b){return b*a/e};this.pixelToDataArea=function(b){return b*a*a/(e*e)};this.dataToPixel=function(a,b,c){return{x:0,y:0}};this.pixelToLiveString=
function(a,b){a=this.pixelToData(a,b);return a[0].toExponential(4)+", "+a[1].toExponential(4)};this.getScaleLength=function(){return a};this.getUnits=function(){return c};this.getTransformationEquations=function(){return{pixelToData:["x_data = "+a/e+"*x_pixel","y_data = "+a/e+"*y_pixel"],dataToPixel:["x_pixel = "+e/a+"*x_data","y_pixel = "+e/a+"*y_data"]}};this.name="Map"};c.prototype.numCalibrationPointsRequired=function(){return 2};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=
function(){return["X","Y"]};return c}();wpd=wpd||{};
wpd.PolarAxes=function(){var c=function(){var b=!1,a=!1,c=!1,e=!1,f,g,h,k,l,m,n,p,r,t,u,v,q,w;processCalibration=function(b,d,x,B){var A=b.getPoint(0),I=b.getPoint(1);b=b.getPoint(2);f=A.px;g=A.py;h=I.px;k=I.py;l=b.px;m=b.py;n=I.dx;p=I.dy;r=b.dx;a=d;c=x;!0===a&&(p*=Math.PI/180);B&&(e=!0,n=Math.log(n)/Math.log(10),r=Math.log(r)/Math.log(10));t=Math.sqrt((h-f)*(h-f)+(k-g)*(k-g));u=Math.sqrt((l-f)*(l-f)+(m-g)*(m-g));v=u-t;q=wpd.taninverse(-(k-g),h-f);w=c?q+p:q-p;return!0};this.isCalibrated=function(){return b};
this.calibrate=function(a,c,d,e){return b=processCalibration(a,c,d,e)};this.isThetaDegrees=function(){return a};this.isThetaClockwise=function(){return c};this.pixelToData=function(b,d){var h=[];xp=parseFloat(b);yp=parseFloat(d);b=(r-n)/v*(Math.sqrt((xp-f)*(xp-f)+(yp-g)*(yp-g))-t)+n;d=c?w-wpd.taninverse(-(yp-g),xp-f):wpd.taninverse(-(yp-g),xp-f)-w;0>d&&(d+=2*Math.PI);!0===a&&(d=180*d/Math.PI);e&&(b=Math.pow(10,b));h[0]=b;h[1]=d;return h};this.dataToPixel=function(a,b){return{x:0,y:0}};this.pixelToLiveString=
function(a,b){a=this.pixelToData(a,b);return a[0].toExponential(4)+", "+a[1].toExponential(4)};this.getTransformationEquations=function(){var b="r = ("+(r-n)/v+")*sqrt((x_pixel - "+f+")^2 + (y_pixel - "+g+")^2) + ("+(n-t*(r-n)/v)+")";var d=c?w-NaN+g+" - y_pixel), (x_pixel - "+f+"))":"atan2(("+g+" - y_pixel), (x_pixel - "+f+")) - ("+w+")";d=a?"theta = (180/PI)*("+d+"), theta = theta + 360 if theta < 0":"theta = "+d+" theta = theta + 2*PI if theta < 0";return{pixelToData:[b,d]}};this.name="Polar"};
c.prototype.numCalibrationPointsRequired=function(){return 3};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["r","\u03b8"]};return c}();wpd=wpd||{};
wpd.TernaryAxes=function(){var c=function(){var b=!1,a,c,e,f,g,h,k,l,m;this.isCalibrated=function(){return b};this.calibrate=function(d,p,r){var n=d.getPoint(0),u=d.getPoint(1);d.getPoint(2);a=n.px;c=n.py;e=u.px;f=u.py;g=Math.sqrt((a-e)*(a-e)+(c-f)*(c-f));h=wpd.taninverse(-(f-c),e-a);k=Math.sqrt(3);l=p;m=r;return b=!0};this.isRange100=function(){return l};this.isNormalOrientation=function(){return m};this.pixelToData=function(b,d){var e=[];xp=parseFloat(b);yp=parseFloat(d);b=Math.sqrt((xp-a)*(xp-
a)+(yp-c)*(yp-c));var f=wpd.taninverse(-(yp-c),xp-a)-h;d=b*Math.cos(f)/g;f=b*Math.sin(f)/g;b=1-d-f/k;d-=f/k;f=2*f/k;if(0==m){var n=d;d=b;b=f;f=n}1==l&&(b*=100,d*=100,f*=100);e[0]=b;e[1]=d;e[2]=f;return e};this.dataToPixel=function(a,b,c){return{x:0,y:0}};this.pixelToLiveString=function(a,b){a=this.pixelToData(a,b);return a[0].toExponential(4)+", "+a[1].toExponential(4)+", "+a[2].toExponential(4)};this.getTransformationEquations=function(){var b="rp = sqrt((x_pixel - "+a+")^2 + (y_pixel - "+c+")^2)/("+
g+")",d="thetap = atan2(("+c+" -  y_pixel), (x_pixel - "+a+")) - ("+Math.atan2(-(f-c),e-a)+")",h="1 - rp*(cos(thetap) - sin(thetap)/sqrt(3))",k="rp*(cos(thetap) - sin(thetap)/sqrt(3))",u="2*rp*sin(thetap)/sqrt(3)";l&&(h="100*("+h+")",k="100*("+k+")",u="100*("+u+")");h="a_data = "+h;k="b_data = "+k;u="c_data = "+u;if(!m){var v=k;k=h;h=u;u=v}return{pixelToData:[b,d,h,k,u]}};this.name="Ternary"};c.prototype.numCalibrationPointsRequired=function(){return 3};c.prototype.getDimensions=function(){return 3};
c.prototype.getAxesLabels=function(){return["a","b","c"]};return c}();wpd=wpd||{};
wpd.XYAxes=function(){var c=function(){var b=!1,a=!1,c=!1,e=!1,f=!1,g,h,k,l,m,n,p,r,t,u,v,q,w,z,A=[0,0,0,0],x=[0,0,0,0],B=[0,0],J=function(b,d,G){if(4>b.getCount())return!1;var I=b.getPoint(0),H=b.getPoint(1),J=b.getPoint(2);b=b.getPoint(3);var F=new wpd.InputParser;k=I.px;p=I.py;l=H.px;r=H.py;m=J.px;t=J.py;n=b.px;u=b.py;v=I.dx;q=H.dx;w=J.dy;z=b.dy;v=F.parse(v);if(!F.isValid)return!1;e=F.isDate;q=F.parse(q);if(!F.isValid||F.isDate!=e)return!1;g=F.formatting;w=F.parse(w);if(!F.isValid)return!1;f=F.isDate;
z=F.parse(z);if(!F.isValid||F.isDate!=f)return!1;h=F.formatting;a=d;c=G;!0===a&&(v=Math.log(v)/Math.log(10),q=Math.log(q)/Math.log(10));!0===c&&(w=Math.log(w)/Math.log(10),z=Math.log(z)/Math.log(10));A=wpd.mat.mult2x2([v-q,0,0,w-z],wpd.mat.inv2x2([k-l,m-n,p-r,t-u]));x=wpd.mat.inv2x2(A);B[0]=v-A[0]*k-A[1]*p;B[1]=w-A[2]*m-A[3]*t;return!0};this.getBounds=function(){return{x1:a?Math.pow(10,v):v,x2:a?Math.pow(10,q):q,y3:c?Math.pow(10,w):w,y4:c?Math.pow(10,z):z}};this.isCalibrated=function(){return b};
this.calibrate=function(a,c,d){return b=J(a,c,d)};this.pixelToData=function(b,d){var e=[];b=parseFloat(b);d=parseFloat(d);b=wpd.mat.mult2x2Vec(A,[b,d]);b[0]+=B[0];b[1]+=B[1];d=b[0];b=b[1];!0===a&&(d=Math.pow(10,d));!0===c&&(b=Math.pow(10,b));e[0]=d;e[1]=b;return e};this.dataToPixel=function(b,d){a&&(b=Math.log(b)/Math.log(10));c&&(d=Math.log(d)/Math.log(10));b=wpd.mat.mult2x2Vec(x,[b-B[0],d-B[1]]);return{x:b[0],y:b[1]}};this.pixelToLiveString=function(a,b){var c="";a=this.pixelToData(a,b);c=e?c+wpd.dateConverter.formatDateNumber(a[0],
g):c+a[0].toExponential(4);c+=", ";return c=f?c+wpd.dateConverter.formatDateNumber(a[1],h):c+a[1].toExponential(4)};this.isDate=function(a){return 0===a?e:f};this.getInitialDateFormat=function(a){return 0===a?g:h};this.isLogX=function(){return a};this.isLogY=function(){return c};this.getTransformationEquations=function(){var b="("+A[0]+")*x_pixel + ("+A[1]+")*y_pixel + ("+B[0]+")",d="("+A[2]+")*x_pixel + ("+A[3]+")*y_pixel + ("+B[1]+")",e="x_pixel = ("+x[0]+")*x_data + ("+x[1]+")*y_data + ("+(-x[0]*
B[0]-x[1]*B[1])+")",f="y_pixel = ("+x[2]+")*x_data + ("+x[3]+")*y_data + ("+(-x[2]*B[0]-x[3]*B[1])+")",b=a?"x_data = pow(10, "+b+")":"x_data = "+b,d=c?"y_data = pow(10, "+d+")":"y_data = "+d;return a||c?{pixelToData:[b,d]}:{pixelToData:[b,d],dataToPixel:[e,f]}};this.getOrientation=function(){return{axes:"Y",direction:"increasing",angle:90}};this.name="XY"};c.prototype.numCalibrationPointsRequired=function(){return 4};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X",
"Y"]};return c}();wpd=wpd||{};
wpd.dataSeriesManagement=function(){function c(){if(wpd.appData.isAligned()){var a=document.getElementById("manage-data-series-name"),b=document.getElementById("manage-data-series-point-count"),c=document.getElementById("manage-data-series-list"),d=wpd.appData.getPlotData(),k=d.getActiveDataSeries(),l=d.getDataSeriesNames(),d=d.getActiveDataSeriesIndex(),m="";a.value=k.name;b.innerHTML=k.getCount();for(a=0;a<l.length;a++)m+='<option value="'+a+'">'+l[a]+"</option>";c.innerHTML=m;c.selectedIndex=d;
wpd.popup.show("manage-data-series-window")}else wpd.messagePopup.show(wpd.gettext("manage-datasets"),wpd.gettext("manage-datasets-text"))}function b(){wpd.graphicsWidget.forceHandlerRepaint();wpd.autoExtraction.updateDatasetControl();wpd.acquireData.updateDatasetControl();wpd.dataPointCounter.setCount()}function a(){wpd.popup.close("manage-data-series-window")}var d=1;return{manage:c,addSeries:function(){var e=wpd.appData.getPlotData(),f="Dataset "+d,g=e.dataSeriesColl.length;a();e.dataSeriesColl[g]=
new wpd.DataSeries;e.dataSeriesColl[g].name=f;e.setActiveDataSeriesIndex(g);b();d++;c()},deleteSeries:function(){a();1===wpd.appData.getPlotData().dataSeriesColl.length?wpd.messagePopup.show(wpd.gettext("can-not-delete-dataset"),wpd.gettext("can-not-delete-dataset-text"),c):wpd.okCancelPopup.show(wpd.gettext("delete-dataset"),wpd.gettext("delete-dataset-text"),function(){var a=wpd.appData.getPlotData(),b=a.getActiveDataSeriesIndex();a.dataSeriesColl.splice(b,1);a.setActiveDataSeriesIndex(0);c()},
function(){c()})},viewData:function(){a();wpd.dataTable.showTable()},changeSelectedSeries:function(){var d=document.getElementById("manage-data-series-list"),f=wpd.appData.getPlotData();a();f.setActiveDataSeriesIndex(d.selectedIndex);b();c()},editSeriesName:function(){var d=wpd.appData.getPlotData().getActiveDataSeries(),f=document.getElementById("manage-data-series-name");a();d.name=f.value;b();c()}}}();wpd=wpd||{};
wpd.dataTable=function(){function c(){wpd.graphicsWidget.removeTool();wpd.popup.show("csvWindow");b()}function b(){g=f.getData();document.getElementById("data-table-dataset-control");var b=document.getElementById("data-table-dataset-list"),c=f.getDatasetNames(),h=document.getElementById("data-sort-variables"),k=document.getElementById("dataVariables"),r=document.getElementById("data-date-formatting-container"),t=document.getElementById("data-date-formatting"),u,v="",q="",w="",z=!1;for(u=0;u<c.length;u++)v+=
"<option>"+c[u]+"</option>";b.innerHTML=v;b.selectedIndex=f.getDatasetIndex();k.innerHTML=g.fields.join(", ");r.style.display="none";q+='<option value="raw">'+wpd.gettext("raw")+"</option>";for(u=0;u<g.fields.length;u++)g.isFieldSortable[u]&&(q+='<option value="'+g.fields[u]+'">'+g.fields[u]+"</option>"),null!=g.fieldDateFormat[u]&&(w+="<p>"+g.fields[u]+' <input type="text" length="15" value="'+g.fieldDateFormat[u]+'" id="data-format-string-'+u+'"/></p>',z=!0);g.allowConnectivity&&(q+='<option value="NearestNeighbor">'+
wpd.gettext("nearest-neighbor")+"</option>");h.innerHTML=q;a();z?(r.style.display="inline-block",t.innerHTML=w):r.style.display="hidden";d();e()}function a(){var a=document.getElementById("data-sort-variables").value,b=document.getElementById("data-sort-order");"NearestNeighbor"===a||"raw"===a?b.setAttribute("disabled",!0):b.removeAttribute("disabled")}function d(){if(null!=g&&null!=g.rawData){h=g.rawData.slice(0);var a=document.getElementById("data-sort-variables").value,b="ascending"===document.getElementById("data-sort-order").value,
c="NearestNeighbor"===a;if("raw"!==a)if(!c){var d=g.fields.indexOf(a);0>d||h.sort(function(a,c){return a[d]>c[d]?b?1:-1:a[d]<c[d]?b?-1:1:0})}else if(c)for(var e,f,k,v=h.length,q=g.connectivityFieldIndices,w,z,c=0;c<v-1;c++){a=-1;for(k=c+1;k<v;k++){for(w=f=0;w<q.length;w++)z=q[w],f+=(h[c][z]-h[k][z])*(h[c][z]-h[k][z]);if(f<e||-1===a)e=f,a=k}for(w=0;w<g.fields.length;w++)f=h[a][w],h[a][w]=h[c+1][w],h[c+1][w]=f}}}function e(){if(null!=h){var a=document.getElementById("digitizedDataTable"),b=parseInt(document.getElementById("data-number-format-digits").value,
10),c=document.getElementById("data-number-format-style").value,d=document.getElementById("data-number-format-separator").value,e,f,u=[],d=d.replace(/[^\\]\\t/,"\t").replace(/^\\t/,"\t");k="";for(e=0;e<h.length;e++){var v=[];for(f=0;f<g.fields.length;f++)null!=g.fieldDateFormat[f]?(void 0===u[f]&&(u[f]=document.getElementById("data-format-string-"+f).value),v[f]=wpd.dateConverter.formatDateNumber(h[e][f],u[f])):v[f]="string"===typeof h[e][f]?h[e][f]:"fixed"===c&&0<=b?h[e][f].toFixed(b):"precision"===
c&&0<=b?h[e][f].toPrecision(b):"exponential"===c&&0<=b?h[e][f].toExponential(b):h[e][f];k+=v.join(d);k+="\n"}a.value=k}}var f,g,h,k;return{showTable:function(){f=wpd.plotDataProvider;c()},showAngleData:function(){f=wpd.measurementDataProvider;f.setDataSource("angle");c()},showDistanceData:function(){f=wpd.measurementDataProvider;f.setDataSource("distance");c()},updateSortingControls:a,reSort:function(){a();d();e()},selectAll:function(){var a=document.getElementById("digitizedDataTable");a.focus();
a.select()},generateCSV:function(){var a=f.getDatasetNames()[f.getDatasetIndex()];wpd.download.csv(k,a)},exportToPlotly:function(){if(null!=h){var a={data:[]},b,c;a.data[0]={};for(b=0;b<h.length;b++)for(c=0;c<g.fields.length;c++){var d=g.fields[c];0===c?d="x":1===c&&(d="y");0===b&&(a.data[0][d]=[]);a.data[0][d][b]=null!=g.fieldDateFormat[c]?wpd.dateConverter.formatDateNumber(h[b][c],"yyyy-mm-dd"):h[b][c]}wpd.plotly.send(a)}},changeDataset:function(){var a=document.getElementById("data-table-dataset-list");
f.setDatasetIndex(a.selectedIndex);b()}}}();wpd=wpd||{};
wpd.graphicsWidget=function(){function c(a){var b=B.getBoundingClientRect();return{x:parseInt(a.pageX-(b.left+window.pageXOffset),10),y:parseInt(a.pageY-(b.top+window.pageYOffset),10)}}function b(a,b){return{x:a/K,y:b/K}}function a(a,b){a=parseInt(a,10);b=parseInt(b,10);V.style.width=a+"px";V.style.height=b+"px";B.width=a;J.width=a;I.width=a;H.width=a;G.width=a;B.height=b;J.height=b;I.height=b;H.height=b;G.height=b;Y=a/(1*b);M=a;N=b;if(null!=Q){F.fillStyle="rgb(255, 255, 255)";F.fillRect(0,0,M,N);
F.drawImage(P,0,0,M,N);if(null!=C&&void 0!=C.onRedraw)C.onRedraw();if(null!=y&&void 0!=y.onRedraw)y.onRedraw()}}function d(){J.width=J.width;I.width=I.width;H.width=H.width;G.width=G.width;L.width=L.width}function e(){if(null!=C&&void 0!=C.onRemove)C.onRemove();C=null}function f(){var b=wpd.layoutManager.getGraphicsViewportSize();a(b.width,b.height);Y>S?(K=N/(1*D),a(N*S,N)):(K=M/(1*E),a(M,M/S))}function g(b){K=b;a(E*K,D*K)}function h(){T=!T;var a=document.getElementById("extended-crosshair-btn");
T?a.classList.add("pressed-button"):a.classList.remove("pressed-button");H.width=H.width}function k(a,b){var c=wpd.zoomView.getSize(),d=wpd.zoomView.getZoomRatio(),e=0,f=0,g=c.width,h=c.height;var k=c.width/d;c=c.height/d;var l=a-k/2;var n=b-c/2;a=l;b=n;var m=l+k;var p=n+c;0>l&&(a=0,e=-l*d);0>n&&(b=0,f=-n*d);l+k>=E&&(m=E,g-=d*(E-(l+k)));n+c>=D&&(p=D,h-=d*(D-(n+c)));k=R.getImageData(parseInt(a,10),parseInt(b,10),parseInt(m-a,10),parseInt(p-b,10));c=U.getImageData(parseInt(a,10),parseInt(b,10),parseInt(m-
a,10),parseInt(p-b,10));for(m=0;m<c.data.length;m+=4)if(0!=c.data[m]||0!=c.data[m+1]||0!=c.data[m+2])l=c.data[m+3]/255,k.data[m]=(1-l)*k.data[m]+l*c.data[m],k.data[m+1]=(1-l)*k.data[m+1]+l*c.data[m+1],k.data[m+2]=(1-l)*k.data[m+2]+l*c.data[m+2];a=d*(parseInt(a,10)-a);d*=parseInt(b,10)-b;wpd.zoomView.setZoomImage(k,parseInt(e+a,10),parseInt(f+d,10),parseInt(g-e,10),parseInt(h-f,10))}function l(a){clearTimeout(Z);var d=setTimeout,e=c(a);a=e.x;var e=e.y,f=b(a,e);T&&(H.width=H.width,O.strokeStyle="rgba(0,0,0, 0.5)",
O.beginPath(),O.moveTo(a,0),O.lineTo(a,N),O.moveTo(0,e),O.lineTo(M,e),O.stroke());k(f.x,f.y);wpd.zoomView.setCoords(f.x,f.y);Z=d(void 0,10)}function m(){B=document.getElementById("mainCanvas");J=document.getElementById("dataCanvas");I=document.getElementById("drawCanvas");H=document.getElementById("hoverCanvas");G=document.getElementById("topCanvas");P=document.createElement("canvas");L=document.createElement("canvas");F=B.getContext("2d");W=J.getContext("2d");O=H.getContext("2d");aa=G.getContext("2d");
ba=I.getContext("2d");R=P.getContext("2d");U=L.getContext("2d");V=document.getElementById("canvasDiv");document.addEventListener("keydown",function(a){X&&220===a.keyCode&&(a.preventDefault(),h())},!1);G.addEventListener("mousemove",l,!1);G.addEventListener("dragover",function(a){a.preventDefault()},!0);G.addEventListener("drop",function(a){a.preventDefault();wpd.busyNote.show();a=a.dataTransfer.files;1===a.length&&r(a[0])},!0);G.addEventListener("mousemove",v,!1);G.addEventListener("click",q,!1);
G.addEventListener("mouseup",z,!1);G.addEventListener("mousedown",A,!1);G.addEventListener("mouseout",x,!0);document.addEventListener("mouseup",w,!1);document.addEventListener("mousedown",function(a){X=a.target===G?!0:!1},!1);document.addEventListener("keydown",function(a){if(X&&null!=y&&void 0!=y.onKeyDown)y.onKeyDown(a)},!0);wpd.zoomView.initZoom();document.getElementById("fileLoadBox").addEventListener("change",t);window.addEventListener("paste",function(a){if(void 0!==a.clipboardData&&(a=a.clipboardData.items,
void 0!==a))for(var b=0;b<a.length;b++)if(-1!==a[b].type.indexOf("image")){wpd.busyNote.show();var c=a[b].getAsFile();(window.URL||window.webkitURL).createObjectURL(c);r(c)}},!1)}function n(a){var b=document.createElement("img");b.onload=function(){null==B&&m();wpd.appData.reset();wpd.sidebar.clear();u();e();E=b.width;D=b.height;S=E/(1*D);P.width=E;P.height=D;L.width=E;L.height=D;R.drawImage(b,0,0,E,D);Q=R.getImageData(0,0,E,D);B.width=B.width;d();f();wpd.appData.plotLoaded(Q);wpd.busyNote.close();
!1===ca&&wpd.popup.show("axesList");ca=!1};b.src=a}function p(a,b,c,h,k){u();e();E=b;D=c;S=E/(1*D);P.width=E;P.height=D;L.width=E;L.height=D;R.putImageData(a,0,0);Q=a;B.width=B.width;d();k?g(K):f();h&&(wpd.appData.reset(),wpd.appData.plotLoaded(Q))}function r(a){if(a.type.match("image.*")){var b=new FileReader;b.onload=function(){n(b.result)};b.readAsDataURL(a)}else wpd.messagePopup.show(wpd.gettext("invalid-file"),wpd.gettext("invalid-file-text")),wpd.busyNote.close()}function t(){var a=document.getElementById("fileLoadBox");
1==a.files.length&&(a=a.files[0],wpd.busyNote.show(),r(a));wpd.popup.close("loadNewImage")}function u(){if(null!=y&&void 0!=y.onRemove)y.onRemove();y=null}function v(a){if(null!=y&&void 0!=y.onMouseMove){var d=c(a),e=b(d.x,d.y);y.onMouseMove(a,d,e)}}function q(a){if(null!=y&&void 0!=y.onMouseClick){var d=c(a),e=b(d.x,d.y);y.onMouseClick(a,d,e)}}function w(a){if(null!=y&&void 0!=y.onDocumentMouseUp){var d=c(a),e=b(d.x,d.y);y.onDocumentMouseUp(a,d,e)}}function z(a){if(null!=y&&void 0!=y.onMouseUp){var d=
c(a),e=b(d.x,d.y);y.onMouseUp(a,d,e)}}function A(a){if(null!=y&&void 0!=y.onMouseDown){var d=c(a),e=b(d.x,d.y);y.onMouseDown(a,d,e)}}function x(a){if(null!=y&&void 0!=y.onMouseOut){var d=c(a),e=b(d.x,d.y);y.onMouseOut(a,d,e)}}var B,J,I,H,G,P,L,V,F,W,ba,O,aa,R,U,M,N,E,D,S,Y,Q,K,T=!1,Z,y,C,X=!1,ca=!0;return{zoomIn:function(){g(1.2*K)},zoomOut:function(){g(K/1.2)},zoomFit:f,zoom100perc:function(){g(1)},toggleExtendedCrosshairBtn:h,setZoomRatio:g,getZoomRatio:function(){return K},loadImageFromURL:n,loadImageFromData:p,
load:t,runImageOp:function(a,b){a=a(Q,E,D);p(a.imageData,a.width,a.height,b,a.keepZoom)},setTool:function(a){if(null!=y&&void 0!=y.onRemove)y.onRemove();y=a;if(null!=y&&void 0!=y.onAttach)y.onAttach()},removeTool:u,getAllContexts:function(){return{mainCtx:F,dataCtx:W,drawCtx:ba,hoverCtx:O,topCtx:aa,oriImageCtx:R,oriDataCtx:U}},resetData:function(){L.width=L.width;J.width=J.width},resetHover:function(){H.width=H.width},imagePx:b,screenPx:function(a,b){return{x:a*K,y:b*K}},updateZoomOnEvent:function(a){a=
c(a);a=b(a.x,a.y);k(a.x,a.y);wpd.zoomView.setCoords(a.x,a.y)},updateZoomToImagePosn:function(a,b){k(a,b);wpd.zoomView.setCoords(a,b)},getDisplaySize:function(){return{width:M,height:N}},getImageSize:function(){return{width:E,height:D}},copyImageDataLayerToScreen:function(){W.drawImage(L,0,0,M,N)},setRepainter:function(a){if(null==C||void 0==C.painterName||null==a||void 0==a.painterName||C.painterName!=a.painterName){if(null!=C&&void 0!=C.onRemove)C.onRemove();C=a;if(null!=C&&void 0!=C.onAttach)C.onAttach()}},
removeRepainter:e,forceHandlerRepaint:function(){if(null!=C&&void 0!=C.onForcedRedraw)C.onForcedRedraw()},getRepainter:function(){return C},saveImage:function(){var a=document.createElement("canvas"),b=a.getContext("2d"),c;a.width=E;a.height=D;b.drawImage(P,0,0,E,D);var d=b.getImageData(0,0,E,D);var e=U.getImageData(0,0,E,D);for(c=0;c<d.data.length;c+=4)if(0!=e.data[c]||0!=e.data[c+1]||0!=e.data[c+2]){var f=e.data[c+3]/255;d.data[c]=(1-f)*d.data[c]+f*e.data[c];d.data[c+1]=(1-f)*d.data[c+1]+f*e.data[c+
1];d.data[c+2]=(1-f)*d.data[c+2]+f*e.data[c+2]}b.putImageData(d,0,0);window.open(a.toDataURL(),"_blank")}}}();wpd=wpd||{};
wpd.layoutManager=function(){function c(){var a=parseInt(document.body.offsetWidth,10),b=parseInt(document.body.offsetHeight,10);e.style.height=b+"px";f.style.height=b-280+"px";g.style.width=a-e.offsetWidth-5+"px";g.style.height=b+"px";d.style.height=b-44+"px";h.style.height=b-44+"px";wpd.sidebar.resize()}function b(b){clearTimeout(a);a=setTimeout(c,80)}var a,d,e,f,g,h;return{initialLayout:function(){d=document.getElementById("graphicsContainer");e=document.getElementById("sidebarContainer");f=document.getElementById("sidebarControlsContainer");
g=document.getElementById("mainContainer");h=document.getElementById("left-side-container");c();window.addEventListener("resize",b,!1);wpd.tree.init()},getGraphicsViewportSize:function(){return{width:d.offsetWidth,height:d.offsetHeight}}}}();wpd=wpd||{};
wpd.popup=function(){function c(c){var d=document.createElement("div");d.className="popup-drag-mask";d.style.display="inline-block";d.addEventListener("mousemove",b,!1);d.addEventListener("mouseup",a,!1);d.addEventListener("mouseout",e,!1);document.body.appendChild(d);g={dragMaskDiv:d,initialMouseX:c.pageX,initialMouseY:c.pageY,initialWindowX:h.offsetLeft,initialWindowY:h.offsetTop};c.preventDefault();c.stopPropagation()}function b(a){d(a);a.stopPropagation();a.preventDefault()}function a(a){d(a);
f();a.stopPropagation();a.preventDefault()}function d(a){var b=g.initialWindowX+a.pageX-g.initialMouseX;a=g.initialWindowY+a.pageY-g.initialMouseY;var c=parseInt(document.body.offsetWidth,10),d=parseInt(document.body.offsetHeight,10),e=parseInt(h.offsetWidth,10),f=parseInt(h.offsetHeight,10);b+.7*e<c&&0<b&&0<a&&a+.5*f<d&&(h.style.top=a+"px",h.style.left=b+"px")}function e(a){f()}function f(){null!=g&&null!=g.dragMaskDiv&&(g.dragMaskDiv.removeEventListener("mouseout",e,!1),g.dragMaskDiv.removeEventListener("mouseup",
a,!1),g.dragMaskDiv.removeEventListener("mousemove",b,!1),g.dragMaskDiv.style.display="none",document.body.removeChild(g.dragMaskDiv),g=null)}var g=null,h=null;return{show:function(a){document.getElementById("shadow").style.visibility="visible";a=document.getElementById(a);var b=parseInt(window.innerWidth,10),d=parseInt(window.innerHeight,10),e=parseInt(a.offsetWidth,10),f=parseInt(a.offsetHeight,10),d=(d-f)/2;a.style.left=(b-e)/2+"px";a.style.top=(60<d?60:d)+"px";a.style.visibility="visible";for(b=
0;b<a.childNodes.length;b++)if("popupheading"===a.childNodes[b].className){a.childNodes[b].addEventListener("mousedown",c,!1);break}h=a},close:function(a){document.getElementById("shadow").style.visibility="hidden";document.getElementById(a).style.visibility="hidden";f();h=null}}}();
wpd.busyNote=function(){var c,b=!1;return{show:function(){b||(null==c&&(c=document.createElement("div"),c.id="wait",c.innerHTML='<p align="center">'+wpd.gettext("processing")+"...</p>"),document.body.appendChild(c),b=!0)},close:function(){null!=c&&!0===b&&(document.body.removeChild(c),b=!1)}}}();
wpd.messagePopup=function(){var c;return{show:function(b,a,d){wpd.popup.show("messagePopup");document.getElementById("message-popup-heading").innerHTML=b;document.getElementById("message-popup-text").innerHTML=a;c=d},close:function(){wpd.popup.close("messagePopup");null!=c&&c()}}}();
wpd.okCancelPopup=function(){var c,b;return{show:function(a,d,e,f){wpd.popup.show("okCancelPopup");document.getElementById("ok-cancel-popup-heading").innerHTML=a;document.getElementById("ok-cancel-popup-text").innerHTML=d;c=e;b=f},ok:function(){wpd.popup.close("okCancelPopup");c()},cancel:function(){wpd.popup.close("okCancelPopup");b()}}}();wpd.unsupported=function(){wpd.messagePopup.show(wpd.gettext("unsupported"),wpd.gettext("unsupported-text"))};wpd=wpd||{};
wpd.sidebar=function(){function c(){var b=document.getElementsByClassName("sidebar"),a;for(a=0;a<b.length;a++)b[a].style.display="none"}return{show:function(b){c();b=document.getElementById(b);b.style.display="inline-block";b.style.height=parseInt(document.body.offsetHeight,10)-280+"px"},clear:c,resize:function(){var b=document.getElementsByClassName("sidebar"),a;for(a=0;a<b.length;a++)"inline-block"===b[a].style.display&&(b[a].style.height=parseInt(document.body.offsetHeight,10)-280+"px")}}}();
wpd=wpd||{};wpd.toolbar=function(){function c(){var b=document.getElementsByClassName("toolbar"),a;for(a=0;a<b.length;a++)b[a].style.visibility="hidden"}return{show:function(b){c();document.getElementById(b).style.visibility="visible"},clear:c}}();wpd=wpd||{};
wpd.transformationEquations=function(){return{show:function(){if(!1===wpd.appData.isAligned())wpd.messagePopup.show(wpd.gettext("transformation-eqns"),wpd.gettext("transformation-eqns-text"));else{wpd.popup.show("axes-transformation-equations-window");var c=document.getElementById("axes-transformation-equation-list"),b="",a=wpd.appData.getPlotData().axes,d=a.getTransformationEquations(),b=b+"<p><b>Axes Type</b>: ";a instanceof wpd.XYAxes?b+="XY</p>":a instanceof wpd.PolarAxes?b+="Polar</p>":a instanceof
wpd.TernaryAxes?b+="Ternary</p>":a instanceof wpd.MapAxes?b+="Map</p>":a instanceof wpd.ImageAxes&&(b+="Image</p>");if(null!=d.pixelToData){b+="<p><b>Pixel to Data</b></p><ol>";for(a=0;a<d.pixelToData.length;a++)b+='<li><p class="footnote">'+d.pixelToData[a]+"</p></li>";b+="</ol>"}b+="<p>&nbsp;</p>";if(null!=d.dataToPixel){b+="<p><b>Data to Pixel</b></p><ol>";for(a=0;a<d.dataToPixel.length;a++)b+='<li><p class="footnote">'+d.dataToPixel[a]+"</p></li>";b+="</ol>"}c.innerHTML=b}}}}();wpd=wpd||{};
wpd.TreeWidget=function(c){var b=this;this.$mainElem=c;this.treeData=null;this.$mainElem.addEventListener("click",function(a){return b._onclick(a)});this.idmap=[];this.itemCount=0};
wpd.TreeWidget.prototype._renderFolder=function(c,b,a){a=a?'<ul class="tree-list">':'<ul class="tree-list-root">';for(var d=0;d<c.length;d++){var e=c[d];this.itemCount++;if("string"===typeof e)a+="<li>",a+='<span class="tree-item" id="tree-item-id-'+this.itemCount+'">'+e+"</span>",this.idmap[this.itemCount]=b+"/"+e;else if("object"===typeof e){a+="<li>";var f=Object.keys(e)[0];a+='<span class="tree-folder" id="tree-item-id-'+this.itemCount+'">'+f+"</span>";this.idmap[this.itemCount]=b+"/"+f;a+=this._renderFolder(e[f],
b+"/"+f,!0)}a+="</li>"}return a+"</ul>"};wpd.TreeWidget.prototype.render=function(c){this.idmap=[];this.itemCount=0;this.treeData=c;this.$mainElem.innerHTML=this._renderFolder(this.treeData,"",!1);console.log(this.idmap)};wpd.TreeWidget.prototype._unselectAll=function(){var c=this.$mainElem.querySelectorAll(".tree-folder"),b=this.$mainElem.querySelectorAll(".tree-item");c.forEach(function(a){a.classList.remove("tree-selected")});b.forEach(function(a){a.classList.remove("tree-selected")})};
wpd.TreeWidget.prototype.selectPath=function(c,b){var a=this.idmap.indexOf(c);0<=a&&(this._unselectAll(),a=document.getElementById("tree-item-id-"+a),a.classList.add("tree-selected"),null!=this.itemSelectionCallback&&this.itemSelectionCallback(a,c,b))};
wpd.TreeWidget.prototype._onclick=function(c){var b=c.target.classList.contains("tree-item"),a=c.target.classList.contains("tree-folder");if(b||a)this._unselectAll(),c.target.classList.add("tree-selected"),null!=this.itemSelectionCallback&&(b=parseInt(c.target.id.replace("tree-item-id-",""),10),isNaN(b)||this.itemSelectionCallback(c.target,this.idmap[b],!1))};wpd.TreeWidget.prototype.onItemSelection=function(c){this.itemSelectionCallback=c};
wpd.tree=function(){function c(){if(null!=e){var a=[],c=wpd.appData.getPlotData(),d=c.axes;null==d?a.push({Axes:[]}):a.push({Axes:[d.name]});d=c.getDataSeriesNames();a.push({Datasets:d});d=[];null!=c.angleMeasurementData&&d.push("Angle");null!=c.distanceMeasurementData&&d.push("Distance");a.push({Measurements:d});e.render(a);b(null)}}function b(a){document.querySelectorAll(".tree-widget").forEach(function(b){b.style.display=b.id===a?"inline":"none"})}function a(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();
wpd.sidebar.clear()}function d(c,d,e){"/Datasets"===d?(a(),b("dataset-group-tree-widget")):"/Axes"===d?(a(),b("axes-group-tree-widget")):"/Measurements"===d?(a(),b("measurement-group-tree-widget")):d===wpd.measurementModes.distance.treePath?(e||wpd.measurement.start(wpd.measurementModes.distance),b("distance-item-tree-widget")):d===wpd.measurementModes.angle.treePath?(e||wpd.measurement.start(wpd.measurementModes.angle),b("angle-item-tree-widget")):d.startsWith("/Datasets/")?(e||(c=wpd.appData.getPlotData(),
d=c.getDataSeriesNames().indexOf(d.replace("/Datasets/","")),c.setActiveDataSeriesIndex(d),wpd.acquireData.load(),wpd.dataPointCounter.setCount()),b("dataset-item-tree-widget")):d.startsWith("/Axes/")||b(null)}var e=null;return{init:function(){var a=document.getElementById("tree-container");e=new wpd.TreeWidget(a);e.onItemSelection(d);c()},refresh:function(){c()},selectPath:function(a,b){e.selectPath(a,b)},addMeasurement:function(a){wpd.measurement.start(a);c();wpd.tree.selectPath(a.treePath,!0)}}}();
wpd=wpd||{};
wpd.webcamCapture=function(){function c(){void 0!=b&&b.stop();wpd.popup.close("webcamCapture")}var b;return{start:function(){if(null==(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia))wpd.messagePopup.show(wpd.gettext("webcam-capture"),wpd.gettext("webcam-capture-text"));else{wpd.popup.show("webcamCapture");var a=document.getElementById("webcamVideo");navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||
navigator.msGetUserMedia;navigator.getUserMedia({video:!0},function(c){b=c;a.src=window.URL.createObjectURL(c)},function(){})}},cancel:function(){c()},capture:function(){var a=document.createElement("canvas"),b=document.getElementById("webcamVideo"),e=a.getContext("2d");a.width=b.videoWidth;a.height=b.videoHeight;e.drawImage(b,0,0);var f=e.getImageData(0,0,a.width,a.height);c();wpd.graphicsWidget.runImageOp(function(){return{imageData:f,width:a.width,height:a.height}})}}}();wpd=wpd||{};
wpd.zoomView=function(){function c(){var a=document.getElementById("zoomCrossHair"),b=a.getContext("2d");a.width=a.width;b.strokeStyle="black"===h?"rgba(0,0,0,1)":"red"===h?"rgba(255,0,0,1)":"yellow"===h?"rgba(255,255,0,1)":"rgba(0,0,0,1)";b.beginPath();b.moveTo(125,0);b.lineTo(125,250);b.moveTo(0,125);b.lineTo(250,125);b.stroke()}var b,a,d,e,f,g,h="black";return{initZoom:function(){b=document.getElementById("zoomCanvas");a=b.getContext("2d");d=document.createElement("canvas");e=d.getContext("2d");
f=document.getElementById("mousePosition");g=5;c()},setZoomImage:function(c,f,h,n,p){d.width=n/g;d.height=p/g;e.putImageData(c,0,0);b.width=b.width;a.drawImage(d,f,h,n,p)},setCoords:function(a,b){if(wpd.appData.isAligned()){var c=wpd.appData.getPlotData();f.innerHTML=c.axes.pixelToLiveString(a,b)}else f.innerHTML=a.toFixed(2)+", "+b.toFixed(2)},setZoomRatio:function(a){g=a},getZoomRatio:function(){return g},getSize:function(){return{width:250,height:250}},showSettingsWindow:function(){document.getElementById("zoom-magnification-value").value=
g;document.getElementById("zoom-crosshair-color-value").value=h;wpd.popup.show("zoom-settings-popup")},applySettings:function(){g=document.getElementById("zoom-magnification-value").value;h=document.getElementById("zoom-crosshair-color-value").value;c();wpd.popup.close("zoom-settings-popup")}}}();wpd=wpd||{};
wpd.xyCalibration=function(){function c(){wpd.popup.show("xyAlignment")}return{start:function(){wpd.popup.show("xyAxesInfo")},reload:function(){var b=new wpd.AxesCornersTool(4,2,["X1","X2","Y1","Y2"],!0);wpd.graphicsWidget.setTool(b)},pickCorners:function(){wpd.popup.close("xyAxesInfo");var b=new wpd.AxesCornersTool(4,2,["X1","X2","Y1","Y2"]);wpd.graphicsWidget.setTool(b)},getCornerValues:c,align:function(){var b=document.getElementById("xmin").value,a=document.getElementById("xmax").value,d=document.getElementById("ymin").value,
e=document.getElementById("ymax").value,f=document.getElementById("xlog").checked,g=document.getElementById("ylog").checked,h=new wpd.XYAxes,k=wpd.alignAxes.getActiveCalib();if(f&&(0==parseFloat(b)||0==parseFloat(a))||g&&(0==parseFloat(d)||0==parseFloat(e)))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-log-inputs"),wpd.gettext("calibration-enter-valid-log"),c),!1;k.setDataAt(0,b,d);k.setDataAt(1,a,d);k.setDataAt(2,b,d);k.setDataAt(3,a,e);if(!h.calibrate(k,
f,g))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-inputs"),wpd.gettext("calibration-enter-valid"),c),!1;b=wpd.appData.getPlotData();b.axes=h;b.calibration=k;wpd.popup.close("xyAlignment");return!0}}}();
wpd.barCalibration=function(){function c(){wpd.popup.show("barAlignment")}return{start:function(){wpd.popup.show("barAxesInfo")},reload:function(){var b=new wpd.AxesCornersTool(2,2,["P1","P2"],!0);wpd.graphicsWidget.setTool(b)},pickCorners:function(){wpd.popup.close("barAxesInfo");var b=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(b)},getCornerValues:c,align:function(){var b=document.getElementById("bar-axes-p1").value,a=document.getElementById("bar-axes-p2").value,d=document.getElementById("bar-axes-log-scale").checked,
e=document.getElementById("bar-axes-rotated").checked,f=new wpd.BarAxes,g=wpd.alignAxes.getActiveCalib();g.setDataAt(0,0,b);g.setDataAt(1,0,a);if(!f.calibrate(g,d,e))return wpd.popup.close("barAlignment"),wpd.messagePopup.show(wpd.gettext("calibration-invalid-inputs"),wpd.gettext("calibration-enter-valid"),c),!1;b=wpd.appData.getPlotData();b.axes=f;b.calibration=g;wpd.popup.close("barAlignment");return!0}}}();
wpd.polarCalibration=function(){return{start:function(){wpd.popup.show("polarAxesInfo")},reload:function(){var c=new wpd.AxesCornersTool(3,2,["Origin","P1","P2"],!0);wpd.graphicsWidget.setTool(c)},pickCorners:function(){wpd.popup.close("polarAxesInfo");var c=new wpd.AxesCornersTool(3,2,["Origin","P1","P2"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("polarAlignment")},align:function(){var c=parseFloat(document.getElementById("polar-r1").value),b=parseFloat(document.getElementById("polar-theta1").value),
a=parseFloat(document.getElementById("polar-r2").value),d=parseFloat(document.getElementById("polar-theta2").value),e=document.getElementById("polar-degrees").checked;document.getElementById("polar-radians");var f=document.getElementById("polar-clockwise").checked,g=document.getElementById("polar-log-scale").checked,h=new wpd.PolarAxes,k=wpd.alignAxes.getActiveCalib();k.setDataAt(1,c,b);k.setDataAt(2,a,d);h.calibrate(k,e,f,g);c=wpd.appData.getPlotData();c.axes=h;c.calibration=k;wpd.popup.close("polarAlignment");
return!0}}}();
wpd.ternaryCalibration=function(){return{start:function(){wpd.popup.show("ternaryAxesInfo")},reload:function(){var c=new wpd.AxesCornersTool(3,3,["A","B","C"],!0);wpd.graphicsWidget.setTool(c)},pickCorners:function(){wpd.popup.close("ternaryAxesInfo");var c=new wpd.AxesCornersTool(3,3,["A","B","C"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("ternaryAlignment")},align:function(){document.getElementById("range0to1");var c=document.getElementById("range0to100").checked,b=
document.getElementById("ternarynormal").checked,a=new wpd.TernaryAxes,d=wpd.alignAxes.getActiveCalib();a.calibrate(d,c,b);c=wpd.appData.getPlotData();c.axes=a;c.calibration=d;wpd.popup.close("ternaryAlignment");return!0}}}();
wpd.mapCalibration=function(){return{start:function(){wpd.popup.show("mapAxesInfo")},reload:function(){var c=new wpd.AxesCornersTool(2,2,["P1","P2"],!0);wpd.graphicsWidget.setTool(c)},pickCorners:function(){wpd.popup.close("mapAxesInfo");var c=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("mapAlignment")},align:function(){var c=parseFloat(document.getElementById("scaleLength").value),b=document.getElementById("scaleUnits").value,
a=new wpd.MapAxes,d=wpd.alignAxes.getActiveCalib();a.calibrate(d,c,b);c=wpd.appData.getPlotData();c.axes=a;c.calibration=d;wpd.popup.close("mapAlignment");return!0}}}();
wpd.AxesCornersTool=function(){return function(c,b,a,d){var e=0,f=new wpd.Calibration(b),g=!0;d?(e=c,f=wpd.alignAxes.getActiveCalib(),g=!1):(e=0,f=new wpd.Calibration(b),g=!0,f.labels=a,wpd.alignAxes.setActiveCalib(f),wpd.graphicsWidget.resetData());this.onMouseClick=function(a,b,d){g?(e+=1,b=wpd.alignAxes.getActiveCalib(),b.addPoint(d.x,d.y,0,0),b.unselectAll(),b.selectPoint(e-1),wpd.graphicsWidget.forceHandlerRepaint(),e===c&&(g=!1,wpd.alignAxes.calibrationCompleted())):(b=wpd.alignAxes.getActiveCalib(),
b.unselectAll(),b.selectNearestPoint(d.x,d.y),wpd.graphicsWidget.forceHandlerRepaint());wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){var b=wpd.alignAxes.getActiveCalib();if(0!==b.getSelectedPoints().length){var c=b.getPoint(b.getSelectedPoints()[0]),d=c.px,c=c.py,e=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))c-=e;else if(wpd.keyCodes.isDown(a.keyCode))c+=e;else if(wpd.keyCodes.isLeft(a.keyCode))d-=
e;else if(wpd.keyCodes.isRight(a.keyCode))d+=e;else return;b.changePointPx(b.getSelectedPoints()[0],d,c);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(d,c);a.preventDefault();a.stopPropagation()}}}}();
wpd.AlignmentCornersRepainter=function(){return function(){this.painterName="AlignmentCornersReptainer";this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()};this.onRedraw=function(){var c=wpd.alignAxes.getActiveCalib();if(null!=c){var b;for(b=0;b<c.getCount();b++){var a=c.getPoint(b);a={x:a.px,y:a.py};var d=c.isPointSelected(b)?"rgba(0,200,0,1)":"rgba(200,0,0,1)";wpd.graphicsHelper.drawPoint(a,d,c.labels[b])}}}}}();
wpd.alignAxes=function(){var c,b;return{start:function(){xyEl=document.getElementById("r_xy");polarEl=document.getElementById("r_polar");ternaryEl=document.getElementById("r_ternary");mapEl=document.getElementById("r_map");imageEl=document.getElementById("r_image");barEl=document.getElementById("r_bar");wpd.popup.close("axesList");if(!0===xyEl.checked)b=wpd.xyCalibration;else if(!0===barEl.checked)b=wpd.barCalibration;else if(!0===polarEl.checked)b=wpd.polarCalibration;else if(!0===ternaryEl.checked)b=
wpd.ternaryCalibration;else if(!0===mapEl.checked)b=wpd.mapCalibration;else if(!0===imageEl.checked){b=null;var a=new wpd.ImageAxes;a.calibrate();wpd.appData.getPlotData().axes=a;wpd.appData.isAligned(!0);wpd.acquireData.load();wpd.tree.refresh();wpd.tree.selectPath("/Datasets/Default Dataset",!0)}null!=b&&(b.start(),wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter))},calibrationCompleted:function(){wpd.sidebar.show("axes-calibration-sidebar")},getCornerValues:function(){b.getCornerValues()},
align:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();b.align()&&(wpd.appData.isAligned(!0),wpd.acquireData.load(),wpd.tree.refresh(),wpd.tree.selectPath("/Datasets/Default Dataset",!0))},getActiveCalib:function(){return c},setActiveCalib:function(a){c=a},editAlignment:function(){wpd.appData.isAligned()&&null!=b?wpd.popup.show("edit-or-reset-calibration-popup"):wpd.popup.show("axesList")},reloadCalibrationForEditing:function(){wpd.popup.close("edit-or-reset-calibration-popup");
b.reload();wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter);wpd.graphicsWidget.forceHandlerRepaint();wpd.sidebar.show("axes-calibration-sidebar")}}}();wpd=wpd||{};wpd.autoExtraction=function(){return{start:function(){wpd.colorPicker.init();wpd.algoManager.updateAlgoList()},changeDataset:function(){var c=document.getElementById("automatic-sidebar-dataset-list").selectedIndex;wpd.appData.getPlotData().setActiveDataSeriesIndex(c);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()}}}();
wpd.algoManager=function(){function c(){var a=document.getElementById("auto-extract-algo-name").value,b=wpd.appData.getPlotData().getAutoDetector();b.algorithm="averagingWindow"===a?new wpd.AveragingWindowAlgo:"XStepWithInterpolation"===a?new wpd.XStepWithInterpolationAlgo:"XStep"===a?new wpd.AveragingWindowWithStepSizeAlgo:"blobDetector"===a?new wpd.BlobDetectorAlgo:"barExtraction"===a||"histogram"===a?new wpd.BarExtractionAlgo:new wpd.AveragingWindowAlgo;var b=b.algorithm,a=document.getElementById("algo-parameter-container"),
b=b.getParamList(),c,f="<table>";for(c=0;c<b.length;c++)f+="<tr><td>"+b[c][0]+'</td><td><input type="text" size=3 id="algo-param-'+c+'" class="algo-params" value="'+b[c][2]+'"/></td><td>'+b[c][1]+"</td></tr>";a.innerHTML=f+"</table>"}var b;return{updateAlgoList:function(){var a="",d=wpd.appData.getPlotData().axes,e=document.getElementById("auto-extract-algo-name");d!==b&&(b=d,d instanceof wpd.BarAxes||(a+='<option value="averagingWindow">'+wpd.gettext("averaging-window")+"</option>"),d instanceof
wpd.XYAxes&&(a+='<option value="XStepWithInterpolation">'+wpd.gettext("x-step-with-interpolation")+"</option>",a+='<option value="XStep">'+wpd.gettext("x-step")+"</option>"),d instanceof wpd.BarAxes||(a+='<option value="blobDetector">'+wpd.gettext("blob-detector")+"</option>"),d instanceof wpd.BarAxes&&(a+='<option value="barExtraction">'+wpd.gettext("bar-extraction")+"</option>"),d instanceof wpd.XYAxes&&(a+='<option value="histogram">'+wpd.gettext("histogram")+"</option>"),e.innerHTML=a,c())},applyAlgoSelection:c,
run:function(){wpd.busyNote.show();setTimeout(function(){var a=wpd.appData.getPlotData().getAutoDetector(),b=a.algorithm,c=new wpd.DataPointsRepainter,f=document.getElementsByClassName("algo-params"),g,h=wpd.graphicsWidget.getAllContexts(),k=wpd.graphicsWidget.getImageSize();for(g=0;g<f.length;g++){var l=f[g].id;l=parseInt(l.replace("algo-param-",""),10);b.setParam(l,parseFloat(f[g].value))}wpd.graphicsWidget.removeTool();a.imageData=h.oriImageCtx.getImageData(0,0,k.width,k.height);a.generateBinaryData();
wpd.graphicsWidget.setRepainter(c);b.run(wpd.appData.getPlotData());wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount();wpd.busyNote.close();return!0},10)}}}();wpd=wpd||{};
wpd.colorSelectionWidget=function(){function c(){document.getElementById("color-selection-selected-color-box").style.backgroundColor="rgb("+b[0]+","+b[1]+","+b[2]+")";document.getElementById("color-selection-red").value=b[0];document.getElementById("color-selection-green").value=b[1];document.getElementById("color-selection-blue").value=b[2];var a=document.getElementById("color-selection-options"),c=wpd.appData.getPlotData().topColors,d=10<c.length?10:c.length,e,l="";for(e=0;e<d;e++){var m="rgb("+
c[e].r+","+c[e].g+","+c[e].b+");";var n=c[e].percentage.toFixed(3)+"%";l+='<div class="colorOptionBox" style="background-color: '+m+'" title="'+n+'" onclick="wpd.colorSelectionWidget.selectTopColor('+e+');"></div>'}a.innerHTML=l;wpd.popup.show("color-selection-widget")}var b,a,d,e;return{setParams:function(c){b=c.color;a=c.triggerElementId;d=c.title;e=c.setColorDelegate;document.getElementById("color-selection-title").innerHTML=d},startPicker:c,pickColor:function(){wpd.popup.close("color-selection-widget");
var a=new wpd.ColorPickerTool;a.onComplete=function(a){b=a;e(a);wpd.graphicsWidget.removeTool();c()};wpd.graphicsWidget.setTool(a)},setColor:function(){var c=[];c[0]=parseInt(document.getElementById("color-selection-red").value,10);c[1]=parseInt(document.getElementById("color-selection-green").value,10);c[2]=parseInt(document.getElementById("color-selection-blue").value,10);b=c;e(c);wpd.popup.close("color-selection-widget");c=document.getElementById(a);c.style.backgroundColor="rgb("+b[0]+","+b[1]+
","+b[2]+")";c.style.color=200>b[0]+b[1]+b[2]?"rgb(255,255,255)":"rgb(0,0,0)"},selectTopColor:function(a){var d=[],f=wpd.appData.getPlotData().topColors;d[0]=f[a].r;d[1]=f[a].g;d[2]=f[a].b;b=d;e(d);c()},paintFilteredColor:function(a,b){var c=wpd.graphicsWidget.getAllContexts();wpd.appData.getPlotData().getAutoDetector();var d=wpd.graphicsWidget.getImageSize(),e;var f=c.oriDataCtx.getImageData(0,0,d.width,d.height);if(null!=b&&0!==b.length){for(e=0;e<b.length;e++){var g=b[e];!0===a[g]?(parseInt(g/
d.width,10),f.data[4*g]=255,f.data[4*g+1]=255,f.data[4*g+2]=0,f.data[4*g+3]=255):(f.data[4*g]=0,f.data[4*g+1]=0,f.data[4*g+2]=0,f.data[4*g+3]=150)}c.oriDataCtx.putImageData(f,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}}}}();
wpd.colorPicker=function(){function c(){return{color:wpd.appData.getPlotData().getAutoDetector().fgColor,triggerElementId:"color-button",title:wpd.gettext("specify-foreground-color"),setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().fgColor=a}}}function b(){return{color:wpd.appData.getPlotData().getAutoDetector().bgColor,triggerElementId:"color-button",title:wpd.gettext("specify-background-color"),setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().bgColor=
a}}}function a(){var a=document.getElementById("color-button"),b=document.getElementById("color-distance-value"),c=wpd.appData.getPlotData().getAutoDetector(),g=document.getElementById("color-detection-mode-select");var h="fg"===c.colorDetectionMode?c.fgColor:c.bgColor;color_distance=c.colorDistance;a.style.backgroundColor="rgb("+h[0]+","+h[1]+","+h[2]+")";b.value=color_distance;g.value=c.colorDetectionMode}return{startPicker:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();
wpd.graphicsWidget.resetData();"fg"===wpd.appData.getPlotData().getAutoDetector().colorDetectionMode?wpd.colorSelectionWidget.setParams(c()):wpd.colorSelectionWidget.setParams(b());wpd.colorSelectionWidget.startPicker()},changeDetectionMode:function(){var b=document.getElementById("color-detection-mode-select");wpd.appData.getPlotData().getAutoDetector().colorDetectionMode=b.value;a()},changeColorDistance:function(){var a=parseFloat(document.getElementById("color-distance-value").value);wpd.appData.getPlotData().getAutoDetector().colorDistance=
a},init:a,testColorDetection:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.ColorFilterRepainter);var a=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getAutoDetector(),c=wpd.graphicsWidget.getImageSize();b.imageData=a.oriImageCtx.getImageData(0,0,c.width,c.height);b.generateBinaryData();wpd.colorSelectionWidget.paintFilteredColor(b.binaryData,b.mask)}}}();
wpd.ColorPickerTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts();this.onMouseClick=function(b,a,d){var e=c.oriImageCtx.getImageData(d.x,d.y,1,1);b=e.data[0];a=e.data[1];d=e.data[2];0===e.data[3]&&(d=a=b=255);this.onComplete([b,a,d])};this.onComplete=function(b){}}}();
wpd.ColorFilterRepainter=function(){return function(){this.painterName="colorFilterRepainter";this.onRedraw=function(){var c=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(c.binaryData,c.mask)}}}();wpd=wpd||{};
wpd.plotDataProvider=function(){return{getDatasetNames:function(){var c=wpd.appData.getPlotData(),b=[],a;for(a=0;a<c.dataSeriesColl.length;a++)b[a]=c.dataSeriesColl[a].name;return b},getDatasetIndex:function(){return wpd.appData.getPlotData().getActiveDataSeriesIndex()},setDatasetIndex:function(c){wpd.appData.getPlotData().setActiveDataSeriesIndex(c);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},getData:function(){if(wpd.appData.getPlotData().axes instanceof wpd.BarAxes){var c=
[],b=wpd.appData.getPlotData(),a=b.getActiveDataSeries(),b=b.axes,d;for(d=0;d<a.getCount();d++){var e=a.getPixel(d);var f=b.pixelToData(e.x,e.y);c[d]=[];e=null==e.metadata?"Bar"+d:e.metadata[0];c[d][0]=e;c[d][1]=f[0]}return{fields:["Label","Value"],fieldDateFormat:[],rawData:c,allowConnectivity:!1,connectivityFieldIndices:[],isFieldSortable:[!1,!0]}}a=wpd.appData.getPlotData();c=a.getActiveDataSeries();a=a.axes;b=[];d=[];f=[];e=[];var g,h,k=c.hasMetadata(),l=c.getMetadataKeys(),m=!0===k?l.length:
0;for(g=0;g<c.getCount();g++){var n=c.getPixel(g);var p=a.pixelToData(n.x,n.y);f[g]=[];for(h=0;h<p.length;h++)f[g][h]=p[h];for(h=0;h<m;h++){var r=null==n.metadata||null==n.metadata[h]?0:n.metadata[h];f[g][p.length+h]=r}}c=a.getAxesLabels();k&&(c=c.concat(l));for(h=0;h<c.length;h++)h<a.getDimensions()&&(d[h]=h,null!=a.isDate&&a.isDate(h)&&(b[h]=a.getInitialDateFormat(h))),e[h]=!0;return{fields:c,fieldDateFormat:b,rawData:f,allowConnectivity:!0,connectivityFieldIndices:d,isFieldSortable:e}}}}();
wpd.measurementDataProvider=function(){var c="distance";return{getDatasetNames:function(){if("angle"===c)return["Angle Measurements"];if("distance"===c)return["Distance Measurements"]},getDatasetIndex:function(){return 0},setDatasetIndex:function(b){},setDataSource:function(b){c=b},getData:function(){var b=[],a=[],d=[],e=wpd.appData.getPlotData(),f=e.axes,g=wpd.appData.isAligned()&&f instanceof wpd.MapAxes;if("distance"===c){d=e.distanceMeasurementData;for(b=0;b<d.connectionCount();b++)a[b]=[],a[b][0]=
"Dist"+b,a[b][1]=g?f.pixelToDataDistance(d.getDistance(b)):d.getDistance(b);b=["Label","Distance"];d=[!1,!0]}else if("angle"===c){d=e.angleMeasurementData;for(b=0;b<d.connectionCount();b++)a[b]=[],a[b][0]="Theta"+b,a[b][1]=d.getAngle(b);b=["Label","Angle"];d=[!1,!0]}return{fields:b,fieldDateFormat:[],rawData:a,allowConnectivity:!1,connectivityFieldIndices:[],isFieldSortable:d}}}}();wpd=wpd||{};
wpd.graphicsHelper=function(){return{drawPoint:function(c,b,a){var d=wpd.graphicsWidget.screenPx(c.x,c.y),e=wpd.graphicsWidget.getAllContexts(),f=wpd.graphicsWidget.getImageSize().height;if(null!=a){e.dataCtx.font="15px sans-serif";var g=e.dataCtx.measureText(a).width;e.dataCtx.fillStyle="rgba(255, 255, 255, 0.7)";e.dataCtx.fillRect(d.x-13,d.y-8,g+5,35);e.dataCtx.fillStyle=b;e.dataCtx.fillText(a,d.x-10,d.y+18)}e.dataCtx.beginPath();e.dataCtx.fillStyle=b;e.dataCtx.strokeStyle="rgb(255, 255, 255)";
e.dataCtx.arc(d.x,d.y,4,0,2*Math.PI,!0);e.dataCtx.fill();e.dataCtx.stroke();null!=a&&(e.oriDataCtx.font="15px sans-serif",e.oriDataCtx.fillStyle=b,e.oriDataCtx.fillText(a,c.x-10,c.y+18));e.oriDataCtx.beginPath();e.oriDataCtx.fillStyle=b;e.oriDataCtx.strokeStyle="rgb(255, 255, 255)";e.oriDataCtx.arc(c.x,c.y,1500<f?4:2,0,2*Math.PI,!0);e.oriDataCtx.fill();e.oriDataCtx.stroke()}}}();wpd=wpd||{};
wpd.gridDetection=function(){function c(a,b,c){var d=wpd.appData.getPlotData().backupImageData,e;for(e=0;e<d.data.length;e++)a.data[e]=d.data[e];return{imageData:a,width:b,height:c,keepZoom:!0}}function b(){wpd.graphicsWidget.removeTool();wpd.appData.getPlotData().gridData=null;wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();null!=wpd.appData.getPlotData().backupImageData&&wpd.graphicsWidget.runImageOp(c)}function a(a,b,c){var d=wpd.appData.getPlotData().gridData,e=wpd.appData.getPlotData().topColors[0],
f,g;null==e&&(e={r:255,g:0,b:0});if(null!=d)for(f=0;f<c;f++)for(g=0;g<b;g++){var n=4*(f*b+g);!0===d[n/4]&&(a.data[n]=e.r,a.data[n+1]=e.g,a.data[n+2]=e.b,a.data[n+3]=255)}return{imageData:a,width:b,height:c}}function d(){var a=parseFloat(document.getElementById("grid-color-distance").value);wpd.appData.getPlotData().getAutoDetector().gridColorDistance=a}return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();wpd.sidebar.show("grid-detection-sidebar");
var a=document.getElementById("grid-color-picker-button"),b=document.getElementById("grid-background-mode"),c=wpd.appData.getPlotData().getAutoDetector(),d=c.gridLineColor,c=c.gridBackgroundMode;null!=d&&(a.style.backgroundColor="rgb("+d[0]+","+d[1]+","+d[2]+")",a.style.color=200>d[0]+d[1]+d[2]?"rgb(255,255,255)":"rgb(0,0,0)");b.checked=c;a=wpd.appData.getPlotData().getAutoDetector();b=wpd.graphicsWidget.getAllContexts();d=wpd.graphicsWidget.getImageSize();a.imageData=b.oriImageCtx.getImageData(0,
0,d.width,d.height)},markBox:function(){var a=new wpd.GridBoxTool;wpd.graphicsWidget.setTool(a)},clearMask:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.appData.getPlotData().getAutoDetector().gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};wpd.graphicsWidget.resetData()},viewMask:function(){var a=new wpd.GridViewMaskTool;wpd.graphicsWidget.setTool(a)},grabMask:function(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.graphicsWidget.getImageSize(),
a=a.oriDataCtx.getImageData(0,0,b.width,b.height),c=[],d,k=0,l=wpd.appData.getPlotData().getAutoDetector();for(d=0;d<a.data.length;d+=4)if(255===a.data[d]&&255===a.data[d+1]&&0===a.data[d+2]){c[k]=d/4;k++;var m=parseInt(d/4%b.width,10);var n=parseInt(d/4/b.width,10);1===k?(l.gridMask.xmin=m,l.gridMask.xmax=m,l.gridMask.ymin=n,l.gridMask.ymax=n):(m<l.gridMask.xmin&&(l.gridMask.xmin=m),m>l.gridMask.xmax&&(l.gridMask.xmax=m),n<l.gridMask.ymin&&(l.gridMask.ymin=n),n>l.gridMask.ymax&&(l.gridMask.ymax=
n))}l.gridMask.pixels=c},startColorPicker:function(){wpd.colorSelectionWidget.setParams({color:wpd.appData.getPlotData().getAutoDetector().gridLineColor,triggerElementId:"grid-color-picker-button",title:"Specify Grid Line Color",setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().gridLineColor=a}});wpd.colorSelectionWidget.startPicker()},changeColorDistance:d,changeBackgroundMode:function(){var a=document.getElementById("grid-background-mode").checked;wpd.appData.getPlotData().getAutoDetector().gridBackgroundMode=
a},testColor:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.GridColorFilterRepainter);var a=wpd.appData.getPlotData().getAutoDetector();d();a.generateGridBinaryData();wpd.colorSelectionWidget.paintFilteredColor(a.gridBinaryData,a.gridMask.pixels)},run:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();b();var c=wpd.appData.getPlotData().getAutoDetector(),d=wpd.graphicsWidget.getAllContexts(),
g=wpd.graphicsWidget.getImageSize(),h=document.getElementById("grid-horiz-perc"),k=document.getElementById("grid-vert-perc"),l=document.getElementById("grid-horiz-enable").checked,m=document.getElementById("grid-vert-enable").checked;document.getElementById("grid-background-mode");var n=wpd.appData.getPlotData();null==n.backupImageData&&(n.backupImageData=d.oriImageCtx.getImageData(0,0,g.width,g.height));c.imageData=d.oriImageCtx.getImageData(0,0,g.width,g.height);c.generateGridBinaryData();wpd.gridDetectionCore.setHorizontalParameters(l,
h.value);wpd.gridDetectionCore.setVerticalParameters(m,k.value);wpd.gridDetectionCore.run();wpd.graphicsWidget.runImageOp(a);wpd.appData.getPlotData().gridData=null},reset:b}}();wpd.GridColorFilterRepainter=function(){return function(){this.painterName="gridColorFilterRepainter";this.onRedraw=function(){var c=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(c.gridBinaryData,c.gridMask.pixels)}}}();
wpd.GridBoxTool=function(){return function(){var c=!1,b,a,d=wpd.graphicsWidget.getAllContexts(),e,f,g=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(a.x,a.y,f.x-a.x,f.y-a.y)},h=function(f,g,h){!1!==c&&(clearTimeout(e),c=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,0.8)",d.dataCtx.fillRect(a.x,a.y,g.x-a.x,g.y-a.y),d.oriDataCtx.fillStyle="rgba(255,255,0,0.8)",d.oriDataCtx.fillRect(b.x,b.y,h.x-b.x,h.y-b.y))},k=null,l=null;
this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-box").classList.add("pressed-button");document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onMouseDown=function(d,e,f){!0!==c&&(c=!0,b=f,a=e)};this.onMouseMove=function(a,b,d){!1!==c&&(f=b,clearTimeout(e),e=setTimeout(g,2))};this.onMouseOut=function(a,b,d){!0===c&&(clearTimeout(e),k=b,l=d)};this.onDocumentMouseUp=function(a,b,c){null!=k&&null!=l?h(a,k,l):
h(a,b,c);l=k=null};this.onMouseUp=function(a,b,c){h(a,b,c)};this.onRemove=function(){document.getElementById("grid-mask-box").classList.remove("pressed-button");document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridMaskPainter=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getAutoDetector(),a=function(){if(null!=b.gridMask.pixels&&0!==b.gridMask.pixels.length){var a=wpd.graphicsWidget.getImageSize();imgData=c.oriDataCtx.getImageData(0,0,a.width,a.height);for(a=0;a<b.gridMask.pixels.length;a++){var e=b.gridMask.pixels[a];imgData.data[4*e]=255;imgData.data[4*e+1]=255;imgData.data[4*e+2]=0;imgData.data[4*e+3]=200}c.oriDataCtx.putImageData(imgData,0,0);
wpd.graphicsWidget.copyImageDataLayerToScreen()}};this.painterName="gridMaskPainter";this.onRedraw=function(){wpd.gridDetection.grabMask();a()};this.onAttach=function(){wpd.graphicsWidget.resetData();a()}}}();wpd=wpd||{};
wpd.imageOps=function(){function c(a,b,c){var d,e,h;for(d=0;d<c;d++)for(e=0;e<b/2;e++){var k=4*(d*b+e);var l=4*((d+1)*b-(e+1));for(h=0;4>h;h++){var m=a.data[k+h];a.data[k+h]=a.data[l+h];a.data[l+h]=m}}return{imageData:a,width:b,height:c}}function b(a,b,c){var d,e,h;for(d=0;d<c/2;d++)for(e=0;e<b;e++){var k=4*(d*b+e);var l=4*((c-(d+2))*b+e);for(h=0;4>h;h++){var m=a.data[k+h];a.data[k+h]=a.data[l+h];a.data[l+h]=m}}return{imageData:a,width:b,height:c}}return{hflip:function(){wpd.graphicsWidget.runImageOp(c)},
vflip:function(){wpd.graphicsWidget.runImageOp(b)}}}();wpd=wpd||{};wpd.keyCodes=function(){return{isUp:function(c){return 38===c},isDown:function(c){return 40===c},isLeft:function(c){return 37===c},isRight:function(c){return 39===c},isTab:function(c){return 9===c},isDel:function(c){return 46===c},isBackspace:function(c){return 8===c},isAlphabet:function(c,b){return 90<c||65>c?!1:String.fromCharCode(c).toLowerCase()===b},isEnter:function(c){return 13===c},isEsc:function(c){return 27===c}}}();
wpd=wpd||{};
wpd.acquireData=function(){function c(){var a=new wpd.ManualSelectionTool;wpd.graphicsWidget.setTool(a)}function b(){var a=new wpd.DeleteDataPointTool;wpd.graphicsWidget.setTool(a)}function a(){wpd.appData.getPlotData().getActiveDataSeries().clearAll();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.dataPointCounter.setCount();wpd.graphicsWidget.removeRepainter()}function d(){wpd.sidebar.show("acquireDataSidebar");var a=wpd.appData.getPlotData().axes;document.getElementById("edit-data-labels").style.display=a instanceof
wpd.BarAxes?"inline-block":"none";wpd.dataPointCounter.setCount()}function e(){wpd.graphicsWidget.setTool(new wpd.AdjustDataPointTool)}function f(){wpd.graphicsWidget.setTool(new wpd.EditLabelsTool)}return{load:function(){wpd.appData.isAligned()?(d(),wpd.autoExtraction.start(),wpd.dataPointCounter.setCount(),wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter),c()):wpd.messagePopup.show(wpd.gettext("acquire-data"),wpd.gettext("acquire-data-calibration"))},manualSelection:c,
adjustPoints:e,deletePoint:b,clearAll:function(){0>=wpd.appData.getPlotData().getActiveDataSeries().getCount()||wpd.okCancelPopup.show(wpd.gettext("clear-data-points"),wpd.gettext("clear-data-points-text"),a,function(){})},undo:function(){wpd.appData.getPlotData().getActiveDataSeries().removeLastPixel();wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},showSidebar:d,switchToolOnKeyPress:function(a){switch(a){case "d":b();break;case "a":c();break;
case "s":e();break;case "e":f()}},isToolSwitchKey:function(a){return wpd.keyCodes.isAlphabet(a,"a")||wpd.keyCodes.isAlphabet(a,"s")||wpd.keyCodes.isAlphabet(a,"d")||wpd.keyCodes.isAlphabet(a,"e")?!0:!1},changeDataset:function(a){a=a.selectedIndex;wpd.appData.getPlotData().setActiveDataSeriesIndex(a);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},editLabels:f}}();
wpd.dataPointLabelEditor=function(){function c(){var b=document.getElementById("data-point-label-field").value;null!=b&&0<b.length&&(a.setMetadataAt(d,[b]),wpd.graphicsWidget.resetData(),wpd.graphicsWidget.forceHandlerRepaint());wpd.popup.close("data-point-label-editor");wpd.graphicsWidget.setTool(e)}function b(){wpd.popup.close("data-point-label-editor");wpd.graphicsWidget.setTool(e)}var a,d,e;return{show:function(b,c,h){var f=b.getPixel(c).metadata[0];a=b;d=c;e=h;wpd.graphicsWidget.removeTool();
wpd.popup.show("data-point-label-editor");b=document.getElementById("data-point-label-field");b.value=f;b.focus()},ok:c,cancel:b,keydown:function(a){wpd.keyCodes.isEnter(a.keyCode)?c():wpd.keyCodes.isEsc(a.keyCode)&&b();a.stopPropagation()}}}();
wpd.ManualSelectionTool=function(){return function(){var c=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("manual-select-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(b,a,d){a=c.getActiveDataSeries();if(c.axes.dataPointsHaveLabels){var e=a.getMetadataKeys();null!=e&&"Label"===e[0]||a.setMetadataKeys(["Label"]);e=c.axes.dataPointsLabelPrefix+a.getCount();a.addPixel(d.x,d.y,[e]);wpd.graphicsHelper.drawPoint(d,
"rgb(200,0,0)",e)}else a.addPixel(d.x,d.y),wpd.graphicsHelper.drawPoint(d,"rgb(200,0,0)");wpd.graphicsWidget.updateZoomOnEvent(b);wpd.dataPointCounter.setCount();c.axes.dataPointsHaveLabels&&b.shiftKey&&wpd.dataPointLabelEditor.show(a,a.getCount()-1,this)};this.onRemove=function(){document.getElementById("manual-select-button").classList.remove("pressed-button")};this.onKeyDown=function(b){var a=c.getActiveDataSeries(),d=a.getCount()-1,e=a.getPixel(d),f=.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(b.keyCode))e.y-=
f;else if(wpd.keyCodes.isDown(b.keyCode))e.y+=f;else if(wpd.keyCodes.isLeft(b.keyCode))e.x-=f;else if(wpd.keyCodes.isRight(b.keyCode))e.x+=f;else{wpd.acquireData.isToolSwitchKey(b.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(b.keyCode).toLowerCase());return}a.setPixelAt(d,e.x,e.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e.x,e.y);b.preventDefault()}}}();
wpd.DeleteDataPointTool=function(){return function(){wpd.graphicsWidget.getAllContexts();var c=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("delete-point-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(b,a,d){c.getActiveDataSeries().removeNearestPixel(d.x,d.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(b);wpd.dataPointCounter.setCount()};
this.onKeyDown=function(b){wpd.acquireData.isToolSwitchKey(b.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(b.keyCode).toLowerCase())};this.onRemove=function(){document.getElementById("delete-point-button").classList.remove("pressed-button")}}}();
wpd.DataPointsRepainter=function(){return function(){var c=function(){var b=wpd.appData.getPlotData(),a=b.getActiveDataSeries();var c=a.getMetadataKeys();var e=!1;if(null!=b.axes)for(b.axes.dataPointsHaveLabels&&null!=c&&"Label"===c[0]&&(e=!0),c=0;c<a.getCount();c++){var f=a.getPixel(c);var g=(g=0<=a.getSelectedPixels().indexOf(c))?"rgb(0,200,0)":"rgb(200,0,0)";if(e){var h=f.metadata[0];null==h&&(h=b.axes.dataPointsLabelPrefix+c);wpd.graphicsHelper.drawPoint(f,g,h)}else wpd.graphicsHelper.drawPoint(f,
g)}};this.painterName="dataPointsRepainter";this.onAttach=function(){wpd.graphicsWidget.resetData();c()};this.onRedraw=function(){c()};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();c()}}}();
wpd.AdjustDataPointTool=function(){return function(){this.onAttach=function(){document.getElementById("manual-adjust-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter);wpd.toolbar.show("adjustDataPointsToolbar")};this.onRemove=function(){wpd.appData.getPlotData().getActiveDataSeries().unselectAll();wpd.graphicsWidget.forceHandlerRepaint();document.getElementById("manual-adjust-button").classList.remove("pressed-button");wpd.toolbar.clear()};this.onMouseClick=
function(c,b,a){b=wpd.appData.getPlotData().getActiveDataSeries();b.unselectAll();b.selectNearestPixel(a.x,a.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(c)};this.onKeyDown=function(c){if(wpd.acquireData.isToolSwitchKey(c.keyCode))wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(c.keyCode).toLowerCase());else{var b=wpd.appData.getPlotData().getActiveDataSeries(),a=b.getSelectedPixels()[0];if(null!=a){var d=b.getPixel(a),e=d.x,d=d.y,f=!0===c.shiftKey?5/wpd.graphicsWidget.getZoomRatio():
.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(c.keyCode))d-=f;else if(wpd.keyCodes.isDown(c.keyCode))d+=f;else if(wpd.keyCodes.isLeft(c.keyCode))e-=f;else if(wpd.keyCodes.isRight(c.keyCode))e+=f;else if(wpd.keyCodes.isAlphabet(c.keyCode,"q"))b.selectPreviousPixel(),a=b.getSelectedPixels()[0],d=b.getPixel(a),e=d.x,d=d.y;else if(wpd.keyCodes.isAlphabet(c.keyCode,"w"))b.selectNextPixel(),a=b.getSelectedPixels()[0],d=b.getPixel(a),e=d.x,d=d.y;else if(wpd.keyCodes.isAlphabet(c.keyCode,"e")){if(wpd.appData.getPlotData().axes.dataPointsHaveLabels){a=
b.getSelectedPixels()[0];c.preventDefault();c.stopPropagation();wpd.dataPointLabelEditor.show(b,a,this);return}}else{if(wpd.keyCodes.isDel(c.keyCode)||wpd.keyCodes.isBackspace(c.keyCode))b.removePixelAtIndex(a),b.unselectAll(),0<=b.findNearestPixel(e,d)&&(b.selectNearestPixel(e,d),a=b.getSelectedPixels()[0],d=b.getPixel(a),e=d.x,d=d.y),wpd.graphicsWidget.resetData(),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.updateZoomToImagePosn(e,d),wpd.dataPointCounter.setCount(),c.preventDefault(),
c.stopPropagation();return}b.setPixelAt(a,e,d);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e,d);c.preventDefault();c.stopPropagation()}}}}}();
wpd.EditLabelsTool=function(){this.onAttach=function(){document.getElementById("edit-data-labels").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onRemove=function(){document.getElementById("edit-data-labels").classList.remove("pressed-button");wpd.appData.getPlotData().getActiveDataSeries().unselectAll()};this.onMouseClick=function(c,b,a){b=wpd.appData.getPlotData().getActiveDataSeries();b.unselectAll();a=b.selectNearestPixel(a.x,a.y);0<=a&&(wpd.graphicsWidget.forceHandlerRepaint(),
wpd.graphicsWidget.updateZoomOnEvent(c),wpd.dataPointLabelEditor.show(b,a,this))};this.onKeyDown=function(c){wpd.acquireData.isToolSwitchKey(c.keyCode)&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(c.keyCode).toLowerCase())}};wpd.dataPointCounter=function(){return{setCount:function(){var c=document.getElementsByClassName("data-point-counter"),b;for(b=0;b<c.length;b++)c[b].innerHTML=wpd.appData.getPlotData().getActiveDataSeries().getCount()}}}();wpd=wpd||{};
wpd.dataMask=function(){function c(){var b=wpd.graphicsWidget.getAllContexts(),a=wpd.graphicsWidget.getImageSize(),b=b.oriDataCtx.getImageData(0,0,a.width,a.height),a=[],c,e=0,f=wpd.appData.getPlotData().getAutoDetector();for(c=0;c<b.data.length;c+=4)255===b.data[c]&&255===b.data[c+1]&&0===b.data[c+2]&&(a[e]=c/4,e++);f.mask=a}return{grabMask:c,markBox:function(){var b=new wpd.BoxMaskTool;wpd.graphicsWidget.setTool(b)},markPen:function(){var b=new wpd.PenMaskTool;wpd.graphicsWidget.setTool(b)},eraseMarks:function(){var b=
new wpd.EraseMaskTool;wpd.graphicsWidget.setTool(b)},viewMask:function(){var b=new wpd.ViewMaskTool;wpd.graphicsWidget.setTool(b)},clearMask:function(){wpd.graphicsWidget.resetData();c()}}}();
wpd.BoxMaskTool=function(){return function(){var c=!1,b,a,d=wpd.graphicsWidget.getAllContexts(),e,f,g=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(a.x,a.y,f.x-a.x,f.y-a.y)},h=function(f,g,h){!1!==c&&(clearTimeout(e),c=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,1)",d.dataCtx.fillRect(a.x,a.y,g.x-a.x,g.y-a.y),d.oriDataCtx.fillStyle="rgba(255,255,0,1)",d.oriDataCtx.fillRect(b.x,b.y,h.x-b.x,h.y-b.y))},k=null,l=null;this.onAttach=
function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("box-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button")};this.onMouseDown=function(d,e,f){!0!==c&&(c=!0,b=f,a=e)};this.onMouseMove=function(a,b,d){!1!==c&&(f=b,clearTimeout(e),e=setTimeout(g,2))};this.onMouseOut=function(a,b,d){!0===c&&(clearTimeout(e),k=b,l=d)};this.onDocumentMouseUp=function(a,b,c){null!=k&&null!=l?h(a,k,l):h(a,b,c);l=k=null};this.onMouseUp=
function(a,b,c){h(a,b,c)};this.onRemove=function(){document.getElementById("box-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.PenMaskTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),b=!1,a,d,e,f=function(){c.dataCtx.strokeStyle="rgba(255,255,0,1)";c.dataCtx.lineTo(d.x,d.y);c.dataCtx.stroke();c.oriDataCtx.strokeStyle="rgba(255,255,0,1)";c.oriDataCtx.lineTo(e.x,e.y);c.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("pen-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button");
wpd.toolbar.show("paintToolbar")};this.onMouseDown=function(a,d,e){!0!==b&&(a=parseInt(document.getElementById("paintThickness").value,10),b=!0,c.dataCtx.strokeStyle="rgba(255,255,0,1)",c.dataCtx.lineWidth=a*wpd.graphicsWidget.getZoomRatio(),c.dataCtx.beginPath(),c.dataCtx.moveTo(d.x,d.y),c.oriDataCtx.strokeStyle="rgba(255,255,0,1)",c.oriDataCtx.lineWidth=a,c.oriDataCtx.beginPath(),c.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(c,h,k){!1!==b&&(d=h,e=k,clearTimeout(a),a=setTimeout(f,2))};
this.onMouseUp=function(d,e,f){clearTimeout(a);c.dataCtx.closePath();c.dataCtx.lineWidth=1;c.oriDataCtx.closePath();c.oriDataCtx.lineWidth=1;b=!1};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onRemove=function(){document.getElementById("pen-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();
wpd.EraseMaskTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),b=!1,a,d,e,f=function(){c.dataCtx.globalCompositeOperation="destination-out";c.oriDataCtx.globalCompositeOperation="destination-out";c.dataCtx.strokeStyle="rgba(255,255,0,1)";c.dataCtx.lineTo(d.x,d.y);c.dataCtx.stroke();c.oriDataCtx.strokeStyle="rgba(255,255,0,1)";c.oriDataCtx.lineTo(e.x,e.y);c.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("erase-mask").classList.add("pressed-button");
document.getElementById("view-mask").classList.add("pressed-button");wpd.toolbar.show("eraseToolbar")};this.onMouseDown=function(a,d,e){!0!==b&&(a=parseInt(document.getElementById("eraseThickness").value,10),b=!0,c.dataCtx.globalCompositeOperation="destination-out",c.oriDataCtx.globalCompositeOperation="destination-out",c.dataCtx.strokeStyle="rgba(0,0,0,1)",c.dataCtx.lineWidth=a*wpd.graphicsWidget.getZoomRatio(),c.dataCtx.beginPath(),c.dataCtx.moveTo(d.x,d.y),c.oriDataCtx.strokeStyle="rgba(0,0,0,1)",
c.oriDataCtx.lineWidth=a,c.oriDataCtx.beginPath(),c.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(c,h,k){!1!==b&&(d=h,e=k,clearTimeout(a),a=setTimeout(f,2))};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onMouseUp=function(d,e,f){clearTimeout(a);c.dataCtx.closePath();c.dataCtx.lineWidth=1;c.oriDataCtx.closePath();c.oriDataCtx.lineWidth=1;c.dataCtx.globalCompositeOperation="source-over";c.oriDataCtx.globalCompositeOperation="source-over";b=!1};this.onRemove=function(){document.getElementById("erase-mask").classList.remove("pressed-button");
document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();wpd.ViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("view-mask").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.MaskPainter=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getAutoDetector(),a=function(){if(null!=b.mask&&0!==b.mask.length){var a=wpd.graphicsWidget.getImageSize();imgData=c.oriDataCtx.getImageData(0,0,a.width,a.height);for(a=0;a<b.mask.length;a++){var e=b.mask[a];imgData.data[4*e]=255;imgData.data[4*e+1]=255;imgData.data[4*e+2]=0;imgData.data[4*e+3]=255}c.oriDataCtx.putImageData(imgData,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}};
this.painterName="dataMaskPainter";this.onRedraw=function(){wpd.dataMask.grabMask();a()};this.onAttach=function(){wpd.graphicsWidget.resetData();a()}}}();wpd=wpd||{};
wpd.measurementModes={distance:{name:"distance",connectivity:2,addButtonId:"add-pair-button",deleteButtonId:"delete-pair-button",sidebarId:"measure-distances-sidebar",init:function(){var c=wpd.appData.getPlotData();null==c.distanceMeasurementData&&(c.distanceMeasurementData=new wpd.ConnectedPoints(2))},clear:function(){wpd.appData.getPlotData().distanceMeasurementData=new wpd.ConnectedPoints(2)},getData:function(){return wpd.appData.getPlotData().distanceMeasurementData},treePath:"/Measurements/Distance"},
angle:{name:"angle",connectivity:3,addButtonId:"add-angle-button",deleteButtonId:"delete-angle-button",sidebarId:"measure-angles-sidebar",init:function(){var c=wpd.appData.getPlotData();null==c.angleMeasurementData&&(c.angleMeasurementData=new wpd.ConnectedPoints(3))},clear:function(){wpd.appData.getPlotData().angleMeasurementData=new wpd.ConnectedPoints(3)},getData:function(){return wpd.appData.getPlotData().angleMeasurementData},treePath:"/Measurements/Angle"},openPath:{name:"open-path",connectivity:-1,
addButtonId:"add-open-path-button",deleteButtonId:"delete-open-path-button",sidebarId:"measure-open-path-sidebar",init:function(){var c=wpd.appData.getPlotData();null==c.openPathMeasurementData&&(c.openPathMeasurementData=new wpd.ConnectedPoints)},clear:function(){wpd.appData.getPlotData().openPathMeasurementData=new wpd.ConnectedPoints},getData:function(){return wpd.appData.getPlotData().openPathMeasurementData}},closedPath:{name:"closed-path",connectivity:-1,addButtonId:"add-closed-path-button",
deleteButtonId:"delete-closed-path-button",sidebarId:"measure-closed-path-sidebar",init:function(){var c=wpd.appData.getPlotData();null==c.closedPathMeasurementData&&(c.closedPathMeasurementData=new wpd.ConnectedPoints)},clear:function(){wpd.appData.getPlotData().closedPathMeasurementData=new wpd.ConnectedPoints},getData:function(){return wpd.appData.getPlotData().closedPathMeasurementData}}};
wpd.measurement=function(){var c;return{start:function(b){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();b.init();wpd.sidebar.show(b.sidebarId);wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(b));wpd.graphicsWidget.forceHandlerRepaint();c=b},addItem:function(){wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c))},deleteItem:function(){wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c))},clearAll:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();
c.clear()}}}();
wpd.AddMeasurementTool=function(){return function(c){var b=wpd.graphicsWidget.getAllContexts(),a=0,d=!0,e=[];this.onAttach=function(){document.getElementById(c.addButtonId).classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onRemove=function(){document.getElementById(c.addButtonId).classList.remove("pressed-button")};this.onKeyDown=function(a){wpd.keyCodes.isAlphabet(a.keyCode,"a")?(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c))):wpd.keyCodes.isAlphabet(a.keyCode,
"d")?(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c))):(wpd.keyCodes.isEnter(a.keyCode)||wpd.keyCodes.isEsc(a.keyCode))&&!0===d&&0>c.connectivity&&(d=!1,c.getData().addConnection(e),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c)))};this.onMouseClick=function(f,g,h){if(d){wpd.graphicsWidget.resetHover();e[2*a]=h.x;e[2*a+1]=h.y;a+=1;if(a===c.connectivity){d=!1;c.getData().addConnection(e);wpd.graphicsWidget.forceHandlerRepaint();
wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c));return}if(1<a){var k=wpd.graphicsWidget.screenPx(e[2*(a-2)],e[2*(a-2)+1]);b.dataCtx.beginPath();b.dataCtx.strokeStyle="rgb(0,0,10)";b.dataCtx.moveTo(k.x,k.y);b.dataCtx.lineTo(g.x,g.y);b.dataCtx.stroke();b.oriDataCtx.beginPath();b.oriDataCtx.strokeStyle="rgb(0,0,10)";b.oriDataCtx.moveTo(e[2*(a-2)],e[2*(a-2)+1]);b.oriDataCtx.lineTo(h.x,h.y);b.oriDataCtx.stroke()}b.dataCtx.beginPath();b.dataCtx.fillStyle="rgb(200, 0, 0)";b.dataCtx.arc(g.x,
g.y,3,0,2*Math.PI,!0);b.dataCtx.fill();b.oriDataCtx.beginPath();b.oriDataCtx.fillStyle="rgb(200,0,0)";b.oriDataCtx.arc(h.x,h.y,3,0,2*Math.PI,!0);b.oriDataCtx.fill()}wpd.graphicsWidget.updateZoomOnEvent(f)};this.onMouseMove=function(c,g,h){d&&1<=a&&(wpd.graphicsWidget.resetHover(),c=wpd.graphicsWidget.screenPx(e[2*(a-1)],e[2*(a-1)+1]),b.hoverCtx.beginPath(),b.hoverCtx.strokeStyle="rgb(0,0,0)",b.hoverCtx.moveTo(c.x,c.y),b.hoverCtx.lineTo(g.x,g.y),b.hoverCtx.stroke())}}}();
wpd.DeleteMeasurementTool=function(){return function(c){wpd.graphicsWidget.getAllContexts();wpd.appData.getPlotData();this.onAttach=function(){document.getElementById(c.deleteButtonId).classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onRemove=function(){document.getElementById(c.deleteButtonId).classList.remove("pressed-button")};this.onKeyDown=function(b){wpd.keyCodes.isAlphabet(b.keyCode,"a")?wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c)):
wpd.keyCodes.isAlphabet(b.keyCode,"d")&&wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c))};this.onMouseClick=function(b,a,d){c.getData().deleteNearestConnection(d.x,d.y);wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c));wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(b)}}}();
wpd.AdjustMeasurementTool=function(){return function(c){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onMouseClick=function(b,a,d){c.getData().selectNearestPoint(d.x,d.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(b)};this.onKeyDown=function(b){if(wpd.keyCodes.isAlphabet(b.keyCode,"a"))wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c));else if(wpd.keyCodes.isAlphabet(b.keyCode,"d"))wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c));
else{var a=c.getData(),d=a.getSelectedConnectionAndPoint();if(0<=d.connectionIndex&&0<=d.pointIndex){var e=!0===b.shiftKey?5/wpd.graphicsWidget.getZoomRatio():.5/wpd.graphicsWidget.getZoomRatio(),f=a.getPointAt(d.connectionIndex,d.pointIndex);if(wpd.keyCodes.isUp(b.keyCode))f.y-=e;else if(wpd.keyCodes.isDown(b.keyCode))f.y+=e;else if(wpd.keyCodes.isLeft(b.keyCode))f.x-=e;else if(wpd.keyCodes.isRight(b.keyCode))f.x+=e;else return;a.setPointAt(d.connectionIndex,d.pointIndex,f.x,f.y);wpd.graphicsWidget.forceHandlerRepaint();
wpd.graphicsWidget.updateZoomToImagePosn(f.x,f.y);b.preventDefault();b.stopPropagation()}}}}}();
wpd.MeasurementRepainter=function(){return function(c){var b=wpd.graphicsWidget.getAllContexts(),a=function(a,c,d,e,l,m,n,p){b.dataCtx.beginPath();b.dataCtx.strokeStyle="rgb(0,0,10)";b.dataCtx.moveTo(a,c);b.dataCtx.lineTo(d,e);b.dataCtx.stroke();b.oriDataCtx.beginPath();b.oriDataCtx.strokeStyle="rgb(0,0,10)";b.oriDataCtx.moveTo(l,m);b.oriDataCtx.lineTo(n,p);b.oriDataCtx.stroke()},d=function(a,c,d,e,l){b.dataCtx.beginPath();b.dataCtx.fillStyle=l?"rgb(0, 200, 0)":"rgb(200, 0, 0)";b.dataCtx.arc(a,c,
3,0,2*Math.PI,!0);b.dataCtx.fill();b.oriDataCtx.beginPath();b.oriDataCtx.fillStyle=l?"rgb(0,200,0)":"rgb(200,0,0)";b.oriDataCtx.arc(d,e,3,0,2*Math.PI,!0);b.oriDataCtx.fill()},e=function(a,c,d,e,l){a=parseInt(a,10);c=parseInt(c,10);d=parseInt(d,10);e=parseInt(e,10);b.dataCtx.font="14px sans-serif";var f=b.dataCtx.measureText(l).width;b.dataCtx.fillStyle="rgba(255, 255, 255, 0.7)";b.dataCtx.fillRect(a-5,c-15,f+10,25);b.dataCtx.fillStyle="rgb(200, 0, 0)";b.dataCtx.fillText(l,a,c);b.oriDataCtx.font="14px sans-serif";
f=b.oriDataCtx.measureText(l).width;b.oriDataCtx.fillStyle="rgba(255, 255, 255, 0.7)";b.oriDataCtx.fillRect(d-5,e-15,f+10,25);b.oriDataCtx.fillStyle="rgb(200, 0, 0)";b.oriDataCtx.fillText(l,d,e)};this.painterName="measurementRepainter-"+c.name;this.onAttach=function(){wpd.graphicsWidget.resetData()};this.onRedraw=function(){if(c.name===wpd.measurementModes.distance.name){var f=wpd.appData.getPlotData().distanceMeasurementData,g=f.connectionCount(),h,k=wpd.appData.getPlotData().axes;for(h=0;h<g;h++){var l=
f.getConnectionAt(h);var m=l[0];var n=l[1];var p=l[2];l=l[3];var r=f.isPointSelected(h,0);var t=f.isPointSelected(h,1);var u=!0===wpd.appData.isAligned()&&k instanceof wpd.MapAxes?"Dist"+h.toString()+": "+k.pixelToDataDistance(f.getDistance(h)).toFixed(2)+" "+k.getUnits():"Dist"+h.toString()+": "+f.getDistance(h).toFixed(2)+" px";var v=wpd.graphicsWidget.screenPx(m,n);var q=wpd.graphicsWidget.screenPx(p,l);a(v.x,v.y,q.x,q.y,m,n,p,l);d(v.x,v.y,m,n,r);d(q.x,q.y,p,l,t);e(.5*(v.x+q.x),.5*(v.y+q.y),.5*
(m+p),.5*(n+l),u)}}else if(c.name===wpd.measurementModes.angle.name){var f=wpd.appData.getPlotData().angleMeasurementData,g=f.connectionCount();for(h=0;h<g;h++){p=f.getConnectionAt(h);q=p[0];u=p[1];m=p[2];n=p[3];r=p[4];t=p[5];var w=f.isPointSelected(h,0);var z=f.isPointSelected(h,1);var A=f.isPointSelected(h,2);k="Theta"+h.toString()+": "+f.getAngle(h).toFixed(2)+"\u00b0";v=Math.atan2(u-n,q-m);l=Math.atan2(t-n,r-m);var x=wpd.graphicsWidget.screenPx(q,u);p=wpd.graphicsWidget.screenPx(m,n);var B=wpd.graphicsWidget.screenPx(r,
t);a(x.x,x.y,p.x,p.y,q,u,m,n);a(p.x,p.y,B.x,B.y,m,n,r,t);d(x.x,x.y,q,u,w);d(p.x,p.y,m,n,z);d(B.x,B.y,r,t,A);q=p.x;u=p.y;r=m;t=n;b.dataCtx.beginPath();b.dataCtx.strokeStyle="rgb(0,0,10)";b.dataCtx.arc(q,u,15,v,l,!0);b.dataCtx.stroke();b.oriDataCtx.beginPath();b.oriDataCtx.strokeStyle="rgb(0,0,10)";b.oriDataCtx.arc(r,t,15,v,l,!0);b.oriDataCtx.stroke();e(p.x+10,p.y+15,m+10,n+15,k)}}};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()}}}();wpd=wpd||{};
wpd.perspective=function(){return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();wpd.popup.show("perspective-info")},pickCorners:function(){},run:function(){},revert:function(){}}}();wpd.perspectiveCornersRepainter=function(){this.painterName="perspectiveCornersRepainter";this.onRedraw=function(){}};wpd.perspectiveCornersTool=function(){this.onAttach=function(){};this.onMouseDown=function(){};this.onRemove=function(){}};
wpd=wpd||{};wpd.ajax=function(){return{get:function(c,b){if(null!=b){var a=new XMLHttpRequest;a.onload=function(c){200===this.status&&b(a)};a.open("GET",c,!0);a.send()}},post:function(c,b,a){if(null!=a){var d=new XMLHttpRequest;d.onload=function(b){200===this.status&&a(d)};d.open("POST",c,!0);d.setRequestHeader("Content-type","application/json");d.send(b)}}}}();wpd=wpd||{};
wpd.args=function(){return{getValue:function(c){var b,a=window.location.search.substring(1).split("&");for(b=0;b<a.length;b++){var d=a[b].split("=");if(d[0]===c)return unescape(d[1])}return null}}}();wpd=wpd||{};
wpd.dataExport=function(){return{show:function(){},generateCSV:function(){wpd.popup.close("export-all-data-popup");var c=wpd.appData.getPlotData(),b=c.axes,a=c.dataSeriesColl,d;if(null==b||null==a||0===a.length)wpd.messagePopup.show(wpd.gettext("no-datasets-to-export-error"),wpd.gettext("no-datasets-to-export"));else{for(var e=b.getAxesLabels(),f=e.length,g=a.length*f,h=0,k,l=[],m=[],n=[],c=0;c<a.length;c++)for(k=a[c].getCount(),k>h&&(h=k),l.push(a[c].name),d=0;d<f;d++)0!==d&&l.push(""),m.push(e[d]);
for(c=0;c<h;c++){k=[];for(d=0;d<g;d++)k.push("");n.push(k)}for(c=0;c<a.length;c++)for(k=a[c].getCount(),d=0;d<k;d++){var e=a[c].getPixel(d),p=d,g=b,r=e,e=g.pixelToData(r.x,r.y);if(g instanceof wpd.XYAxes)for(p=0;1>=p;p++)g.isDate(p)&&(r=g.getInitialDateFormat(p),e[p]=wpd.dateConverter.formatDateNumber(e[p],r));else g instanceof wpd.BarAxes&&(e=["",e[0]],e[0]=null==r.metadata?"Bar"+p:r.metadata[0]);g=e;for(e=0;e<f;e++)n[d][c*f+e]=g[e]}b=l.join(",")+"\n"+m.join(",")+"\n";for(c=0;c<h;c++)b+=n[c].join(",")+
"\n";wpd.download.csv(b,"wpd_datasets")}},exportToPlotly:function(){wpd.popup.close("export-all-data-popup");var c=wpd.appData.getPlotData(),b=c.dataSeriesColl,a,d,e=wpd.plotDataProvider,f={data:[]};if(null==c.axes||null==b||0===b.length)wpd.messagePopup.show(wpd.gettext("no-datasets-to-export-error"),wpd.gettext("no-datasets-to-export"));else{for(c=0;c<b.length;c++){e.setDatasetIndex(c);var g=e.getData();f.data[c]={};for(a=0;2>a;a++){var h=0===a?"x":"y";f.data[c][h]=[];for(d=0;d<g.rawData.length;d++)f.data[c][h][d]=
null!=g.fieldDateFormat[a]?wpd.dateConverter(g.rawData[d][a],"yyyy-mm-dd"):g.rawData[d][a]}}wpd.plotly.send(f)}}}}();wpd=wpd||{};
wpd.download=function(){function c(b,a,c){var d=document.createElement("div");var f=document.createElement("form");var g=document.createElement("textarea");var h=document.createElement("input");h.type="hidden";f.setAttribute("method","post");"json"===c?f.setAttribute("action","internal/download/json"):"csv"===c&&f.setAttribute("action","internal/download/csv");g.setAttribute("name","data");g.setAttribute("id","data");h.setAttribute("name","filename");h.setAttribute("id","filename");h.value=a.replace(/[^a-zA-Z\d+\.\-_\s]/g,
"_");f.appendChild(g);f.appendChild(h);d.appendChild(f);document.body.appendChild(d);d.style.display="none";g.innerHTML=b;f.submit();document.body.removeChild(d)}return{json:function(b,a){null==a&&(a="wpd_plot_data");c(b,a,"json")},csv:function(b,a){null==a&&(a="data");c(b,a,"csv")}}}();wpd=wpd||{};wpd.gettext=function(c){return(c=document.getElementById("i18n-string-"+c))?c.innerHTML:"i18n string"};wpd=wpd||{};
wpd.plotly=function(){return{send:function(c){var b=document.createElement("div"),a=document.createElement("form"),d=document.createElement("textarea");a.setAttribute("method","post");a.setAttribute("action","https://plot.ly/external");a.setAttribute("target","_blank");d.setAttribute("name","data");d.setAttribute("id","data");a.appendChild(d);b.appendChild(a);document.body.appendChild(b);b.style.display="none";c=JSON.stringify(c);d.innerHTML=c;a.submit();document.body.removeChild(b)}}}();
wpd=wpd||{};
wpd.saveResume=function(){function c(a){var b=wpd.appData.getPlotData();a=a.wpd;var c;b.reset();wpd.appData.isAligned(!1);if(null!=a.axesType&&("ImageAxes"===a.axesType||null!=a.calibration&&null!=a.axesParameters)){if("ImageAxes"!==a.axesType){var f="TernaryAxes"===a.axesType?new wpd.Calibration(3):new wpd.Calibration(2);for(c=0;c<a.calibration.length;c++)f.addPoint(a.calibration[c].px,a.calibration[c].py,a.calibration[c].dx,a.calibration[c].dy,a.calibration[c].dz);b.calibration=f}if("XYAxes"===a.axesType){if(b.axes=
new wpd.XYAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isLogX,a.axesParameters.isLogY))return}else if("BarAxes"===a.axesType){if(b.axes=new wpd.BarAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isLog))return}else if("PolarAxes"===a.axesType){if(b.axes=new wpd.PolarAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isDegrees,a.axesParameters.isClockwise))return}else if("TernaryAxes"===a.axesType){if(b.axes=new wpd.TernaryAxes,!b.axes.calibrate(b.calibration,a.axesParameters.isRange100,
a.axesParameters.isNormalOrientation))return}else if("MapAxes"===a.axesType){if(b.axes=new wpd.MapAxes,!b.axes.calibrate(b.calibration,a.axesParameters.scaleLength,a.axesParameters.unitString))return}else"ImageAxes"===a.axesType&&(b.axes=new wpd.ImageAxes);wpd.appData.isAligned(!0);if(null!=a.dataSeries){for(c=0;c<a.dataSeries.length;c++){var g=a.dataSeries[c];b.dataSeriesColl[c]=new wpd.DataSeries;var h=b.dataSeriesColl[c];h.name=g.name;null!=g.metadataKeys&&h.setMetadataKeys(g.metadataKeys);for(f=
0;f<g.data.length;f++)h.addPixel(g.data[f].x,g.data[f].y,g.data[f].metadata)}if(null!=a.distanceMeasurementData)for(b.distanceMeasurementData=new wpd.ConnectedPoints(2),c=0;c<a.distanceMeasurementData.length;c++)b.distanceMeasurementData.addConnection(a.distanceMeasurementData[c]);if(null!=a.angleMeasurementData)for(b.angleMeasurementData=new wpd.ConnectedPoints(3),c=0;c<a.angleMeasurementData.length;c++)b.angleMeasurementData.addConnection(a.angleMeasurementData[c])}}}function b(){var a=wpd.appData.getPlotData(),
b=a.calibration,c={wpd:{version:[3,8],axesType:null,axesParameters:null,calibration:null,dataSeries:[],distanceMeasurementData:null,angleMeasurementData:null}},f;if(null!=b)for(c.wpd.calibration=[],f=0;f<b.getCount();f++)c.wpd.calibration[f]=b.getPoint(f);null!=a.axes&&(a.axes instanceof wpd.XYAxes?(c.wpd.axesType="XYAxes",c.wpd.axesParameters={isLogX:a.axes.isLogX(),isLogY:a.axes.isLogY()}):a.axes instanceof wpd.BarAxes?(c.wpd.axesType="BarAxes",c.wpd.axesParameters={isLog:a.axes.isLog()}):a.axes instanceof
wpd.PolarAxes?(c.wpd.axesType="PolarAxes",c.wpd.axesParameters={isDegrees:a.axes.isThetaDegrees(),isClockwise:a.axes.isThetaClockwise()}):a.axes instanceof wpd.TernaryAxes?(c.wpd.axesType="TernaryAxes",c.wpd.axesParameters={isRange100:a.axes.isRange100(),isNormalOrientation:a.axes.isNormalOrientation()}):a.axes instanceof wpd.MapAxes?(c.wpd.axesType="MapAxes",c.wpd.axesParameters={scaleLength:a.axes.getScaleLength(),unitString:a.axes.getUnits()}):a.axes instanceof wpd.ImageAxes&&(c.wpd.axesType="ImageAxes"));
for(f=0;f<a.dataSeriesColl.length;f++){b=a.dataSeriesColl[f];c.wpd.dataSeries[f]={name:b.name,data:[]};var g=b.getMetadataKeys();null!=g&&(c.wpd.dataSeries[f].metadataKeys=g);for(g=0;g<b.getCount();g++){var h=b.getPixel(g);c.wpd.dataSeries[f].data[g]=h;c.wpd.dataSeries[f].data[g].value=a.axes.pixelToData(h.x,h.y)}}if(null!=a.distanceMeasurementData)for(c.wpd.distanceMeasurementData=[],f=0;f<a.distanceMeasurementData.connectionCount();f++)c.wpd.distanceMeasurementData[f]=a.distanceMeasurementData.getConnectionAt(f);
if(null!=a.angleMeasurementData)for(c.wpd.angleMeasurementData=[],f=0;f<a.angleMeasurementData.connectionCount();f++)c.wpd.angleMeasurementData[f]=a.angleMeasurementData.getConnectionAt(f);return JSON.stringify(c)}return{save:function(){wpd.popup.show("export-json-window")},load:function(){wpd.popup.show("import-json-window")},download:function(){wpd.download.json(b());wpd.popup.close("export-json-window")},read:function(){var a=document.getElementById("import-json-file");wpd.popup.close("import-json-window");
if(1===a.files.length){var b=new FileReader;b.onload=function(){var a=JSON.parse(b.result);c(a);wpd.graphicsWidget.resetData();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.appData.isAligned()&&wpd.acquireData.load();wpd.messagePopup.show(wpd.gettext("import-json"),wpd.gettext("json-data-loaded"))};b.readAsText(a.files[0])}}}}();wpd=wpd||{};
wpd.scriptInjector=function(){return{start:function(){wpd.popup.show("runScriptPopup")},cancel:function(){wpd.popup.close("runScriptPopup")},load:function(){var c=document.getElementById("runScriptFileInput");wpd.popup.close("runScriptPopup");if(1==c.files.length){var b=new FileReader;b.onload=function(){"undefined"!==typeof wpdscript&&(wpdscript=null);eval(b.result);"wpdscript"!==typeof wpdscript&&(window.wpdscript=wpdscript,wpdscript.run())};b.readAsText(c.files[0])}}}}();wpd=wpd||{};
wpd.websocket=function(){function c(){e=!0}function b(){e=!1;f={}}function a(a){if(null!=a.data)if(console.log(a.data),a=JSON.parse(a.data),null!=a){var b=f[a.timestamp];null!=b&&b.requestId===a.id&&(b.callback(a.message),delete f[a.timestamp])}else alert("Server announcement: "+a),console.log(a)}var d,e,f={};return{connect:function(e){d=new WebSocket(e);d.onopen=c;d.onmessage=a;d.onclose=b},registerRequest:function(a,b){},registerNotification:function(a,b){},request:function(a,b,c){var g=Date.now();
b=JSON.stringify({type:"request",timestamp:g,id:a,message:b});f[g]={requestId:a,callback:c};e&&(console.log(b),d.send(b))},notify:function(a,b){var c=Date.now();a=JSON.stringify({type:"notification",timestamp:c,id:a,message:b});e&&(console.log(a),d.send(a))}}}();wpd=wpd||{};wpd.browserInfo=function(){return{checkBrowser:function(){window.FileReader||alert("\tWARNING!\nYour web browser is not supported. This program might not behave as intended. Please use a recent version of Google Chrome, Firefox or Safari browser.")}}}();

var wpd=wpd||{};wpd.initApp=function(){wpd.browserInfo.checkBrowser();wpd.layoutManager.initialLayout();wpd.graphicsWidget.loadImageFromURL("start.png");document.getElementById("loadingCurtain").style.display="none"};document.addEventListener("DOMContentLoaded",wpd.initApp,!0);wpd=wpd||{};wpd.detectionAlgoManager=function(){return{setActiveAlgo:function(a){},getActiveAlgo:function(){return null},getAllApplicableAlgorithms:function(){}}}();wpd=wpd||{};
wpd.appData=function(){var a=!1,c;return{isAligned:function(c){null!=c&&(a=c);return a},getPlotData:function(){null==c&&(c=new wpd.PlotData);return c},reset:function(){a=!1;c=null}}}();wpd=wpd||{};
wpd.AutoDetector=function(){return function(){this.fgColor=[0,0,200];this.bgColor=[255,255,255];this.mask=null;this.colorDetectionMode="fg";this.colorDistance=120;this.imageData=this.binaryData=this.algorithm=null;this.imageHeight=this.imageWidth=0;this.generateBinaryData=function(){if(null!=this.mask&&0!==this.mask.length){this.binaryData=[];var a,c,d,b="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(a=0;a<this.mask.length;a++)c=this.mask[a],d=Math.sqrt((this.imageData.data[4*c]-b[0])*
(this.imageData.data[4*c]-b[0])+(this.imageData.data[4*c+1]-b[1])*(this.imageData.data[4*c+1]-b[1])+(this.imageData.data[4*c+2]-b[2])*(this.imageData.data[4*c+2]-b[2])),"fg"===this.colorDetectionMode?d<=this.colorDistance&&(this.binaryData[c]=!0):d>=this.colorDistance&&(this.binaryData[c]=!0)}}}}();wpd=wpd||{};wpd.dataEventNames={axesAligned:"axesAligned",imageLoaded:"imageLoaded"};
wpd.dataEventManager=function(){return{fireEvent:function(a,c){},subscribe:function(a,c){},unsubscribe:function(a,c){},removeAllSubscriptionsForEvent:function(a){}}}();wpd=wpd||{};
wpd.Calibration=function(){return function(a){var c=[],d=[],b=null==a?2:a,e=[],f=[];this.labels=[];this.getCount=function(){return c.length};this.getDimensions=function(){return b};this.addPoint=function(a,f,k,l,n){var m=c.length,q=e.length;c[m]=a;d[m]=f;e[q]=k;e[q+1]=l;3===b&&(e[q+2]=n)};this.getPoint=function(a){return 0>a||a>=c.length?null:{px:c[a],py:d[a],dx:e[b*a],dy:e[b*a+1],dz:2===b?null:e[b*a+2]}};this.changePointPx=function(a,b,e){0>a||a>=c.length||(c[a]=b,d[a]=e)};this.setDataAt=function(a,
d,f,l){0>a||a>=c.length||(e[b*a]=d,e[b*a+1]=f,3===b&&(e[b*a+2]=l))};this.findNearestPoint=function(a,b,e){e=null==e?50:parseFloat(e);var f,n=-1,m,q;for(m=0;m<c.length;m++)if(q=Math.sqrt((a-c[m])*(a-c[m])+(b-d[m])*(b-d[m])),0>n&&q<=e||0<=n&&q<f)n=m,f=q;return n};this.selectPoint=function(a){0>f.indexOf(a)&&(f[f.length]=a)};this.selectNearestPoint=function(a,c,b){a=this.findNearestPoint(a,c,b);0<=a&&this.selectPoint(a)};this.getSelectedPoints=function(){return f};this.unselectAll=function(){f=[]};this.isPointSelected=
function(a){return 0<=f.indexOf(a)};this.dump=function(){console.log(c);console.log(d);console.log(e)}}}();
wpd.DataSeries=function(){return function(a){var c=[],d=[];this.name="Data Series";this.variableNames=["x","y"];this.addPixel=function(a,d){var f=c.length;c[f]=a;c[f+1]=d};this.getPixel=function(a){return{x:c[2*a],y:c[2*a+1]}};this.setPixelAt=function(a,d,f){2*a<c.length&&(c[2*a]=d,c[2*a+1]=f)};this.insertPixel=function(a,d,f){c.splice(2*a,0,d);c.splice(2*a+1,0,f)};this.removePixelAtIndex=function(a){2*a<c.length&&c.splice(2*a,2)};this.removeLastPixel=function(){this.removePixelAtIndex(c.length/2-
1)};this.findNearestPixel=function(a,d,f){f=null==f?50:parseFloat(f);var g,h=-1,k,l;for(k=0;k<c.length;k+=2)if(l=Math.sqrt((a-c[k])*(a-c[k])+(d-c[k+1])*(d-c[k+1])),0>h&&l<=f||0<=h&&l<g)h=k/2,g=l;return h};this.removeNearestPixel=function(a,c,d){a=this.findNearestPixel(a,c,d);0<=a&&this.removePixelAtIndex(a)};this.clearAll=function(){c=[]};this.getCount=function(){return c.length/2};this.selectPixel=function(a){0<=d.indexOf(a)||(d[d.length]=a)};this.unselectAll=function(){d=[]};this.selectNearestPixel=
function(a,c,d){a=this.findNearestPixel(a,c,d);0<=a&&this.selectPixel(a)};this.getSelectedPixels=function(){return d}}}();
wpd.PlotData=function(){return function(){var a=0,c=new wpd.AutoDetector;this.axes=null;this.dataSeriesColl=[];this.getActiveDataSeries=function(){null==this.dataSeriesColl[a]&&(this.dataSeriesColl[a]=new wpd.DataSeries);return this.dataSeriesColl[a]};this.getDataSeriesCount=function(){return this.dataSeriesColl.length};this.setActiveDataSeriesIndex=function(c){a=c};this.getAutoDetector=function(){return c};this.getDataFromActiveSeries=function(){if(null==this.dataSeriesColl[a]||null==this.axes)return null;
var c,b,e=[],f;for(c=0;c<this.dataSeriesColl[a].getCount();c++)for(b=this.dataSeriesColl[a].getPixel(c),b=this.axes.pixelToData(b.x,b.y),e[c]=[],f=0;f<b.length;f++)e[c][f]=b[f];return e};this.reset=function(){this.axes=null;this.dataSeriesColl=[];a=0;c=new wpd.AutoDetector}}}();
wpd.ConnectedPoints=function(){return function(a){var c=[];this.addConnection=function(a){c[c.length]=a};this.clearAll=function(){c=[]};this.getConnectionAt=function(a){if(a<c.length)return c[a]};this.replaceConnectionAt=function(a,b){a<c.length&&(c[a]=b)};this.deleteConnectionAt=function(a){a<c.length&&c.splice(a,1)};this.connectionCount=function(){return c.length};this.getDistance=function(d){if(d<c.length&&2===a)return Math.sqrt((c[d][0]-c[d][2])*(c[d][0]-c[d][2])+(c[d][1]-c[d][3])*(c[d][1]-c[d][3]))};
this.getAngle=function(d,b){if(d<c.length&&3===a){var e=wpd.taninverse(c[d][3]-c[d][1],c[d][2]-c[d][0]);b&&(e=180*e/Math.PI);return e}}}}();wpd=wpd||{};
wpd.dateConverter=function(){function a(a,d){var b;b=d.replace("YYYY","yyyy");b=b.replace("YY","yy");b=b.replace("MMMM","mmmm");b=b.replace("MMM","mmm");b=b.replace("MM","mm");b=b.replace("DD","dd");b=b.replace("yyyy",a.getUTCFullYear());var e=a.getUTCFullYear()%100;b=b.replace("yy",10>e?"0"+e:e);b=b.replace("mmmm","January February March April May June July August September October November December".split(" ")[a.getUTCMonth()]);b=b.replace("mmm","Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]);
b=b.replace("mm",a.getUTCMonth()+1);return b=b.replace("dd",a.getUTCDate())}return{parse:function(a){if(null==a||0>a.indexOf("/"))a=null;else{var d=a.split("/"),b;0>=d.length||3<d.length?a=null:(a=parseInt(d[0],10),b=parseInt(void 0===d[1]?0:d[1],10),date=parseInt(void 0===d[2]?1:d[2],10),isNaN(a)||isNaN(b)||isNaN(date)||12<b||1>b||31<date||1>date?a=null:(d=new Date,d.setUTCFullYear(a),d.setUTCMonth(b-1),d.setUTCDate(date),a=parseFloat(Date.parse(d)),a=isNaN(a)?null:a))}return a},getFormatString:function(a){a=
a.split("/");var d="yyyy/mm/dd";1<=a.length&&(d="yyyy");2<=a.length&&(d+="/mm");3===a.length&&(d+="/dd");return d},formatDate:a,formatDateNumber:function(c,d){var b;b=parseFloat(c);b=parseInt(864E5*Math.round(b/864E5),10);return a(new Date(b),d)}}}();wpd=wpd||{};
wpd.InputParser=function(){return function(){this.parse=function(a){this.isDate=this.isValid=!1;this.formatting=null;if(null==a)return null;a=a.trim();if(0<=a.indexOf("^"))return null;var c=wpd.dateConverter.parse(a);if(null!=c)return this.isDate=this.isValid=!0,this.formatting=wpd.dateConverter.getFormatString(a),c;a=parseFloat(a);return isNaN(a)?null:(this.isValid=!0,a)};this.isDate=this.isValid=!1;this.formatting=null}}();wpd=wpd||{};
wpd.taninverse=function(a,c){var d;0<a?d=Math.atan2(a,c):0>=a&&(d=Math.atan2(a,c)+2*Math.PI);d>=2*Math.PI&&(d=0);return d};wpd=wpd||{};
wpd.AveragingWindowAlgo=function(){return function(){var a=5,c=5;this.getParamList=function(){return[["\u0394X","Px",5],["\u0394Y","Px",5]]};this.setParam=function(d,b){0===d?a=b:1===d&&(c=b)};this.run=function(d){var b=d.getAutoDetector();d=d.getActiveDataSeries();var e=[],f=0,g=b.imageWidth,h=b.imageHeight,k=[],l,n,m,q,r,p;d.clearAll();for(l=0;l<g;l++){r=-1;m=-2*c;for(n=q=0;n<h;n++)!0===b.binaryData[n*g+l]&&(n>m+c?(r+=1,q=1,m=k[r]=n):(q+=1,k[r]=parseFloat((k[r]*(q-1)+n)/parseFloat(q))));if(0<=r)for(m=
l,n=0;n<=r;n++)q=k[n],e[f]=[],e[f][0]=parseFloat(m),e[f][1]=parseFloat(q),e[f][2]=!0,f+=1}if(0!==f)for(b=0;b<f;b++)if(!0===e[b][2]){g=!0;h=b+1;k=e[b][0];l=e[b][1];r=k;n=l;for(p=1;!0===g&&h<f;)m=e[h][0],q=e[h][1],Math.abs(m-k)<=a&&Math.abs(q-l)<=c&&!0===e[h][2]&&(r=(r*p+m)/(p+1),n=(n*p+q)/(p+1),p+=1,e[h][2]=!1),m>k+2*a&&(g=!1),h+=1;e[b][2]=!1;d.addPixel(parseFloat(r),parseFloat(n))}}}}();
var averagingWindowWithStepSizeAlgo={getParamList:function(){if("XY"===plotType)return[["X_min","Units",axesAlignmentData[0].toString()],["\u0394X Step","Units","0.1"],["X_max","Units",axesAlignmentData[1].toString()],["Y_min","Units",axesAlignmentData[2].toString()],["Y_max","Units",axesAlignmentData[3].toString()],["Line width","Px","30"]];closePopup("testImageWindow");showPopup("xyAxesOnly");return[["X_min","Units","0"],["\u0394X Step","Units","0.1"],["X_max","Units","0"],["Y_min","Units","0"],
["Y_max","Units","0"],["Line width","Px","30"]]},run:function(){if("XY"===plotType){xyData=[];pointsPicked=0;resetLayers();for(var a=canvasWidth,c=canvasHeight,d=document.getElementById("pv0"),b=document.getElementById("pv1"),e=document.getElementById("pv2"),f=document.getElementById("pv5"),g=document.getElementById("pv3"),h=document.getElementById("pv4"),d=parseFloat(d.value),b=parseFloat(b.value),e=parseFloat(e.value),f=parseFloat(f.value),g=parseFloat(g.value),h=parseFloat(h.value);d<=e;d+=b){var k,
l,n,m;dataToPixel(d,g,"XY");k=dataToPixelxy[0];n=dataToPixelxy[1];dataToPixel(d,h,"XY");l=dataToPixelxy[0];m=dataToPixelxy[1];k=Math.sqrt((m-n)*(m-n)+(l-k)*(l-k));l=(h-g)/k;n=!1;for(var q=m=0,r=!1,p=0;p<=k;p++)dataToPixel(d,1*-p*l+h,"XY"),xi_pix=dataToPixelxy[0],yi_pix=dataToPixelxy[1],0<=xi_pix&&xi_pix<a&&0<=yi_pix&&yi_pix<c&&(!0===binaryData[parseInt(yi_pix,10)][parseInt(xi_pix,10)]?(!1===n&&(q=m=p,n=!0,r=!1),!0===r&&(q=p,r=!1)):!1===r&&(q=p,r=!0),!0===n&&(p>m+f||p==k-1)&&(n=!1,m>q&&(q=p),dataToPixel(d,
1*-((m+q)/2)*l+h,"XY"),xyData[pointsPicked]=[],xyData[pointsPicked][0]=parseFloat(dataToPixelxy[0]),xyData[pointsPicked][1]=parseFloat(dataToPixelxy[1]),pointsPicked+=1))}}else showPopup("xyAxesOnly")}},blobDetectorAlgo={getParamList:function(){return[["Min size","Px","0"],["Max size","Px","1000"]]},run:function(){xyData=[];pointsPicked=0;for(var a=document.getElementById("pv0").value,c=document.getElementById("pv1").value,d=[],b=0;b<canvasHeight;b++){d[b]=[];for(var e=0;e<canvasWidth;e++)d[b][e]=
!1}for(var b=0,e=[],f=[],g=[],h=[],k=[],l=0;l<canvasHeight;l++)for(var n=0;n<canvasWidth;n++){if(!0===binaryData[l][n]&&!1===d[l][n]){d[l][n]=!0;b+=1;e[b-1]=1;h[b-1]=[];k[b-1]=[];h[b-1][0]=n;k[b-1][0]=l;f[b-1]=n;g[b-1]=l;for(var m=1,q=1;m<=q;){ai=k[b-1][m-1];bi=h[b-1][m-1];for(var r=-1;1>=r;r++)for(var p=-1;1>=p;p++)0<=ai+r&&0<=bi+p&&ai+r<canvasHeight&&bi+p<canvasWidth&&!0==binaryData[ai+r][bi+p]&&!1==d[ai+r][bi+p]&&(e[b-1]+=1,q=e[b-1],k[b-1][q-1]=ai+r,h[b-1][q-1]=bi+p,g[b-1]=(g[b-1]*(q-1)+(ai+r))/
q,f[b-1]=(f[b-1]*(q-1)+(bi+p))/q,d[ai+r][bi+p]=!0);m+=1}}d[l][n]=!0}for(d=0;d<b;d++)h=2*Math.sqrt(e[d]/Math.PI),h>=a&&h<=c&&(xyData[pointsPicked]=[],xyData[pointsPicked][0]=parseFloat(f[d]),xyData[pointsPicked][1]=parseFloat(g[d]),xyData[pointsPicked][2]=e[d],pointsPicked+=1)}},xStepAlgo={getParamList:function(){return[["\u0394X","Px","5"],["Line Width","Px","15"]]},run:function(){xyData=[];pointsPicked=0;resetLayers();for(var a=document.getElementById("pv0"),a=parseFloat(a.value),c=document.getElementById("pv1"),
c=parseFloat(c.value),d=canvasWidth,b=canvasHeight,e=[],f=1,g=0;g<d;){blobs=-1;firstbloby=-2*c;for(var h=bi=0;h<b;h++)!0===binaryData[h][g]&&(f=a,h>firstbloby+c?(blobs+=1,bi=1,firstbloby=e[blobs]=h):(bi+=1,e[blobs]=parseFloat((e[blobs]*(bi-1)+h)/parseFloat(bi))));if(0<=blobs)for(xi=g,h=0;h<=blobs;h++)yi=e[h],xyData[pointsPicked]=[],xyData[pointsPicked][0]=parseFloat(xi),xyData[pointsPicked][1]=parseFloat(yi),pointsPicked+=1;g+=f}}},yStepAlgo={getParamList:function(){return[["\u0394Y","Px","5"],["Line Width",
"Px","15"]]},run:function(){xyData=[];pointsPicked=0;resetLayers();for(var a=document.getElementById("pv0"),a=parseFloat(a.value),c=document.getElementById("pv1"),c=parseFloat(c.value),d=canvasWidth,b=[],e=-1,f=canvasHeight-1;0<=f;){blobs=-1;firstblobx=-2*c;for(var g=bi=0;g<d;g++)!0===binaryData[f][g]&&(e=-a,g>firstblobx+c?(blobs+=1,bi=1,firstblobx=b[blobs]=g):(bi+=1,b[blobs]=parseFloat((b[blobs]*(bi-1)+g)/parseFloat(bi))));if(0<=blobs)for(yi=f,g=0;g<=blobs;g++)xi=b[g],xyData[pointsPicked]=[],xyData[pointsPicked][0]=
parseFloat(xi),xyData[pointsPicked][1]=parseFloat(yi),pointsPicked+=1;f+=e}}},wpd=wpd||{};
wpd.ImageAxes=function(){var a=function(){this.isCalibrated=function(){return!0};this.calibrate=function(){return!0};this.pixelToData=function(a,d){return[a,d]};this.dataToPixel=function(a,d){return{x:a,y:d}};this.pixelToLiveString=function(a,d){var b=this.pixelToData(a,d);return b[0].toFixed(2)+", "+b[1].toFixed(2)}};a.prototype.numCalibrationPointsRequired=function(){return 0};a.prototype.getDimensions=function(){return 2};return a}();wpd=wpd||{};
wpd.MapAxes=function(){var a=function(){var a=!1,d,b;this.isCalibrated=function(){return a};this.calibrate=function(e,f){var g=e.getPoint(0),h=e.getPoint(1);b=Math.sqrt((g.px-h.px)*(g.px-h.px)+(g.py-h.py)*(g.py-h.py));d=parseFloat(f);return a=!0};this.pixelToData=function(a,c){var g=[];g[0]=a*d/b;g[1]=c*d/b;return g};this.dataToPixel=function(a,c,b){return{x:0,y:0}};this.pixelToLiveString=function(a,c){var b=this.pixelToData(a,c);return b[0].toExponential(4)+", "+b[1].toExponential(4)}};a.prototype.numCalibrationPointsRequired=
function(){return 2};a.prototype.getDimensions=function(){return 2};return a}();wpd=wpd||{};
wpd.PolarAxes=function(){var a=function(){var a=!1,d=!1,b,e,f,g,h,k,l,n,m,q,r,p,s,v;processCalibration=function(a,c,w){w=a.getPoint(0);var A=a.getPoint(1);a=a.getPoint(2);b=w.px;e=w.py;f=A.px;g=A.py;h=a.px;k=a.py;l=A.dx;n=A.dy;m=a.dx;d=c;!0===d&&(n*=Math.PI/180);q=Math.sqrt((f-b)*(f-b)+(g-e)*(g-e));r=Math.sqrt((h-b)*(h-b)+(k-e)*(k-e));p=r-q;s=wpd.taninverse(-(g-e),f-b);v=s-n;return!0};this.isCalibrated=function(){return a};this.calibrate=function(b,d,e){return a=processCalibration(b,d,e)};this.pixelToData=
function(a,c){var g=[],f,k;xp=parseFloat(a);yp=parseFloat(c);f=(m-l)/p*(Math.sqrt((xp-b)*(xp-b)+(yp-e)*(yp-e))-q)+l;k=wpd.taninverse(-(yp-e),xp-b)-v;!0==d&&(k=180*k/Math.PI);g[0]=f;g[1]=k;return g};this.dataToPixel=function(a,c){return{x:0,y:0}};this.pixelToLiveString=function(a,c){var b=this.pixelToData(a,c);return b[0].toExponential(4)+", "+b[1].toExponential(4)}};a.prototype.numCalibrationPointsRequired=function(){return 3};a.prototype.getDimensions=function(){return 2};return a}();wpd=wpd||{};
wpd.TernaryAxes=function(){var a=function(){var a=!1,d,b,e,f,g,h,k,l,n;this.isCalibrated=function(){return a};this.calibrate=function(m,q,r){var p=m.getPoint(0),s=m.getPoint(1);m.getPoint(2);d=p.px;b=p.py;e=s.px;f=s.py;g=Math.sqrt((d-e)*(d-e)+(b-f)*(b-f));h=wpd.taninverse(-(f-b),e-d);k=Math.sqrt(3);l=q;n=r;return a=!0};this.pixelToData=function(a,c){var e=[],f,s,v,G;xp=parseFloat(a);yp=parseFloat(c);f=Math.sqrt((xp-d)*(xp-d)+(yp-b)*(yp-b));s=wpd.taninverse(-(yp-b),xp-d)-h;v=f*Math.cos(s)/g;s=f*Math.sin(s)/
g;f=1-v-s/k;v-=s/k;s=2*s/k;!1==n&&(G=v,v=f,f=s,s=G);!0==l&&(f*=100,v*=100,s*=100);e[0]=f;e[1]=v;e[2]=s;return e};this.dataToPixel=function(a,c,b){return{x:0,y:0}};this.pixelToLiveString=function(a,c){var b=this.pixelToData(a,c);return b[0].toExponential(4)+", "+b[1].toExponential(4)+", "+b[2].toExponential(4)}};a.prototype.numCalibrationPointsRequired=function(){return 3};a.prototype.getDimensions=function(){return 3};return a}();wpd=wpd||{};
wpd.XYAxes=function(){var a=function(){var a=!1,d=!1,b=!1,e=!1,f=!1,g,h,k,l,n,m,q,r,p,s,v,G,I,w,A,J,B,z,H,E,O,K,P,R=function(a,c,M){if(4>a.getCount())return!1;var N=a.getPoint(0),C=a.getPoint(1),D=a.getPoint(2);a=a.getPoint(3);var t=new wpd.InputParser;k=N.px;q=N.py;l=C.px;r=C.py;n=D.px;p=D.py;m=a.px;s=a.py;v=N.dx;G=C.dx;I=D.dy;w=a.dy;v=t.parse(v);if(!t.isValid)return!1;e=t.isDate;G=t.parse(G);if(!t.isValid||t.isDate!=e)return!1;g=t.formatting;I=t.parse(I);if(!t.isValid)return!1;f=t.isDate;w=t.parse(w);
if(!t.isValid||t.isDate!=f)return!1;h=t.formatting;d=c;b=M;!0===d&&(v=Math.log(v)/Math.log(10),G=Math.log(G)/Math.log(10));!0===b&&(I=Math.log(I)/Math.log(10),w=Math.log(w)/Math.log(10));A=G-v;J=w-I;B=Math.sqrt((k-l)*(k-l)+(q-r)*(q-r));z=Math.sqrt((n-m)*(n-m)+(p-s)*(p-s));H=A/B;E=J/z;O=wpd.taninverse(-(r-q),l-k);K=wpd.taninverse(-(s-p),m-n);P=K-O;return!0};this.isCalibrated=function(){return a};this.calibrate=function(b,d,e){return a=R(b,d,e)};this.pixelToData=function(a,c){var e=[],f,g,h,l;f=parseFloat(a);
g=parseFloat(c);h=Math.sqrt((f-k)*(f-k)+(g-q)*(g-q));l=wpd.taninverse(-(g-q),f-k)-O;h=(h*Math.cos(l)-h*Math.sin(l)/Math.tan(P))*H+v;l=Math.sqrt((f-n)*(f-n)+(g-p)*(g-p));f=K-wpd.taninverse(-(g-p),f-n);f=(l*Math.cos(f)-l*Math.sin(f)/Math.tan(P))*E+I;!0===d&&(h=Math.pow(10,h));!0===b&&(f=Math.pow(10,f));e[0]=h;e[1]=f;return e};this.dataToPixel=function(a,c){return{x:0,y:0}};this.pixelToLiveString=function(a,c){var b="",d=this.pixelToData(a,c),b=e?b+wpd.dateConverter.formatDateNumber(d[0],g):b+d[0].toExponential(4),
b=b+", ";return b=f?b+wpd.dateConverter.formatDateNumber(d[1],h):b+d[1].toExponential(4)}};a.prototype.numCalibrationPointsRequired=function(){return 4};a.prototype.getDimensions=function(){return 2};return a}();wpd=wpd||{};
wpd.graphicsWidget=function(){function a(a){var c=w.getBoundingClientRect();return{x:parseInt(a.pageX-(c.left+window.pageXOffset),10),y:parseInt(a.pageY-(c.top+window.pageYOffset),10)}}function c(a,c){return{x:a/F,y:c/F}}function d(a,c){a=parseInt(a,10);c=parseInt(c,10);O.style.width=a+"px";O.style.height=c+"px";w.width=a;A.width=a;J.width=a;B.width=a;z.width=a;w.height=c;A.height=c;J.height=c;B.height=c;z.height=c;V=a/(1*c);C=a;D=c;if(null!=S){K.fillStyle="rgb(255, 255, 255)";K.fillRect(0,0,C,D);
K.drawImage(H,0,0,C,D);if(null!=x&&void 0!=x.onRedraw)x.onRedraw();if(null!=u&&void 0!=u.onRedraw)u.onRedraw()}}function b(){A.width=A.width;J.width=J.width;B.width=B.width;z.width=z.width}function e(){var a=wpd.layoutManager.getGraphicsViewportSize();d(a.width,a.height);V>Q?(F=D/(1*y),d(D*Q,D)):(F=C/(1*t),d(C,C/Q))}function f(a){F=a;d(t*F,y*F)}function g(a){220===a.keyCode&&(a.preventDefault(),T=!T,B.width=B.width)}function h(a,c){var b=wpd.zoomView.getSize(),d=wpd.zoomView.getZoomRatio(),e,f,g,
k,h,l,m,n=0,p=0,q=b.width,r=b.height;g=b.width/d;k=b.height/d;e=a-g/2;f=c-k/2;l=e;b=f;h=e+g;m=f+k;0>e&&(l=0,n=-e*d);0>f&&(b=0,p=-f*d);e+g>=t&&(h=t,q-=d*(t-(e+g)));f+k>=y&&(m=y,r-=d*(y-(f+k)));g=M.getImageData(parseInt(l,10),parseInt(b,10),parseInt(h-l,10),parseInt(m-b,10));h=N.getImageData(parseInt(l,10),parseInt(b,10),parseInt(h-l,10),parseInt(m-b,10));for(m=0;m<h.data.length;m+=4)if(0!=h.data[m]||0!=h.data[m+1]||0!=h.data[m+2])g.data[m]=h.data[m],g.data[m+1]=h.data[m+1],g.data[m+2]=h.data[m+2];
l=d*(parseInt(l,10)-l);d*=parseInt(b,10)-b;wpd.zoomView.setZoomImage(g,parseInt(n+l,10),parseInt(p+d,10),parseInt(q-n,10),parseInt(r-p,10))}function k(b){clearTimeout(W);var d=setTimeout,e=a(b);b=e.x;var e=e.y,f=c(b,e);T&&(B.width=B.width,L.strokeStyle="rgba(0,0,0, 0.5)",L.beginPath(),L.moveTo(b,0),L.lineTo(b,D),L.moveTo(0,e),L.lineTo(C,e),L.stroke());h(f.x,f.y);wpd.zoomView.setCoords(f.x,f.y);W=d(void 0,10)}function l(){w=document.getElementById("mainCanvas");A=document.getElementById("dataCanvas");
J=document.getElementById("drawCanvas");B=document.getElementById("hoverCanvas");z=document.getElementById("topCanvas");H=document.createElement("canvas");E=document.createElement("canvas");K=w.getContext("2d");P=A.getContext("2d");L=B.getContext("2d");U=z.getContext("2d");R=J.getContext("2d");M=H.getContext("2d");N=E.getContext("2d");O=document.getElementById("canvasDiv");document.body.addEventListener("keydown",g,!1);z.addEventListener("mousemove",k,!1);z.addEventListener("dragover",function(a){a.preventDefault()},
!0);z.addEventListener("drop",function(a){a.preventDefault();a=a.dataTransfer.files;1===a.length&&m(a[0])},!0);z.addEventListener("mousemove",p,!1);z.addEventListener("click",s,!1);z.addEventListener("mouseup",v,!1);z.addEventListener("mousedown",G,!1);z.addEventListener("mouseout",I,!0);document.addEventListener("mousedown",function(a){X=a.target===z?!0:!1},!1);document.addEventListener("keydown",function(a){if(X&&null!=u&&void 0!=u.onKeyDown)u.onKeyDown(a)},!0);wpd.zoomView.initZoom();document.getElementById("fileLoadBox").addEventListener("change",
q);window.addEventListener("paste",function(a){if(void 0!==a.clipboardData&&(a=a.clipboardData.items,void 0!==a))for(var c=0;c<a.length;c++)if(-1!==a[c].type.indexOf("image")){var b=a[c].getAsFile();(window.URL||window.webkitURL).createObjectURL(b);m(b)}},!1)}function n(a){var c=document.createElement("img");c.onload=function(){null==w&&l();t=c.width;y=c.height;Q=t/(1*y);H.width=t;H.height=y;E.width=t;E.height=y;M.drawImage(c,0,0,t,y);S=M.getImageData(0,0,t,y);w.width=w.width;b();e();r()};c.src=a}
function m(a){if(a.type.match("image.*")){var c=new FileReader;c.onload=function(){n(c.result)};c.readAsDataURL(a)}}function q(){var a=document.getElementById("fileLoadBox");1==a.files.length&&m(a.files[0])}function r(){if(null!=u&&void 0!=u.onRemove)u.onRemove();u=null}function p(b){if(null!=u&&void 0!=u.onMouseMove){var d=a(b),e=c(d.x,d.y);u.onMouseMove(b,d,e)}}function s(b){if(null!=u&&void 0!=u.onMouseClick){var d=a(b),e=c(d.x,d.y);u.onMouseClick(b,d,e)}}function v(b){if(null!=u&&void 0!=u.onMouseUp){var d=
a(b),e=c(d.x,d.y);u.onMouseUp(b,d,e)}}function G(b){if(null!=u&&void 0!=u.onMouseDown){var d=a(b),e=c(d.x,d.y);u.onMouseDown(b,d,e)}}function I(b){if(null!=u&&void 0!=u.onMouseOut){var d=a(b),e=c(d.x,d.y);u.onMouseOut(b,d,e)}}var w,A,J,B,z,H,E,O,K,P,R,L,U,M,N,C,D,t,y,Q,V,S,F,T=!1,W,u,x,X=!1;return{zoomIn:function(){f(1.2*F)},zoomOut:function(){f(F/1.2)},zoomFit:e,zoom100perc:function(){f(1)},setZoomRatio:f,getZoomRatio:function(){return F},loadImageFromURL:n,runImageOp:function(a){a=a(S,t,y);var c=
a.imageData,d=a.height;t=a.width;y=d;Q=t/(1*y);H.width=t;H.height=y;E.width=t;E.height=y;M.putImageData(c,0,0);S=c;w.width=w.width;b();e();r()},setTool:function(a){if(null!=u&&void 0!=u.onRemove)u.onRemove();u=a;if(null!=u&&void 0!=u.onAttach)u.onAttach()},removeTool:r,getAllContexts:function(){return{mainCtx:K,dataCtx:P,drawCtx:R,hoverCtx:L,topCtx:U,oriImageCtx:M,oriDataCtx:N}},resetData:function(){E.width=E.width;A.width=A.width},resetHover:function(){B.width=B.width},imagePx:c,screenPx:function(a,
c){return{x:a*F,y:c*F}},updateZoomOnEvent:function(b){b=a(b);b=c(b.x,b.y);h(b.x,b.y);wpd.zoomView.setCoords(b.x,b.y)},updateZoomToImagePosn:function(a,c){h(a,c);wpd.zoomView.setCoords(a,c)},getDisplaySize:function(){return{width:C,height:D}},getImageSize:function(){return{width:t,height:y}},copyImageDataLayerToScreen:function(){P.drawImage(E,0,0,C,D)},setRepainter:function(a){if(null==x||void 0==x.painterName||null==a||void 0==a.painterName||x.painterName!=a.painterName){if(null!=x&&void 0!=x.onRemove)x.onRemove();
x=a;if(null!=x&&void 0!=x.onAttach)x.onAttach()}},removeRepainter:function(){if(null!=x&&void 0!=x.onRemove)x.onRemove();x=null},forceHandlerRepaint:function(){if(null!=x&&void 0!=x.onForcedRedraw)x.onForcedRedraw()},getRepainter:function(){return x},saveImage:function(){var a=document.createElement("canvas"),c=a.getContext("2d"),b,d,e;a.width=t;a.height=y;c.drawImage(H,0,0,t,y);b=c.getImageData(0,0,t,y);e=N.getImageData(0,0,t,y);for(d=0;d<b.data.length;d+=4)if(0!=e.data[d]||0!=e.data[d+1]||0!=e.data[d+
2])b.data[d]=e.data[d],b.data[d+1]=e.data[d+1],b.data[d+2]=e.data[d+2];c.putImageData(b,0,0);window.open(a.toDataURL(),"_blank")}}}();wpd=wpd||{};
wpd.layoutManager=function(){function a(){var a=parseInt(document.body.offsetWidth,10),c=parseInt(document.body.offsetHeight,10);e.style.height=c+"px";f.style.width=a-e.offsetWidth+"px";f.style.height=c+"px";b.style.height=c-44+"px"}function c(c){clearTimeout(d);d=setTimeout(a,80)}var d,b,e,f;return{initialLayout:function(){b=document.getElementById("graphicsContainer");e=document.getElementById("sidebarContainer");f=document.getElementById("mainContainer");a();window.addEventListener("resize",c,
!1)},getGraphicsViewportSize:function(){return{width:b.offsetWidth,height:b.offsetHeight}}}}();wpd=wpd||{};
wpd.popup=function(){return{show:function(a){document.getElementById("shadow").style.visibility="visible";a=document.getElementById(a);var c=parseInt(window.innerWidth),d=parseInt(window.innerHeight),b=parseInt(a.offsetWidth),e=parseInt(a.offsetHeight),d=(d-e)/2;a.style.left=(c-b)/2+"px";a.style.top=(60<d?60:d)+"px";a.style.visibility="visible"},close:function(a){document.getElementById("shadow").style.visibility="hidden";document.getElementById(a).style.visibility="hidden"}}}();
wpd.busyNote=function(){return{show:function(){document.getElementById("wait").style.visibility="visible"},close:function(){document.getElementById("wait").style.visibility="hidden"}}}();wpd.messagePopup=function(){var a;return{show:function(c,d,b){wpd.popup.show("messagePopup");document.getElementById("message-popup-heading").innerHTML=c;document.getElementById("message-popup-text").innerHTML=d;a=b},close:function(){wpd.popup.close("messagePopup");null!=a&&a()}}}();
wpd.unsupported=function(){wpd.messagePopup.show("Unsupported Feature!","This feature has not been implemented in the current version. This may be available in a future release.")};wpd=wpd||{};wpd.sidebar=function(){function a(){var a=document.getElementsByClassName("sidebar"),d;for(d=0;d<a.length;d++)a[d].style.visibility="hidden"}return{show:function(c){a();document.getElementById(c).style.visibility="visible"},clear:a}}();wpd=wpd||{};
wpd.toolbar=function(){function a(){for(ii=0;ii<c.length;ii++)document.getElementById(c[ii]).style.visibility="hidden"}var c=["paintToolbar","colorPickerToolbar"];return{show:function(c){a();document.getElementById(c).style.visibility="visible"},clear:a}}();wpd=wpd||{};
wpd.webcamCapture=function(){function a(){void 0!=c&&c.stop();wpd.popup.close("webcamCapture")}var c;return{start:function(){if(null==(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia))wpd.messagePopup.show("Webcam Capture","Your browser does not support webcam capture using HTML5 APIs. A recent version of Google Chrome is recommended.");else{wpd.popup.show("webcamCapture");var a=document.getElementById("webcamVideo");navigator.getUserMedia=
navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;navigator.getUserMedia({video:!0},function(b){c=b;a.src=window.URL.createObjectURL(b)},function(){})}},cancel:function(){a()},capture:function(){var c=document.createElement("canvas"),b=document.getElementById("webcamVideo"),e=c.getContext("2d"),f;c.width=b.videoWidth;c.height=b.videoHeight;e.drawImage(b,0,0);f=e.getImageData(0,0,c.width,c.height);a();wpd.graphicsWidget.runImageOp(function(){return{imageData:f,
width:c.width,height:c.height}})}}}();wpd=wpd||{};
wpd.zoomView=function(){function a(){var a=document.getElementById("zoomCrossHair"),c=a.getContext("2d");a.width=a.width;c.strokeStyle="black"===l?"rgba(0,0,0,1)":"red"===l?"rgba(255,0,0,1)":"yellow"===l?"rgba(255,255,0,1)":"rgba(0,0,0,1)";c.beginPath();c.moveTo(f/2,0);c.lineTo(f/2,g);c.moveTo(0,g/2);c.lineTo(f,g/2);c.stroke()}var c,d,b,e,f=250,g=250,h,k,l="black";return{initZoom:function(){c=document.getElementById("zoomCanvas");d=c.getContext("2d");b=document.createElement("canvas");e=b.getContext("2d");
h=document.getElementById("mousePosition");k=5;a()},setZoomImage:function(a,f,g,h,l){b.width=h/k;b.height=l/k;e.putImageData(a,0,0);c.width=c.width;d.drawImage(b,f,g,h,l)},setCoords:function(a,c){if(wpd.appData.isAligned()){var b=wpd.appData.getPlotData();h.innerText=b.axes.pixelToLiveString(a,c)}else h.innerText=a.toFixed(2)+", "+c.toFixed(2)},setZoomRatio:function(a){k=a},getZoomRatio:function(){return k},getSize:function(){return{width:f,height:g}},showSettingsWindow:function(){document.getElementById("zoom-magnification-value").value=
k;document.getElementById("zoom-crosshair-color-value").value=l;wpd.popup.show("zoom-settings-popup")},applySettings:function(){k=document.getElementById("zoom-magnification-value").value;l=document.getElementById("zoom-crosshair-color-value").value;a();wpd.popup.close("zoom-settings-popup")}}}();wpd=wpd||{};
wpd.xyCalibration=function(){function a(){wpd.popup.show("xyAlignment")}return{start:function(){wpd.popup.show("xyAxesInfo")},pickCorners:function(){wpd.popup.close("xyAxesInfo");var a=new wpd.AxesCornersTool(4,2,["X1","X2","Y1","Y2"]);wpd.graphicsWidget.setTool(a)},getCornerValues:a,align:function(){var c=document.getElementById("xmin").value,d=document.getElementById("xmax").value,b=document.getElementById("ymin").value,e=document.getElementById("ymax").value,f=document.getElementById("xlog").value,
g=document.getElementById("ylog").value,h=new wpd.XYAxes,k=wpd.alignAxes.getActiveCalib();k.setDataAt(0,c,b);k.setDataAt(1,d,b);k.setDataAt(2,c,b);k.setDataAt(3,d,e);if(!h.calibrate(k,f,g))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show("Invalid Inputs","Please enter valid values for calibration.",a),!1;wpd.appData.getPlotData().axes=h;wpd.popup.close("xyAlignment");return!0}}}();
wpd.polarCalibration=function(){return{start:function(){wpd.popup.show("polarAxesInfo")},pickCorners:function(){wpd.popup.close("polarAxesInfo");var a=new wpd.AxesCornersTool(3,2,["Origin","P1","P2"]);wpd.graphicsWidget.setTool(a)},getCornerValues:function(){wpd.popup.show("polarAlignment")},align:function(){var a=parseFloat(document.getElementById("rpoint1").value),c=parseFloat(document.getElementById("thetapoint1").value),d=parseFloat(document.getElementById("rpoint2").value),b=parseFloat(document.getElementById("thetapoint2").value),
e=document.getElementById("degrees").checked;document.getElementById("radians");var f=document.getElementById("clockwise").checked,g=new wpd.PolarAxes,h=wpd.alignAxes.getActiveCalib();h.setDataAt(1,a,c);h.setDataAt(2,d,b);g.calibrate(h,e,f);wpd.appData.getPlotData().axes=g;wpd.popup.close("polarAlignment");return!0}}}();
wpd.ternaryCalibration=function(){return{start:function(){wpd.popup.show("ternaryAxesInfo")},pickCorners:function(){wpd.popup.close("ternaryAxesInfo");var a=new wpd.AxesCornersTool(3,3,["A","B","C"]);wpd.graphicsWidget.setTool(a)},getCornerValues:function(){wpd.popup.show("ternaryAlignment")},align:function(){document.getElementById("range0to1");var a=document.getElementById("range0to100").checked,c=document.getElementById("ternarynormal").checked,d=new wpd.TernaryAxes,b=wpd.alignAxes.getActiveCalib();
d.calibrate(b,a,c);wpd.appData.getPlotData().axes=d;wpd.popup.close("ternaryAlignment");return!0}}}();
wpd.mapCalibration=function(){function a(){wpd.popup.show("mapAlignment")}return{start:function(){wpd.popup.show("mapAxesInfo")},pickCorners:function(){wpd.popup.close("mapAxesInfo");var c=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(c);c.onComplete=a},getCornerValues:a,align:function(){var a=parseFloat(document.getElementById("scaleLength").value),d=new wpd.MapAxes,b=wpd.alignAxes.getActiveCalib();d.calibrate(b,a);wpd.appData.getPlotData().axes=d;wpd.popup.close("mapAlignment");
return!0}}}();
wpd.AxesCornersTool=function(){return function(a,c,d){var b=0;c=new wpd.Calibration(c);var e=!0;c.labels=d;wpd.alignAxes.setActiveCalib(c);wpd.graphicsWidget.resetData();this.onMouseClick=function(c,d,h){e?(b+=1,d=wpd.alignAxes.getActiveCalib(),d.addPoint(h.x,h.y,0,0),d.unselectAll(),d.selectPoint(b-1),wpd.graphicsWidget.forceHandlerRepaint(),b===a&&(e=!1,wpd.alignAxes.calibrationCompleted())):(d=wpd.alignAxes.getActiveCalib(),d.unselectAll(),d.selectNearestPoint(h.x,h.y),wpd.graphicsWidget.forceHandlerRepaint());wpd.graphicsWidget.updateZoomOnEvent(c)};
this.onKeyDown=function(a){var c=wpd.alignAxes.getActiveCalib();if(0!==c.getSelectedPoints().length){var b=c.getPoint(c.getSelectedPoints()[0]),d=b.px,b=b.py,e=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))b-=e;else if(wpd.keyCodes.isDown(a.keyCode))b+=e;else if(wpd.keyCodes.isLeft(a.keyCode))d-=e;else if(wpd.keyCodes.isRight(a.keyCode))d+=e;else return;c.changePointPx(c.getSelectedPoints()[0],d,b);wpd.graphicsWidget.forceHandlerRepaint();
wpd.graphicsWidget.updateZoomToImagePosn(d,b);a.preventDefault();a.stopPropagation()}}}}();
wpd.AlignmentCornersRepainter=function(){return function(){var a=wpd.graphicsWidget.getAllContexts();this.painterName="AlignmentCornersReptainer";this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()};this.onRedraw=function(){var c=wpd.alignAxes.getActiveCalib();if(null!=c){var d,b,e;for(d=0;d<c.getCount();d++)e=c.getPoint(d),b=wpd.graphicsWidget.screenPx(e.px,e.py),a.dataCtx.fillStyle="rgba(255,255,255,0.7)",a.dataCtx.fillRect(b.x-10,b.y-10,20,40),a.dataCtx.beginPath(),c.isPointSelected(d)?
a.dataCtx.fillStyle="rgba(0,200,0,1)":a.dataCtx.fillStyle="rgba(200,0,0,1)",a.dataCtx.arc(b.x,b.y,3,0,2*Math.PI,!0),a.dataCtx.fill(),a.dataCtx.font="14px sans-serif",a.dataCtx.fillText(c.labels[d],b.x-10,b.y+18),a.oriDataCtx.beginPath(),c.isPointSelected(d)?a.oriDataCtx.fillStyle="rgb(0,200,0)":a.oriDataCtx.fillStyle="rgb(200,0,0)",a.oriDataCtx.arc(e.px,e.py,3,0,2*Math.PI,!0),a.oriDataCtx.fill(),a.oriDataCtx.font="14px sans-serif",a.oriDataCtx.fillText(c.labels[d],parseInt(e.px-10,10),parseInt(e.py+
18,10))}}}}();
wpd.alignAxes=function(){var a,c;return{start:function(){xyEl=document.getElementById("r_xy");polarEl=document.getElementById("r_polar");ternaryEl=document.getElementById("r_ternary");mapEl=document.getElementById("r_map");imageEl=document.getElementById("r_image");wpd.popup.close("axesList");if(!0===xyEl.checked)c=wpd.xyCalibration;else if(!0===polarEl.checked)c=wpd.polarCalibration;else if(!0===ternaryEl.checked)c=wpd.ternaryCalibration;else if(!0===mapEl.checked)c=wpd.mapCalibration;else if(!0===
imageEl.checked){c=null;var a=new wpd.ImageAxes;a.calibrate();wpd.appData.getPlotData().axes=a;wpd.appData.isAligned(!0);wpd.acquireData.showSidebar()}null!=c&&(c.start(),wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter))},calibrationCompleted:function(){wpd.sidebar.show("axes-calibration-sidebar")},getCornerValues:function(){c.getCornerValues()},align:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();c.align()&&(wpd.appData.isAligned(!0),
wpd.acquireData.showSidebar())},getActiveCalib:function(){return a},setActiveCalib:function(c){a=c}}}();wpd=wpd||{};
wpd.autoExtraction=function(){function a(){var a=wpd.appData.getPlotData().getAutoDetector();"averagingWindow"===document.getElementById("auto-extract-algo-name").value&&(a.algorithm=new wpd.AveragingWindowAlgo);var d=a.algorithm,a=document.getElementById("algo-parameter-container"),d=d.getParamList(),b,e="";for(b=0;b<d.length;b++)e+=d[b][0]+' <input type="text" size=3 id="algo-param-'+b+'" class="algo-params" value="'+d[b][2]+'"/> '+d[b][1],b!=d.length-1&&(e+=", ");a.innerHTML=e+"</table>"}return{start:function(){wpd.sidebar.show("auto-extraction-sidebar");
wpd.colorPicker.init();a()},changeAlgorithm:a,runAlgo:function(){var a=wpd.appData.getPlotData().getAutoDetector(),d=a.algorithm,b=new wpd.DataPointsRepainter,e=document.getElementsByClassName("algo-params"),f,g;for(f=0;f<e.length;f++)g=e[f].id,g=parseInt(g.replace("algo-param-",""),10),d.setParam(g,parseFloat(e[f].value));wpd.graphicsWidget.removeTool();a.generateBinaryData();wpd.graphicsWidget.setRepainter(b);d.run(wpd.appData.getPlotData());wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()}}}();
wpd=wpd||{};
wpd.colorPicker=function(){function a(){var a=document.getElementById("color-button"),c=document.getElementById("color-distance-value"),b=wpd.appData.getPlotData().getAutoDetector(),d=document.getElementById("color-detection-mode-select"),k;k="fg"===b.colorDetectionMode?b.fgColor:b.bgColor;color_distance=b.colorDistance;a.style.backgroundColor="rgb("+k[0]+","+k[1]+","+k[2]+")";c.value=color_distance;d.value=b.colorDetectionMode}function c(){var a=wpd.appData.getPlotData().getAutoDetector().fgColor;document.getElementById("color_red_fg").value=
a[0];document.getElementById("color_green_fg").value=a[1];document.getElementById("color_blue_fg").value=a[2];wpd.popup.show("colorPickerFG")}function d(){var a=wpd.appData.getPlotData().getAutoDetector().bgColor;document.getElementById("color_red_bg").value=a[0];document.getElementById("color_green_bg").value=a[1];document.getElementById("color_blue_bg").value=a[2];wpd.popup.show("colorPickerBG")}function b(){var a=wpd.graphicsWidget.getAllContexts(),c=wpd.appData.getPlotData().getAutoDetector(),
b=wpd.graphicsWidget.getImageSize(),d,k,l;l=a.oriDataCtx.getImageData(0,0,b.width,b.height);c.generateBinaryData();if(null!=c.mask&&0!==c.mask.length){for(d=0;d<c.mask.length;d++)k=c.mask[d],!0===c.binaryData[k]?(parseInt(k/b.width,10),l.data[4*k]=255,l.data[4*k+1]=255,l.data[4*k+2]=0,l.data[4*k+3]=255):(l.data[4*k]=0,l.data[4*k+1]=0,l.data[4*k+2]=0,l.data[4*k+3]=150);a.oriDataCtx.putImageData(l,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}}return{startPicker:function(){wpd.graphicsWidget.removeTool();
wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();"fg"===wpd.appData.getPlotData().getAutoDetector().colorDetectionMode?c():d()},changeDetectionMode:function(){var c=document.getElementById("color-detection-mode-select");wpd.appData.getPlotData().getAutoDetector().colorDetectionMode=c.value;a()},pickFGColor:function(a){wpd.popup.close("colorPickerFG");a=new wpd.ColorPickerTool;a.onComplete=function(a){wpd.appData.getPlotData().getAutoDetector().fgColor=a;wpd.graphicsWidget.removeTool();
c()};wpd.graphicsWidget.setTool(a)},pickBGColor:function(a){wpd.popup.close("colorPickerBG");a=new wpd.ColorPickerTool;a.onComplete=function(a){wpd.appData.getPlotData().getAutoDetector().bgColor=a;wpd.graphicsWidget.removeTool();d()};wpd.graphicsWidget.setTool(a)},setFGColor:function(){var c=[];c[0]=parseInt(document.getElementById("color_red_fg").value,10);c[1]=parseInt(document.getElementById("color_green_fg").value,10);c[2]=parseInt(document.getElementById("color_blue_fg").value,10);wpd.appData.getPlotData().getAutoDetector().fgColor=
c;wpd.popup.close("colorPickerFG");a()},setBGColor:function(){var c=[];c[0]=parseInt(document.getElementById("color_red_bg").value,10);c[1]=parseInt(document.getElementById("color_green_bg").value,10);c[2]=parseInt(document.getElementById("color_blue_bg").value,10);wpd.appData.getPlotData().getAutoDetector().bgColor=c;wpd.popup.close("colorPickerBG");a()},changeColorDistance:function(){var a=parseFloat(document.getElementById("color-distance-value").value);wpd.appData.getPlotData().getAutoDetector().colorDistance=
a},init:a,testColorDetection:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.ColorFilterRepainter);b()},paintFilteredColor:b}}();wpd.ColorPickerTool=function(){return function(){var a=wpd.graphicsWidget.getAllContexts();this.onMouseClick=function(c,d,b){c=a.oriImageCtx.getImageData(b.x,b.y,1,1);this.onComplete([c.data[0],c.data[1],c.data[2]])};this.onComplete=function(a){}}}();
wpd.ColorFilterRepainter=function(){return function(){this.painterName="colorFilterRepainter";this.onRedraw=function(){wpd.colorPicker.paintFilteredColor()}}}();wpd=wpd||{};wpd.distanceMeasurement=function(){return{start:function(){},selectPairs:function(){},adjustPoints:function(){},viewData:function(){},saveImage:function(){}}}();
var imageOps=function(){return{hflip:function(a,c,d){var b,e,f,g,h,k;for(b=0;b<d;b++)for(e=0;e<c/2;e++)for(f=4*(b*c+e),g=4*((b+1)*c-(e+1)),k=0;4>k;k++)h=a.data[f+k],a.data[f+k]=a.data[g+k],a.data[g+k]=h;return{imageData:a,width:c,height:d}},vflip:function(a,c,d){var b,e,f,g,h,k;for(b=0;b<d/2;b++)for(e=0;e<c;e++)for(f=4*(b*c+e),g=4*((d-(b+2))*c+e),k=0;4>k;k++)h=a.data[f+k],a.data[f+k]=a.data[g+k],a.data[g+k]=h;return{imageData:a,width:c,height:d}}}}(),cropStatus=0,cropCoordinates=[0,0,0,0];
function hflip(){processingNote(!0);wpd.graphicsWidget.runImageOp(imageOps.hflip);processingNote(!1)}function vflip(){processingNote(!0);wpd.graphicsWidget.runImageOp(imageOps.vflip);processingNote(!1)}function cropPlot(){redrawCanvas();canvasMouseEvents.removeAll();canvasMouseEvents.add("mousedown",cropMousedown,!0);canvasMouseEvents.add("mouseup",cropMouseup,!0);canvasMouseEvents.add("mousemove",cropMousemove,!0)}
function cropMousedown(a){a=getPosition(a);var c=a.y;cropCoordinates[0]=a.x;cropCoordinates[1]=c;cropStatus=1}
function cropMouseup(a){a=getPosition(a);var c=a.y;cropCoordinates[2]=a.x;cropCoordinates[3]=c;cropStatus=0;hoverCanvas.width=hoverCanvas.width;cropWidth=cropCoordinates[2]-cropCoordinates[0];cropHeight=cropCoordinates[3]-cropCoordinates[1];if(0<cropWidth&&0<cropHeight){a=document.createElement("canvas");c=a.getContext("2d");a.width=cropWidth;a.height=cropHeight;var d=ctx.getImageData(cropCoordinates[0],cropCoordinates[1],cropWidth,cropHeight);c.putImageData(d,0,0);cropSrc=a.toDataURL();cropImg=new Image;
cropImg.src=cropSrc;cropImg.onload=function(){loadImage(cropImg)}}}function cropMousemove(a){var c=getPosition(a);a=c.x;c=c.y;1==cropStatus&&(hoverCanvas.width=hoverCanvas.width,hoverCtx.strokeStyle="rgb(0,0,0)",hoverCtx.strokeRect(cropCoordinates[0],cropCoordinates[1],a-cropCoordinates[0],c-cropCoordinates[1]))}function restoreOriginalImage(){loadImage(originalImage)}function rotateCanvas(){}wpd=wpd||{};
wpd.keyCodes=function(){return{isUp:function(a){return 38===a},isDown:function(a){return 40===a},isLeft:function(a){return 37===a},isRight:function(a){return 39===a}}}();wpd=wpd||{};
wpd.acquireData=function(){return{load:function(){wpd.appData.isAligned()?(wpd.sidebar.show("acquireDataSidebar"),wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)):wpd.messagePopup.show("Acquire Data","Please calibrate the axes before acquiring data.")},manualSelection:function(){var a=new wpd.ManualSelectionTool;wpd.graphicsWidget.setTool(a)},adjustPoints:function(){wpd.graphicsWidget.setTool(new wpd.AdjustDataPointTool)},deletePoint:function(){var a=new wpd.DeleteDataPointTool;
wpd.graphicsWidget.setTool(a)},clearAll:function(){wpd.appData.getPlotData().getActiveDataSeries().clearAll();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.dataPointCounter.setCount()},undo:function(){wpd.appData.getPlotData().getActiveDataSeries().removeLastPixel();wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},showSidebar:function(){wpd.sidebar.show("acquireDataSidebar")}}}();
wpd.ManualSelectionTool=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("manual-select-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(d,b,e){c.getActiveDataSeries().addPixel(e.x,e.y);a.dataCtx.beginPath();a.dataCtx.fillStyle="rgb(200,0,0)";a.dataCtx.arc(b.x,b.y,3,0,2*Math.PI,!0);a.dataCtx.fill();a.oriDataCtx.beginPath();
a.oriDataCtx.fillStyle="rgb(200,0,0)";a.oriDataCtx.arc(e.x,e.y,3,0,2*Math.PI,!0);a.oriDataCtx.fill();wpd.graphicsWidget.updateZoomOnEvent(d);wpd.dataPointCounter.setCount()};this.onRemove=function(){document.getElementById("manual-select-button").classList.remove("pressed-button")};this.onKeyDown=function(a){var b=c.getActiveDataSeries(),e=b.getCount()-1,f=b.getPixel(e),g=0.5/wpd.graphicsWidget.getZoomRatio();wpd.keyCodes.isUp(a.keyCode)?f.y-=g:wpd.keyCodes.isDown(a.keyCode)?f.y+=g:wpd.keyCodes.isLeft(a.keyCode)?
f.x-=g:wpd.keyCodes.isRight(a.keyCode)&&(f.x+=g);b.setPixelAt(e,f.x,f.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(f.x,f.y);a.preventDefault()}}}();
wpd.DeleteDataPointTool=function(){return function(){wpd.graphicsWidget.getAllContexts();var a=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("delete-point-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(c,d,b){a.getActiveDataSeries().removeNearestPixel(b.x,b.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(c);wpd.dataPointCounter.setCount()};
this.onRemove=function(){document.getElementById("delete-point-button").classList.remove("pressed-button")}}}();
wpd.DataPointsRepainter=function(){return function(){var a=function(){var a=wpd.graphicsWidget.getAllContexts(),d=wpd.appData.getPlotData().getActiveDataSeries(),b,e,f,g;for(b=0;b<d.getCount();b++)e=d.getPixel(b),g=0<=d.getSelectedPixels().indexOf(b),f=wpd.graphicsWidget.screenPx(e.x,e.y),a.dataCtx.beginPath(),a.dataCtx.fillStyle=g?"rgb(0,200,0)":"rgb(200,0,0)",a.dataCtx.arc(f.x,f.y,3,0,2*Math.PI,!0),a.dataCtx.fill(),a.oriDataCtx.beginPath(),a.oriDataCtx.fillStyle=g?"rgb(0,200,0)":"rgb(200,0,0)",
a.oriDataCtx.arc(e.x,e.y,3,0,2*Math.PI,!0),a.oriDataCtx.fill()};this.painterName="dataPointsRepainter";this.onAttach=function(){wpd.graphicsWidget.resetData();a()};this.onRedraw=function(){a()};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();a()}}}();
wpd.AdjustDataPointTool=function(){return function(){this.onAttach=function(){document.getElementById("manual-adjust-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onRemove=function(){wpd.appData.getPlotData().getActiveDataSeries().unselectAll();wpd.graphicsWidget.forceHandlerRepaint();document.getElementById("manual-adjust-button").classList.remove("pressed-button")};this.onMouseClick=function(a,c,d){c=wpd.appData.getPlotData().getActiveDataSeries();
c.unselectAll();c.selectNearestPixel(d.x,d.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){var c=wpd.appData.getPlotData().getActiveDataSeries(),d=c.getSelectedPixels()[0];if(null!=d){var b=c.getPixel(d),e=b.x,b=b.y,f=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))b-=f;else if(wpd.keyCodes.isDown(a.keyCode))b+=f;else if(wpd.keyCodes.isLeft(a.keyCode))e-=f;else if(wpd.keyCodes.isRight(a.keyCode))e+=
f;else return;c.setPixelAt(d,e,b);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e,b);a.preventDefault();a.stopPropagation()}}}}();wpd.dataPointCounter=function(){return{setCount:function(){var a=document.getElementsByClassName("data-point-counter"),c;for(c=0;c<a.length;c++)a[c].innerHTML=wpd.appData.getPlotData().getActiveDataSeries().getCount()}}}();wpd=wpd||{};
wpd.dataMask=function(){return{grabMask:function(a){var c=wpd.graphicsWidget.getAllContexts(),d=wpd.graphicsWidget.getImageSize(),b=c.oriDataCtx.getImageData(0,0,d.width,d.height),e=[],f,g=0,h=wpd.appData.getPlotData().getAutoDetector();for(f=0;f<b.data.length;f+=4)255===b.data[f]&&255===b.data[f+1]&&0===b.data[f+2]&&(e[g]=f/4,g++);h.mask=e;!0===a&&(h.imageData=c.oriImageCtx.getImageData(0,0,d.width,d.height),h.imageWidth=d.width,h.imageHeight=d.height)},drawMask:function(){var a=wpd.appData.getPlotData().getAutoDetector().mask;
if(null!=a&&0!==a.length){var c,d,b=wpd.graphicsWidget.getAllContexts(),e=wpd.graphicsWidget.getImageSize(),f=b.oriDataCtx.getImageData(0,0,e.width,e.height);for(c=0;c<a.length;c++)d=a[c],parseInt(d/e.height,10),f.data[4*d]=255,f.data[4*d+1]=255,f.data[4*d+2]=0,f.data[4*d+3]=200;b.oriDataCtx.putImageData(f,0,0,e.width,e.height);wpd.graphicsWidget.copyImageDataLayerToScreen()}},markBox:function(){var a=new wpd.BoxMaskTool;wpd.graphicsWidget.setTool(a)},markPen:function(){var a=new wpd.PenMaskTool;
wpd.graphicsWidget.setTool(a)},eraseMarks:function(){var a=new wpd.EraseMaskTool;wpd.graphicsWidget.setTool(a)},viewMask:function(){var a=new wpd.ViewMaskTool;wpd.graphicsWidget.setTool(a)}}}();
wpd.BoxMaskTool=function(){return function(){var a=!1,c,d,b=wpd.graphicsWidget.getAllContexts(),e,f,g=function(){wpd.graphicsWidget.resetHover();b.hoverCtx.strokeStyle="rgb(0,0,0)";b.hoverCtx.strokeRect(d.x,d.y,f.x-d.x,f.y-d.y)};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("box-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button")};this.onMouseDown=function(b,e,f){!0!==a&&(a=!0,c=f,d=e)};
this.onMouseMove=function(c,b,d){!1!==a&&(f=b,clearTimeout(e),e=setTimeout(g,5))};this.onMouseOut=function(){!0===a&&(clearTimeout(e),a=!1,wpd.graphicsWidget.resetHover())};this.onMouseUp=function(f,g,l){!1!==a&&(clearTimeout(e),a=!1,wpd.graphicsWidget.resetHover(),b.dataCtx.fillStyle="rgba(255,255,0,0.8)",b.dataCtx.fillRect(d.x,d.y,g.x-d.x,g.y-d.y),b.oriDataCtx.fillStyle="rgba(255,255,0,0.8)",b.oriDataCtx.fillRect(c.x,c.y,l.x-c.x,l.y-c.y))};this.onRemove=function(){document.getElementById("box-mask").classList.remove("pressed-button");
document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask(!0)}}}();
wpd.PenMaskTool=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=!1,d,b,e,f=function(){a.dataCtx.strokeStyle="rgba(255,255,0,0.8)";a.dataCtx.lineTo(b.x,b.y);a.dataCtx.stroke();a.oriDataCtx.strokeStyle="rgba(255,255,0,0.8)";a.oriDataCtx.lineTo(e.x,e.y);a.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("pen-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button")};
this.onMouseDown=function(b,d,e){!0!==c&&(c=!0,a.dataCtx.strokeStyle="rgba(255,255,0,0.8)",a.dataCtx.lineWidth=20,a.dataCtx.beginPath(),a.dataCtx.moveTo(d.x,d.y),a.oriDataCtx.strokeStyle="rgba(255,255,0,0.8)",a.oriDataCtx.lineWidth=20,a.oriDataCtx.beginPath(),a.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(a,h,k){!1!==c&&(b=h,e=k,clearTimeout(d),d=setTimeout(f,5))};this.onMouseUp=function(b,e,f){clearTimeout(d);a.dataCtx.closePath();a.dataCtx.lineWidth=1;a.oriDataCtx.closePath();a.oriDataCtx.lineWidth=
1;c=!1};this.onMouseOut=function(a,c,b){this.onMouseUp(a,c,b)};this.onRemove=function(){document.getElementById("pen-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask(!0)}}}();
wpd.EraseMaskTool=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=!1,d,b,e,f=function(){a.dataCtx.globalCompositeOperation="destination-out";a.oriDataCtx.globalCompositeOperation="destination-out";a.dataCtx.strokeStyle="rgba(255,255,0,1)";a.dataCtx.lineTo(b.x,b.y);a.dataCtx.stroke();a.oriDataCtx.strokeStyle="rgba(255,255,0,1)";a.oriDataCtx.lineTo(e.x,e.y);a.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("erase-mask").classList.add("pressed-button");
document.getElementById("view-mask").classList.add("pressed-button")};this.onMouseDown=function(b,d,e){!0!==c&&(c=!0,a.dataCtx.globalCompositeOperation="destination-out",a.oriDataCtx.globalCompositeOperation="destination-out",a.dataCtx.strokeStyle="rgba(0,0,0,1)",a.dataCtx.lineWidth=20,a.dataCtx.beginPath(),a.dataCtx.moveTo(d.x,d.y),a.oriDataCtx.strokeStyle="rgba(0,0,0,1)",a.oriDataCtx.lineWidth=20,a.oriDataCtx.beginPath(),a.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(a,h,k){!1!==c&&(b=
h,e=k,clearTimeout(d),d=setTimeout(f,5))};this.onMouseOut=function(a,c,b){this.onMouseUp(a,c,b)};this.onMouseUp=function(b,e,f){clearTimeout(d);a.dataCtx.closePath();a.dataCtx.lineWidth=1;a.oriDataCtx.closePath();a.oriDataCtx.lineWidth=1;a.dataCtx.globalCompositeOperation="source-over";a.oriDataCtx.globalCompositeOperation="source-over";c=!1};this.onRemove=function(){document.getElementById("erase-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");
wpd.dataMask.grabMask(!0)}}}();wpd.ViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("view-mask").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask(!0)}}}();
wpd.MaskPainter=function(){return function(){var a=wpd.graphicsWidget.getAllContexts(),c=wpd.appData.getPlotData().getAutoDetector(),d=function(){if(null!=c.mask&&0!==c.mask.length){var b,d;b=wpd.graphicsWidget.getImageSize();imgData=a.oriDataCtx.getImageData(0,0,b.width,b.height);for(b=0;b<c.mask.length;b++)d=c.mask[b],imgData.data[4*d]=255,imgData.data[4*d+1]=255,imgData.data[4*d+2]=0,imgData.data[4*d+3]=200;a.oriDataCtx.putImageData(imgData,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}};
this.painterName="dataMaskPainter";this.onRedraw=function(){wpd.dataMask.grabMask(!0);d()};this.onAttach=function(){wpd.graphicsWidget.resetData();d()}}}();wpd=wpd||{};
wpd.dataTable=function(){function a(){c=wpd.appData.getPlotData().getDataFromActiveSeries();console.log(c)}var c,d,b;return{getSeriesData:a,showTable:function(){if(wpd.appData.isAligned()&&(wpd.popup.show("csvWindow"),a(),d=c,null!=c&&0!==c.length)){var e=wpd.appData.getPlotData().axes.getDimensions(),f=c.length,g,h,k,l=document.getElementById("digitizedDataTable");b="";for(g=0;g<f;g++){k=[];for(h=0;h<e;h++)k[h]=d[g][h];b+=k.join(", ");b+="\n"}l.value=b}},updateSortingControls:function(){},reSort:function(){},
selectAll:function(){var a=document.getElementById("digitizedDataTable");a.focus();a.select()},generateCSV:function(){var a,c,d,h=JSON.stringify(b);a=document.createElement("div");c=document.createElement("form");d=document.createElement("input");c.setAttribute("method","post");c.setAttribute("action","php/csvexport.php");d.setAttribute("type","text");d.setAttribute("name","data");c.appendChild(d);a.appendChild(c);document.body.appendChild(a);a.style.display="none";d.setAttribute("value",h);c.submit();
document.body.removeChild(a)},exportToPlotly:function(){}}}();
wpd.CSVExport=function(){function a(){var a=document.getElementById("dataSortOption"),c=document.getElementById("dataSortOrder");"NearestNeighbor"===a.value||"raw"===a.value?c.setAttribute("disabled",!0):c.removeAttribute("disabled");b()}function c(a){var c=document.getElementById("tarea");c.value="";if("XY"===plotType||"map"===plotType||"polar"===plotType||"image"===plotType)for(var b=0;b<pointsPicked;b++)c.value=c.value+d(a[b][0],"X")+","+d(a[b][1],"Y")+"\n";else if("ternary"===plotType)for(b=0;b<
pointsPicked;b++)c.value=c.value+a[b][0]+","+a[b][1]+","+a[b][2]+"\n";f=a}function d(a,c){if("XY"===plotType){if("X"===c&&axesAlignmentData[6]){var b=document.getElementById("xDateFormat");return dateConverter.formatDate(dateConverter.fromJD(a),b.value)}if("Y"===c&&axesAlignmentData[7])return b=document.getElementById("yDateFormat"),dateConverter.formatDate(dateConverter.fromJD(a),b.value)}return a}function b(){var a=document.getElementById("dataSortOption"),b="ascending"===document.getElementById("dataSortOrder").value,
d="raw"==a.value,f="NearestNeighbor"===a.value,n,m=e.slice(0),q="ternary"===plotType?3:2;if(d)c(m);else if(!f)n=parseInt(a.value,10),0>n||3<=n||(m.sort(function(a,c){return a[n]>c[n]?b?1:-1:a[n]<c[n]?b?-1:1:0}),c(m));else if(f){for(var r,f=[1,1,1],p=0;p<pointsPicked-1;p++){for(var d=-1,s=p+1;s<pointsPicked;s++)if(a=(m[p][0]-m[s][0])*(m[p][0]-m[s][0])+(m[p][1]-m[s][1])*(m[p][1]-m[s][1]),3===q&&(a+=(m[p][2]-m[s][2])*(m[p][2]-m[s][2])),a<r||-1===d)r=a,d=s;f[0]=m[d][0];m[d][0]=m[p+1][0];m[p+1][0]=f[0];
f[1]=m[d][1];m[d][1]=m[p+1][1];m[p+1][1]=f[1];3===q&&(f[2]=m[d][2],m[d][2]=m[p+1][2],m[p+1][2]=f[2])}c(m)}}var e,f=[];return{generate:function(){if(1===axesPicked&&1<=pointsPicked){wpd.popup.show("csvWindow");e=pixelToData(xyData,pointsPicked,plotType);document.getElementById("dataSortOrder");var b=document.getElementById("dataSortOption"),d=document.getElementById("dataVariables");b.innerHTML='<option value="raw">Raw Output</option>';"XY"===plotType||"map"===plotType||"image"===plotType?(b.innerHTML+=
'<option value="0">x</option>',b.innerHTML+='<option value="1">y</option>',d.innerHTML="x, y"):"ternary"===plotType?(b.innerHTML+='<option value="0">a</option>',b.innerHTML+='<option value="1">b</option>',b.innerHTML+='<option value="2">c</option>',d.innerHTML="a, b, c"):"polar"===plotType&&(b.innerHTML+='<option value="0">r</option>',b.innerHTML+='<option value="1">\u0398</option>',d.innerHTML="r, \u0398");b.innerHTML+='<option value="NearestNeighbor">Nearest Neighbor</option>';a();b=document.getElementById("csvDateFormatting");
if("XY"===plotType)if(!0===axesAlignmentData[6]||!0===axesAlignmentData[7]){b.style.display="inline-block";var b=document.getElementById("csvDateFormattingX"),d=document.getElementById("csvDateFormattingY"),f=document.getElementById("xDateFormat");document.getElementById("yDateFormat");axesAlignmentData[6]?(b.style.display="inline-block",f.value=axesAlignmentData[8]):b.style.display="none";axesAlignmentData[7]?(d.style.display="inline-block",yDateFormat.value=axesAlignmentData[9]):d.style.display=
"none"}else b.style.display="none";else b.style.display="none";c(e)}},reSort:b,updateSortingControls:a,selectAll:function(){var a=document.getElementById("tarea");a.focus();a.select()},getDisplayData:function(){return f}}}();wpd=wpd||{};
wpd.plotly=function(){function a(a,d){return"XY"===plotType&&("X"===d&&axesAlignmentData[6]||"Y"===d&&axesAlignmentData[7])?dateConverter.formatDate(dateConverter.fromJD(a),"yyyy-mm-dd"):a}return{exportData:function(){if(0!==pointsPicked){var c=document.createElement("div"),d=document.createElement("form"),b=document.createElement("input");d.setAttribute("method","post");d.setAttribute("action","https://plot.ly/external");d.setAttribute("target","_blank");b.setAttribute("type","text");b.setAttribute("name",
"data");d.appendChild(b);c.appendChild(d);document.body.appendChild(c);c.style.display="none";var e=[],f=[],g=[],h={data:[]},k=wpd.CSVExport.getDisplayData();if("XY"===plotType||"map"===plotType||"polar"===plotType||"image"===plotType){for(var l=0;l<pointsPicked;l++)e[l]=a(k[l][0],"X"),f[l]=a(k[l][1],"Y");h.data[0]={x:e,y:f}}else if("ternary"===plotType){for(l=0;l<pointsPicked;l++)e[l]=k[l][0],f[l]=k[l][1],g[l]=k[l][2];h.data[0]={x:e,y:f,z:g}}b.setAttribute("value",JSON.stringify(h));d.submit();document.body.removeChild(c)}}}}();
wpd=wpd||{};wpd.scriptInjector=function(){return{start:function(){wpd.popup.show("runScriptPopup")},cancel:function(){wpd.popup.close("runScriptPopup")},load:function(){var a=document.getElementById("runScriptFileInput");wpd.popup.close("runScriptPopup");if(1==a.files.length){var c=new FileReader;c.onload=function(){eval(c.result);wpdscript.run();window.wpdscript=wpdscript};c.readAsText(a.files[0])}}}}();
window.addEventListener("load",function(a){window.applicationCache.addEventListener("updateready",function(a){window.applicationCache.status==window.applicationCache.UPDATEREADY&&confirm("A new version of WebPlotDigitizer is available. Update?")&&window.location.reload()},!1)},!1);wpd=wpd||{};wpd.browserInfo=function(){return{checkBrowser:function(){window.FileReader||alert("\tWARNING!\nYour web browser is not supported. This program might not behave as intended. Please use a recent version of Google Chrome, Firefox or Safari browser.")}}}();

var wpd=wpd||{};wpd.initApp=function(){wpd.browserInfo.checkBrowser();wpd.layoutManager.initialLayout();wpd.graphicsWidget.loadImageFromURL("start.png");document.getElementById("loadingCurtain").style.display="none"};document.addEventListener("DOMContentLoaded",wpd.initApp,!0);wpd=wpd||{};wpd.detectionAlgoManager=function(){return{setActiveAlgo:function(b){},getActiveAlgo:function(){return null},getAllApplicableAlgorithms:function(){}}}();wpd=wpd||{};
wpd.appData=function(){function b(){null==d&&(d=new wpd.PlotData);return d}var a=!1,d;return{isAligned:function(d){null!=d&&(a=d);return a},getPlotData:b,reset:function(){a=!1;d=null},plotLoaded:function(a){b().topColors=wpd.colorAnalyzer.getTopColors(a)}}}();wpd=wpd||{};
wpd.AutoDetector=function(){return function(){this.fgColor=[0,0,200];this.bgColor=[255,255,255];this.mask=null;this.colorDetectionMode="fg";this.colorDistance=120;this.imageData=this.binaryData=this.algorithm=null;this.imageHeight=this.imageWidth=0;this.reset=function(){this.imageData=this.binaryData=this.mask=null};this.generateBinaryDataFromMask=function(){var b,a,d,c="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(b=0;b<this.mask.length;b++)a=this.mask[b],d=Math.sqrt((this.imageData.data[4*
a]-c[0])*(this.imageData.data[4*a]-c[0])+(this.imageData.data[4*a+1]-c[1])*(this.imageData.data[4*a+1]-c[1])+(this.imageData.data[4*a+2]-c[2])*(this.imageData.data[4*a+2]-c[2])),"fg"===this.colorDetectionMode?d<=this.colorDistance&&(this.binaryData[a]=!0):d>=this.colorDistance&&(this.binaryData[a]=!0)};this.generateBinaryDataUsingFullImage=function(){var b,a,d="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(a=0;a<this.imageData.data.length/4;a++)b=Math.sqrt((this.imageData.data[4*a]-
d[0])*(this.imageData.data[4*a]-d[0])+(this.imageData.data[4*a+1]-d[1])*(this.imageData.data[4*a+1]-d[1])+(this.imageData.data[4*a+2]-d[2])*(this.imageData.data[4*a+2]-d[2])),"fg"===this.colorDetectionMode?b<=this.colorDistance&&(this.binaryData[a]=!0):b>=this.colorDistance&&(this.binaryData[a]=!0)};this.generateBinaryData=function(){this.binaryData=[];null==this.imageData?this.imageWidth=this.imageHeight=0:(this.imageHeight=this.imageData.height,this.imageWidth=this.imageData.width,null==this.mask||
0===this.mask.length?this.generateBinaryDataUsingFullImage():this.generateBinaryDataFromMask())}}}();wpd=wpd||{};wpd.ColorGroup=function(){return function(b){var a=0,d={r:0,g:0,b:0};b=null==b?100:b;this.getPixelCount=function(){return a};this.getAverageColor=function(){return d};this.isColorInGroup=function(c,e,f){return 0===a?!0:(d.r-c)*(d.r-c)+(d.g-e)*(d.g-e)+(d.b-f)*(d.b-f)<=b*b};this.addPixel=function(b,e,f){d.r=(d.r*a+b)/(a+1);d.g=(d.g*a+e)/(a+1);d.b=(d.b*a+f)/(a+1);a+=1}}}();
wpd.colorAnalyzer=function(){return{getTopColors:function(b){var a=[],d,c,e,f,g,k,p=[];a[0]=new wpd.ColorGroup(120);for(d=0;d<b.data.length;d+=4){c=b.data[d];e=b.data[d+1];f=b.data[d+2];k=!1;for(g=0;g<a.length;g++)if(a[g].isColorInGroup(c,e,f)){a[g].addPixel(c,e,f);k=!0;break}k||(a[a.length]=new wpd.ColorGroup(120),a[a.length-1].addPixel(c,e,f))}a.sort(function(a,d){return a.getPixelCount()>d.getPixelCount()?-1:a.getPixelCount()<d.getPixelCount()?1:0});for(g=0;g<a.length;g++)d=a[g].getAverageColor(),
p[g]={r:parseInt(d.r,10),g:parseInt(d.g,10),b:parseInt(d.b,10),pixels:a[g].getPixelCount(),percentage:100*a[g].getPixelCount()/(0.25*b.data.length)};return p}}}();wpd=wpd||{};wpd.dataEventNames={axesAligned:"axesAligned",imageLoaded:"imageLoaded"};wpd.dataEventManager=function(){return{fireEvent:function(b,a){},subscribe:function(b,a){},unsubscribe:function(b,a){},removeAllSubscriptionsForEvent:function(b){}}}();wpd=wpd||{};
wpd.Calibration=function(){return function(b){var a=[],d=[],c=null==b?2:b,e=[],f=[];this.labels=[];this.getCount=function(){return a.length};this.getDimensions=function(){return c};this.addPoint=function(b,f,p,m,h){var n=a.length,l=e.length;a[n]=b;d[n]=f;e[l]=p;e[l+1]=m;3===c&&(e[l+2]=h)};this.getPoint=function(b){return 0>b||b>=a.length?null:{px:a[b],py:d[b],dx:e[c*b],dy:e[c*b+1],dz:2===c?null:e[c*b+2]}};this.changePointPx=function(b,c,f){0>b||b>=a.length||(a[b]=c,d[b]=f)};this.setDataAt=function(b,
d,f,m){0>b||b>=a.length||(e[c*b]=d,e[c*b+1]=f,3===c&&(e[c*b+2]=m))};this.findNearestPoint=function(b,c,f){f=null==f?50:parseFloat(f);var e,h=-1,n,l;for(n=0;n<a.length;n++)if(l=Math.sqrt((b-a[n])*(b-a[n])+(c-d[n])*(c-d[n])),0>h&&l<=f||0<=h&&l<e)h=n,e=l;return h};this.selectPoint=function(a){0>f.indexOf(a)&&(f[f.length]=a)};this.selectNearestPoint=function(a,b,d){a=this.findNearestPoint(a,b,d);0<=a&&this.selectPoint(a)};this.getSelectedPoints=function(){return f};this.unselectAll=function(){f=[]};this.isPointSelected=
function(a){return 0<=f.indexOf(a)};this.dump=function(){console.log(a);console.log(d);console.log(e)}}}();
wpd.DataSeries=function(){return function(b){var a=[],d=[],c=!1,e=[];this.name="Data Series";this.variableNames=["x","y"];this.hasMetadata=function(){return c};this.setMetadataKeys=function(a){e=a};this.getMetadataKeys=function(){return e};this.addPixel=function(b,d,e){a[a.length]={x:b,y:d,metadata:e};null!=e&&(c=!0)};this.getPixel=function(b){return a[b]};this.setPixelAt=function(b,d,c){b<a.length&&(a[b].x=d,a[b].y=c)};this.setMetadataAt=function(b,d){b<a.length&&(a[b].metadata=d)};this.insertPixel=
function(b,d,c,e){a.splice(b,0,{x:d,y:c,metadata:e})};this.removePixelAtIndex=function(b){b<a.length&&a.splice(b,1)};this.removeLastPixel=function(){this.removePixelAtIndex(a.length-1)};this.findNearestPixel=function(b,d,c){c=null==c?50:parseFloat(c);var e,m=-1,h,n;for(h=0;h<a.length;h++)if(n=Math.sqrt((b-a[h].x)*(b-a[h].x)+(d-a[h].y)*(d-a[h].y)),0>m&&n<=c||0<=m&&n<e)m=h,e=n;return m};this.removeNearestPixel=function(a,b,d){a=this.findNearestPixel(a,b,d);0<=a&&this.removePixelAtIndex(a)};this.clearAll=
function(){a=[];c=!1;e=[]};this.getCount=function(){return a.length};this.selectPixel=function(a){0<=d.indexOf(a)||(d[d.length]=a)};this.unselectAll=function(){d=[]};this.selectNearestPixel=function(a,b,d){a=this.findNearestPixel(a,b,d);0<=a&&this.selectPixel(a)};this.getSelectedPixels=function(){return d}}}();
wpd.PlotData=function(){return function(){var b=0,a=new wpd.AutoDetector;this.axes=this.topColors=null;this.dataSeriesColl=[];this.distanceMeasurementData=this.angleMeasurementData=null;this.getActiveDataSeries=function(){null==this.dataSeriesColl[b]&&(this.dataSeriesColl[b]=new wpd.DataSeries);return this.dataSeriesColl[b]};this.getDataSeriesCount=function(){return this.dataSeriesColl.length};this.setActiveDataSeriesIndex=function(a){b=a};this.getAutoDetector=function(){return a};this.getDataFromActiveSeries=
function(){var a=this.getActiveDataSeries();if(null==a||null==this.axes)return null;var c,e,f,g=[],k;c=a.hasMetadata();e=a.getMetadataKeys();var p=!0===c?e.length:0;for(c=0;c<a.getCount();c++){e=this.dataSeriesColl[b].getPixel(c);f=this.axes.pixelToData(e.x,e.y);g[c]=[];for(k=0;k<f.length;k++)g[c][k]=f[k];for(k=0;k<p;k++)g[c][f.length+k]=e.metadata[k]}return g};this.reset=function(){this.distanceMeasurementData=this.angleMeasurementData=this.axes=null;this.dataSeriesColl=[];b=0;a=new wpd.AutoDetector}}}();
wpd.ConnectedPoints=function(){return function(b){var a=[],d=-1,c=-1;this.addConnection=function(b){a[a.length]=b};this.clearAll=function(){a=[]};this.getConnectionAt=function(b){if(b<a.length)return a[b]};this.replaceConnectionAt=function(b,d){b<a.length&&(a[b]=d)};this.deleteConnectionAt=function(b){b<a.length&&a.splice(b,1)};this.connectionCount=function(){return a.length};this.getDistance=function(d){if(d<a.length&&2===b)return Math.sqrt((a[d][0]-a[d][2])*(a[d][0]-a[d][2])+(a[d][1]-a[d][3])*(a[d][1]-
a[d][3]))};this.getAngle=function(d){if(d<a.length&&3===b){var c=wpd.taninverse(-(a[d][5]-a[d][3]),a[d][4]-a[d][2]);d=wpd.taninverse(-(a[d][1]-a[d][3]),a[d][0]-a[d][2]);c=180*(c-d)/Math.PI;return c=0>c?c+360:c}};this.findNearestPointAndConnection=function(d,c){var g=-1,k=-1,p,m,h,n;for(h=0;h<a.length;h++)for(n=0;n<2*b;n+=2)if(m=(a[h][n]-d)*(a[h][n]-d)+(a[h][n+1]-c)*(a[h][n+1]-c),-1===k||m<p)g=h,k=n/2,p=m;return{connectionIndex:g,pointIndex:k}};this.selectNearestPoint=function(a,b){var g=this.findNearestPointAndConnection(a,
b);0<=g.connectionIndex&&(d=g.connectionIndex,c=g.pointIndex)};this.deleteNearestConnection=function(a,b){var d=this.findNearestPointAndConnection(a,b);0<=d.connectionIndex&&this.deleteConnectionAt(d.connectionIndex)};this.isPointSelected=function(a,b){return c===b&&d===a?!0:!1};this.getSelectedConnectionAndPoint=function(){return{connectionIndex:d,pointIndex:c}};this.unselectConnectionAndPoint=function(){c=d=-1};this.setPointAt=function(b,d,c,k){a[b][2*d]=c;a[b][2*d+1]=k};this.getPointAt=function(b,
d){return{x:a[b][2*d],y:a[b][2*d+1]}}}}();wpd=wpd||{};
wpd.dateConverter=function(){function b(a,b){var c;c=b.replace("YYYY","yyyy");c=c.replace("YY","yy");c=c.replace("MMMM","mmmm");c=c.replace("MMM","mmm");c=c.replace("MM","mm");c=c.replace("DD","dd");c=c.replace("yyyy",a.getUTCFullYear());var e=a.getUTCFullYear()%100;c=c.replace("yy",10>e?"0"+e:e);c=c.replace("mmmm","January February March April May June July August September October November December".split(" ")[a.getUTCMonth()]);c=c.replace("mmm","Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]);
c=c.replace("mm",a.getUTCMonth()+1);return c=c.replace("dd",a.getUTCDate())}return{parse:function(a){if(null==a||0>a.indexOf("/"))a=null;else{var b=a.split("/"),c;0>=b.length||3<b.length?a=null:(a=parseInt(b[0],10),c=parseInt(void 0===b[1]?0:b[1],10),date=parseInt(void 0===b[2]?1:b[2],10),isNaN(a)||isNaN(c)||isNaN(date)||12<c||1>c||31<date||1>date?a=null:(b=new Date,b.setUTCFullYear(a),b.setUTCMonth(c-1),b.setUTCDate(date),a=parseFloat(Date.parse(b)),a=isNaN(a)?null:a))}return a},getFormatString:function(a){a=
a.split("/");var b="yyyy/mm/dd";1<=a.length&&(b="yyyy");2<=a.length&&(b+="/mm");3===a.length&&(b+="/dd");return b},formatDate:b,formatDateNumber:function(a,d){var c;c=parseFloat(a);c=parseInt(864E5*Math.round(c/864E5),10);return b(new Date(c),d)}}}();wpd=wpd||{};
wpd.InputParser=function(){return function(){this.parse=function(b){this.isDate=this.isValid=!1;this.formatting=null;if(null==b)return null;b=b.trim();if(0<=b.indexOf("^"))return null;var a=wpd.dateConverter.parse(b);if(null!=a)return this.isDate=this.isValid=!0,this.formatting=wpd.dateConverter.getFormatString(b),a;b=parseFloat(b);return isNaN(b)?null:(this.isValid=!0,b)};this.isDate=this.isValid=!1;this.formatting=null}}();wpd=wpd||{};
wpd.taninverse=function(b,a){var d;0<b?d=Math.atan2(b,a):0>=b&&(d=Math.atan2(b,a)+2*Math.PI);d>=2*Math.PI&&(d=0);return d};wpd=wpd||{};
wpd.AveragingWindowAlgo=function(){return function(){var b=5,a=5;this.getParamList=function(){return[["\u0394X","Px",10],["\u0394Y","Px",10]]};this.setParam=function(d,c){0===d?b=c:1===d&&(a=c)};this.run=function(d){var c=d.getAutoDetector();d=d.getActiveDataSeries();var e=[],f=0,g=c.imageWidth,k=c.imageHeight,p=[],m,h,n,l,r,q;d.clearAll();for(m=0;m<g;m++){r=-1;n=-2*a;for(h=l=0;h<k;h++)!0===c.binaryData[h*g+m]&&(h>n+a?(r+=1,l=1,n=p[r]=h):(l+=1,p[r]=parseFloat((p[r]*(l-1)+h)/parseFloat(l))));if(0<=
r)for(n=m,h=0;h<=r;h++)l=p[h],e[f]=[],e[f][0]=parseFloat(n),e[f][1]=parseFloat(l),e[f][2]=!0,f+=1}if(0!==f)for(c=0;c<f;c++)if(!0===e[c][2]){g=!0;k=c+1;p=e[c][0];m=e[c][1];r=p;h=m;for(q=1;!0===g&&k<f;)n=e[k][0],l=e[k][1],Math.abs(n-p)<=b&&Math.abs(l-m)<=a&&!0===e[k][2]&&(r=(r*q+n)/(q+1),h=(h*q+l)/(q+1),q+=1,e[k][2]=!1),n>p+2*b&&(g=!1),k+=1;e[c][2]=!1;d.addPixel(parseFloat(r),parseFloat(h))}}}}();wpd=wpd||{};
wpd.AveragingWindowWithStepSizeAlgo=function(){return function(){var b,a,d,c,e,f;this.getParamList=function(){var a=wpd.appData.isAligned(),b=wpd.appData.getPlotData().axes;return a&&b instanceof wpd.XYAxes?(a=b.getBounds(),[["X_min","Units",a.x1],["\u0394X Step","Units",0.1],["X_max","Units",a.x2],["Y_min","Units",a.y3],["Y_max","Units",a.y4],["Line width","Px",30]]):[["X_min","Units",0],["\u0394X Step","Units",0.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Line width","Px",30]]};
this.setParam=function(g,k){0===g?b=k:1===g?a=k:2===g?d=k:3===g?e=k:4===g?f=k:5===g&&(c=k)};this.run=function(g){var k=g.getAutoDetector(),p=g.getActiveDataSeries();g=g.axes;var m=k.imageWidth,h=k.imageHeight,n,l,r,q,s,t,u,w,v;p.clearAll();for(n=b;n<=d;n+=a)for(v=g.dataToPixel(n,e),l=v.x,q=v.y,v=g.dataToPixel(n,f),r=v.x,s=v.y,l=Math.sqrt((s-q)*(s-q)+(r-l)*(r-l)),r=(f-e)/l,q=!1,t=s=0,u=!1,w=0;w<=l;w++)v=1*-w*r+f,v=g.dataToPixel(n,v),xi_pix=v.x,yi_pix=v.y,0<=xi_pix&&xi_pix<m&&0<=yi_pix&&yi_pix<h&&(!0===
k.binaryData[parseInt(yi_pix,10)*m+parseInt(xi_pix,10)]?(!1===q&&(t=s=w,q=!0,u=!1),!0===u&&(t=w,u=!1)):!1===u&&(t=w,u=!0),!0===q&&(w>s+c||w==l-1)&&(q=!1,s>t&&(t=w),v=(s+t)/2,v=1*-v*r+f,v=g.dataToPixel(n,v),p.addPixel(parseFloat(v.x),parseFloat(v.y))))}}}();wpd=wpd||{};
wpd.BlobDetectorAlgo=function(){return function(){this.getParamList=function(){return[]};this.setParam=function(b,a){};this.run=function(b){var a=b.getAutoDetector(),d=b.getActiveDataSeries(),c=a.imageWidth,e=a.imageHeight,f=[],g=[],k,p,m,h,n,l,r,q,s;if(!(0>=c||0>=e||null==a.binaryData||0===a.binaryData.length)){d.clearAll();d.setMetadataKeys(["area","moment"]);for(k=0;k<c;k++)for(p=0;p<e;p++)if(!0===a.binaryData[p*c+k]&&!0!==f[p*c+k])for(f[p*c+k]=!0,h=g.length,g[h]={pixels:[{x:k,y:p}],centroid:{x:k,
y:p},area:1,moment:0},m=0;m<g[h].pixels.length;){r=g[h].pixels[m].x;q=g[h].pixels[m].y;for(n=r-1;n<=r+1;n++)for(l=q-1;l<=q+1;l++)0<=n&&0<=l&&n<c&&l<e&&!0!==f[l*c+n]&&!0===a.binaryData[l*c+n]&&(f[l*c+n]=!0,s=g[h].pixels.length,g[h].pixels[s]={x:n,y:l},g[h].centroid.x=(g[h].centroid.x*s+n)/(s+1),g[h].centroid.y=(g[h].centroid.y*s+l)/(s+1),g[h].area+=1);m+=1}for(h=0;h<g.length;h++){for(m=g[h].moment=0;m<g[h].pixels.length;m++)g[h].moment=g[h].moment+(g[h].pixels[m].x-g[h].centroid.x)*(g[h].pixels[m].x-
g[h].centroid.x)+(g[h].pixels[m].y-g[h].centroid.y)*(g[h].pixels[m].y-g[h].centroid.y);b.axes instanceof wpd.MapAxes&&(g[h].area=b.axes.pixelToDataArea(g[h].area));d.addPixel(g[h].centroid.x,g[h].centroid.y,[g[h].area,g[h].moment])}}}}}();
var xStepAlgo={getParamList:function(){return[["\u0394X","Px","5"],["Line Width","Px","15"]]},run:function(){xyData=[];pointsPicked=0;resetLayers();for(var b=document.getElementById("pv0"),b=parseFloat(b.value),a=document.getElementById("pv1"),a=parseFloat(a.value),d=canvasWidth,c=canvasHeight,e=[],f=1,g=0;g<d;){blobs=-1;firstbloby=-2*a;for(var k=bi=0;k<c;k++)!0===binaryData[k][g]&&(f=b,k>firstbloby+a?(blobs+=1,bi=1,firstbloby=e[blobs]=k):(bi+=1,e[blobs]=parseFloat((e[blobs]*(bi-1)+k)/parseFloat(bi))));
if(0<=blobs)for(xi=g,k=0;k<=blobs;k++)yi=e[k],xyData[pointsPicked]=[],xyData[pointsPicked][0]=parseFloat(xi),xyData[pointsPicked][1]=parseFloat(yi),pointsPicked+=1;g+=f}}},wpd=wpd||{};
wpd.XStepWithInterpolationAlgo=function(){return function(){var b,a,d,c,e,f;this.getParamList=function(){var a=wpd.appData.isAligned(),b=wpd.appData.getPlotData().axes;return a&&b instanceof wpd.XYAxes?(a=b.getBounds(),[["X_min","Units",a.x1],["\u0394X Step","Units",(a.x2-a.x1)/50],["X_max","Units",a.x2],["Y_min","Units",a.y3],["Y_max","Units",a.y4],["Width","Units",0]]):[["X_min","Units",0],["\u0394X Step","Units",0.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Width","Units",
0]]};this.setParam=function(g,k){0===g?b=k:1===g?a=k:2===g?d=k:3===g?e=k:4===g?f=k:5===g&&(c=k)};this.run=function(g){var k=g.getAutoDetector(),p=g.getActiveDataSeries();g=g.axes;var m=0,h=k.imageWidth,n=k.imageHeight,l,r,q,s,t,u=[],w=[];t=[];var v=[],z;p.clearAll();l=g.dataToPixel(b,e);r=g.dataToPixel(b,f);r=Math.sqrt((l.x-r.x)*(l.x-r.x)+(l.y-r.y)*(l.y-r.y));v=(f-e)/r;r=g.dataToPixel(d,e);l=Math.sqrt((l.x-r.x)*(l.x-r.x)+(l.y-r.y)*(l.y-r.y));z=(d-b)/l;for(l=b;0<z&&l<=d||0>z&&l>=d;){r=s=0;for(q=e;0<
v&&q<=f||0>v&&q>=f;)t=g.dataToPixel(l,q),0<t.x&&0<t.y&&t.x<h&&t.y<n&&!0===k.binaryData[parseInt(t.y,10)*h+parseInt(t.x,10)]&&(s=(s*r+q)/parseFloat(r+1),r++),q+=v;0<r&&(u[m]=parseFloat(l),w[m]=parseFloat(s),m+=1);l+=z}if(!(0>=u.length||0>=w.length)){if(0<c)for(t=[],v=[],l=u[0];0<z&&l<=u[u.length-1]||0>z&&l>=u[u.length-1];){for(k=r=h=m=0;k<u.length;k++)u[k]<l+c&&u[k]>l-c&&(m=(m*r+u[k])/parseFloat(r+1),h=(h*r+w[k])/parseFloat(r+1),r++);0<r&&(t[t.length]=m,v[v.length]=h);l=0<z?l+c:l-c}else t=u,v=w;if(!(0>=
t.length||0>=v.length)){u=[];k=0;for(l=b;l<=d;l+=a)u[k]=l,k++;w=numeric.spline(t,v).at(u);for(k=0;k<w.length;k++)isNaN(u[k])||isNaN(w[k])||(t=g.dataToPixel(u[k],w[k]),p.addPixel(t.x,t.y))}}}}}();
var yStepAlgo={getParamList:function(){return[["\u0394Y","Px","5"],["Line Width","Px","15"]]},run:function(){xyData=[];pointsPicked=0;resetLayers();for(var b=document.getElementById("pv0"),b=parseFloat(b.value),a=document.getElementById("pv1"),a=parseFloat(a.value),d=canvasWidth,c=[],e=-1,f=canvasHeight-1;0<=f;){blobs=-1;firstblobx=-2*a;for(var g=bi=0;g<d;g++)!0===binaryData[f][g]&&(e=-b,g>firstblobx+a?(blobs+=1,bi=1,firstblobx=c[blobs]=g):(bi+=1,c[blobs]=parseFloat((c[blobs]*(bi-1)+g)/parseFloat(bi))));
if(0<=blobs)for(yi=f,g=0;g<=blobs;g++)xi=c[g],xyData[pointsPicked]=[],xyData[pointsPicked][0]=parseFloat(xi),xyData[pointsPicked][1]=parseFloat(yi),pointsPicked+=1;f+=e}}},wpd=wpd||{};
wpd.ImageAxes=function(){var b=function(){this.isCalibrated=function(){return!0};this.calibrate=function(){return!0};this.pixelToData=function(a,b){return[a,b]};this.dataToPixel=function(a,b){return{x:a,y:b}};this.pixelToLiveString=function(a,b){var c=this.pixelToData(a,b);return c[0].toFixed(2)+", "+c[1].toFixed(2)}};b.prototype.numCalibrationPointsRequired=function(){return 0};b.prototype.getDimensions=function(){return 2};b.prototype.getAxesLabels=function(){return["X","Y"]};return b}();
wpd=wpd||{};
wpd.MapAxes=function(){var b=function(){var a=!1,b,c,e;this.isCalibrated=function(){return a};this.calibrate=function(f,g,k){var p=f.getPoint(0);f=f.getPoint(1);e=Math.sqrt((p.px-f.px)*(p.px-f.px)+(p.py-f.py)*(p.py-f.py));b=parseFloat(g);c=k;return a=!0};this.pixelToData=function(a,c){var k=[];k[0]=a*b/e;k[1]=c*b/e;return k};this.pixelToDataDistance=function(a){return a*b/e};this.pixelToDataArea=function(a){return a*b*b/(e*e)};this.dataToPixel=function(a,b,d){return{x:0,y:0}};this.pixelToLiveString=function(a,
b){var d=this.pixelToData(a,b);return d[0].toExponential(4)+", "+d[1].toExponential(4)};this.getUnits=function(){return c}};b.prototype.numCalibrationPointsRequired=function(){return 2};b.prototype.getDimensions=function(){return 2};b.prototype.getAxesLabels=function(){return["X","Y"]};return b}();wpd=wpd||{};
wpd.PolarAxes=function(){var b=function(){var a=!1,b=!1,c,e,f,g,k,p,m,h,n,l,r,q,s,t;processCalibration=function(a,w,v){v=a.getPoint(0);var z=a.getPoint(1);a=a.getPoint(2);c=v.px;e=v.py;f=z.px;g=z.py;k=a.px;p=a.py;m=z.dx;h=z.dy;n=a.dx;b=w;!0===b&&(h*=Math.PI/180);l=Math.sqrt((f-c)*(f-c)+(g-e)*(g-e));r=Math.sqrt((k-c)*(k-c)+(p-e)*(p-e));q=r-l;s=wpd.taninverse(-(g-e),f-c);t=s-h;return!0};this.isCalibrated=function(){return a};this.calibrate=function(b,d,c){return a=processCalibration(b,d,c)};this.pixelToData=
function(a,f){var k=[],g,h;xp=parseFloat(a);yp=parseFloat(f);g=(n-m)/q*(Math.sqrt((xp-c)*(xp-c)+(yp-e)*(yp-e))-l)+m;h=wpd.taninverse(-(yp-e),xp-c)-t;!0==b&&(h=180*h/Math.PI);k[0]=g;k[1]=h;return k};this.dataToPixel=function(a,b){return{x:0,y:0}};this.pixelToLiveString=function(a,b){var d=this.pixelToData(a,b);return d[0].toExponential(4)+", "+d[1].toExponential(4)}};b.prototype.numCalibrationPointsRequired=function(){return 3};b.prototype.getDimensions=function(){return 2};b.prototype.getAxesLabels=
function(){return["r","\u03b8"]};return b}();wpd=wpd||{};
wpd.TernaryAxes=function(){var b=function(){var a=!1,b,c,e,f,g,k,p,m,h;this.isCalibrated=function(){return a};this.calibrate=function(n,l,r){var q=n.getPoint(0),s=n.getPoint(1);n.getPoint(2);b=q.px;c=q.py;e=s.px;f=s.py;g=Math.sqrt((b-e)*(b-e)+(c-f)*(c-f));k=wpd.taninverse(-(f-c),e-b);p=Math.sqrt(3);m=l;h=r;return a=!0};this.pixelToData=function(a,f){var e=[],q,s,t,u;xp=parseFloat(a);yp=parseFloat(f);q=Math.sqrt((xp-b)*(xp-b)+(yp-c)*(yp-c));s=wpd.taninverse(-(yp-c),xp-b)-k;t=q*Math.cos(s)/g;s=q*Math.sin(s)/
g;q=1-t-s/p;t-=s/p;s=2*s/p;!1==h&&(u=t,t=q,q=s,s=u);!0==m&&(q*=100,t*=100,s*=100);e[0]=q;e[1]=t;e[2]=s;return e};this.dataToPixel=function(a,b,d){return{x:0,y:0}};this.pixelToLiveString=function(a,b){var d=this.pixelToData(a,b);return d[0].toExponential(4)+", "+d[1].toExponential(4)+", "+d[2].toExponential(4)}};b.prototype.numCalibrationPointsRequired=function(){return 3};b.prototype.getDimensions=function(){return 3};b.prototype.getAxesLabels=function(){return["a","b","c"]};return b}();
wpd=wpd||{};
wpd.XYAxes=function(){var b=function(){var a=!1,b=!1,c=!1,e=!1,f=!1,g,k,p,m,h,n,l,r,q,s,t,u,w,v,z,F,H,J,D,E,I,G,P,Q=function(a,U,L){if(4>a.getCount())return!1;var R=a.getPoint(0),M=a.getPoint(1),O=a.getPoint(2);a=a.getPoint(3);var y=new wpd.InputParser;p=R.px;l=R.py;m=M.px;r=M.py;h=O.px;q=O.py;n=a.px;s=a.py;t=R.dx;u=M.dx;w=O.dy;v=a.dy;t=y.parse(t);if(!y.isValid)return!1;e=y.isDate;u=y.parse(u);if(!y.isValid||y.isDate!=e)return!1;g=y.formatting;w=y.parse(w);if(!y.isValid)return!1;f=y.isDate;v=y.parse(v);
if(!y.isValid||y.isDate!=f)return!1;k=y.formatting;b=U;c=L;!0===b&&(t=Math.log(t)/Math.log(10),u=Math.log(u)/Math.log(10));!0===c&&(w=Math.log(w)/Math.log(10),v=Math.log(v)/Math.log(10));z=u-t;F=v-w;H=Math.sqrt((p-m)*(p-m)+(l-r)*(l-r));J=Math.sqrt((h-n)*(h-n)+(q-s)*(q-s));D=z/H;E=F/J;I=wpd.taninverse(-(r-l),m-p);G=wpd.taninverse(-(s-q),n-h);P=G-I;return!0};this.getBounds=function(){return{x1:t,x2:u,y3:w,y4:v}};this.isCalibrated=function(){return a};this.calibrate=function(b,d,c){return a=Q(b,d,c)};
this.pixelToData=function(a,f){var e=[],k,g,m,n;k=parseFloat(a);g=parseFloat(f);m=Math.sqrt((k-p)*(k-p)+(g-l)*(g-l));n=wpd.taninverse(-(g-l),k-p)-I;m=(m*Math.cos(n)-m*Math.sin(n)/Math.tan(P))*D+t;n=Math.sqrt((k-h)*(k-h)+(g-q)*(g-q));k=G-wpd.taninverse(-(g-q),k-h);k=(n*Math.cos(k)-n*Math.sin(k)/Math.tan(P))*E+w;!0===b&&(m=Math.pow(10,m));!0===c&&(k=Math.pow(10,k));e[0]=m;e[1]=k;return e};this.dataToPixel=function(a,b){var d,c;d=(p-m)*(q-s)-(l-r)*(h-n);c=this.pixelToData(((p*r-l*m)*(h-n)-(p-m)*(h*s-
q*n))/d,((p*r-l*m)*(q-s)-(l-r)*(h*s-q*n))/d);d=c[0];c=c[1];c=(a-t)*Math.cos(I)/D+(b-c)*Math.cos(G)/E+p;d=q-(a-d)*Math.sin(I)/D-(b-w)*Math.sin(G)/E;return{x:c,y:d}};this.pixelToLiveString=function(a,b){var d="",c=this.pixelToData(a,b),d=e?d+wpd.dateConverter.formatDateNumber(c[0],g):d+c[0].toExponential(4),d=d+", ";return d=f?d+wpd.dateConverter.formatDateNumber(c[1],k):d+c[1].toExponential(4)};this.isDate=function(a){return 0===a?e:f};this.getInitialDateFormat=function(a){return 0===a?g:k};this.isLogX=
function(){return b};this.isLogY=function(){return c}};b.prototype.numCalibrationPointsRequired=function(){return 4};b.prototype.getDimensions=function(){return 2};b.prototype.getAxesLabels=function(){return["X","Y"]};return b}();wpd=wpd||{};
wpd.dataTable=function(){function b(){e=wpd.appData.getPlotData().getDataFromActiveSeries()}function a(){f=e.slice(0);var a=document.getElementById("data-sort-variables").value,b="ascending"===document.getElementById("data-sort-order").value,d="raw"===a,c="NearestNeighbor"===a,g,l=wpd.appData.getPlotData().axes.getDimensions();if(!d)if(!c)g=parseInt(a,10),f.sort(function(a,d){return a[g]>d[g]?b?1:-1:a[g]<d[g]?b?-1:1:0});else if(c){var r,c=[1,1,1],q,s,t=e.length;for(q=0;q<t-1;q++){d=-1;for(s=q+1;s<
t;s++)if(a=(f[q][0]-f[s][0])*(f[q][0]-f[s][0])+(f[q][1]-f[s][1])*(f[q][1]-f[s][1]),3===l&&(a+=(f[q][2]-f[s][2])*(f[q][2]-f[s][2])),a<r||-1===d)r=a,d=s;c[0]=f[d][0];f[d][0]=f[q+1][0];f[q+1][0]=c[0];c[1]=f[d][1];f[d][1]=f[q+1][1];f[q+1][1]=c[1];3===l&&(c[2]=f[d][2],f[d][2]=f[q+1][2],f[q+1][2]=c[2])}}}function d(){var a=document.getElementById("data-sort-variables").value,b=document.getElementById("data-sort-order");"NearestNeighbor"===a||"raw"===a?b.setAttribute("disabled",!0):b.removeAttribute("disabled")}
function c(){if(null!=e){var a=wpd.appData.getPlotData().axes,b=wpd.appData.getPlotData().getActiveDataSeries(),d=a.getDimensions(),b=b.getMetadataKeys().length,c=e.length,n,l,r,q=document.getElementById("digitizedDataTable"),s=[];g="";for(n=0;n<c;n++){r=[];for(l=0;l<d+b;l++)l<d&&null!=a.isDate&&a.isDate(l)?(void 0===s[l]&&(s[l]=document.getElementById("data-format-string-"+l).value),r[l]=wpd.dateConverter.formatDateNumber(f[n][l],s[l])):r[l]=f[n][l];g+=r.join(", ");g+="\n"}q.value=g}}var e,f,g;return{getSeriesData:b,
showTable:function(){if(wpd.appData.isAligned()){wpd.popup.show("csvWindow");b();var f=document.getElementById("data-sort-variables"),g=document.getElementById("dataVariables"),e=document.getElementById("data-date-formatting-container"),h=document.getElementById("data-date-formatting"),n=wpd.appData.getPlotData().axes,l=wpd.appData.getPlotData().getActiveDataSeries(),r=n.getAxesLabels(),q="",s=r.join(", "),t="";isAnyVariableDate=!1;tableVariables=r;dimCount=n.getDimensions();l.hasMetadata()&&(tableVariables=
r.concat(l.getMetadataKeys()),s=tableVariables.join(", "));e.style.display="none";q+='<option value="raw">Raw</option>';for(l=0;l<tableVariables.length;l++)q+='<option value="'+l+'">'+tableVariables[l]+"</option>",l<dimCount&&null!=n.isDate&&null!=n.getInitialDateFormat&&n.isDate(l)&&(t+=r[l]+' <input type="text" length="15" value="'+n.getInitialDateFormat(l)+'" id="data-format-string-'+l+'"/>',isAnyVariableDate=!0);f.innerHTML=q+'<option value="NearestNeighbor">Nearest Neighbor</option>';g.innerHTML=
s;isAnyVariableDate&&(e.style.display="inline-block",h.innerHTML=t);a();c();d()}},updateSortingControls:d,reSort:function(){d();a();c()},selectAll:function(){var a=document.getElementById("digitizedDataTable");a.focus();a.select()},generateCSV:function(){var a,b,d,c=JSON.stringify(g);a=document.createElement("div");b=document.createElement("form");d=document.createElement("input");b.setAttribute("method","post");b.setAttribute("action","php/csvexport.php");d.setAttribute("type","text");d.setAttribute("name",
"data");b.appendChild(d);a.appendChild(b);document.body.appendChild(a);a.style.display="none";d.setAttribute("value",c);b.submit();document.body.removeChild(a)},exportToPlotly:function(){if(null!=e&&0!==e.length){var a=document.createElement("div"),b=document.createElement("form"),d=document.createElement("input");b.setAttribute("method","post");b.setAttribute("action","https://plot.ly/external");b.setAttribute("target","_blank");d.setAttribute("type","text");d.setAttribute("name","data");b.appendChild(d);
a.appendChild(b);document.body.appendChild(a);a.style.display="none";var c={data:[]},g=wpd.appData.getPlotData().axes,l=wpd.appData.getPlotData().getActiveDataSeries().getMetadataKeys(),r=l.length,q=g.getDimensions(),s=e.length,t,u,w=["x","y","z"];c.data[0]={};for(t=0;t<s;t++)for(rowValues=[],u=0;u<q+r;u++)0===t&&(u<q?c.data[0][w[u]]=[]:c.data[0][l[u-q]]=[]),u<q&&null!=g.isDate&&g.isDate(u)?c.data[0][w[u]][t]=wpd.dateConverter.formatDateNumber(f[t][u],"yyyy-mm-dd"):u<q?c.data[0][w[u]][t]=f[t][u]:
c.data[0][l[u-q]][t]=f[t][u];d.setAttribute("value",JSON.stringify(c));b.submit();document.body.removeChild(a)}}}}();wpd=wpd||{};
wpd.graphicsWidget=function(){function b(a){var b=F.getBoundingClientRect();return{x:parseInt(a.pageX-(b.left+window.pageXOffset),10),y:parseInt(a.pageY-(b.top+window.pageYOffset),10)}}function a(a,b){return{x:a/K,y:b/K}}function d(a,b){a=parseInt(a,10);b=parseInt(b,10);P.style.width=a+"px";P.style.height=b+"px";F.width=a;H.width=a;J.width=a;D.width=a;E.width=a;F.height=b;H.height=b;J.height=b;D.height=b;E.height=b;X=a/(1*b);y=a;N=b;if(null!=S){Q.fillStyle="rgb(255, 255, 255)";Q.fillRect(0,0,y,N);
Q.drawImage(I,0,0,y,N);if(null!=A&&void 0!=A.onRedraw)A.onRedraw();if(null!=x&&void 0!=x.onRedraw)x.onRedraw()}}function c(){F.width=F.width;H.width=H.width;J.width=J.width;D.width=D.width;E.width=E.width;G.width=G.width}function e(){if(null!=A&&void 0!=A.onRemove)A.onRemove();A=null}function f(){var a=wpd.layoutManager.getGraphicsViewportSize();d(a.width,a.height);X>T?(K=N/(1*B),d(N*T,N)):(K=y/(1*C),d(y,y/T))}function g(a){K=a;d(C*K,B*K)}function k(a){220===a.keyCode&&(a.preventDefault(),W=!W,D.width=
D.width)}function p(a,b){var d=wpd.zoomView.getSize(),c=wpd.zoomView.getZoomRatio(),f,g,e,k,h,l,m,p=0,n=0,q=d.width,r=d.height;e=d.width/c;k=d.height/c;f=a-e/2;g=b-k/2;l=f;d=g;h=f+e;m=g+k;0>f&&(l=0,p=-f*c);0>g&&(d=0,n=-g*c);f+e>=C&&(h=C,q-=c*(C-(f+e)));g+k>=B&&(m=B,r-=c*(B-(g+k)));e=M.getImageData(parseInt(l,10),parseInt(d,10),parseInt(h-l,10),parseInt(m-d,10));h=O.getImageData(parseInt(l,10),parseInt(d,10),parseInt(h-l,10),parseInt(m-d,10));for(m=0;m<h.data.length;m+=4)if(0!=h.data[m]||0!=h.data[m+
1]||0!=h.data[m+2])e.data[m]=h.data[m],e.data[m+1]=h.data[m+1],e.data[m+2]=h.data[m+2];l=c*(parseInt(l,10)-l);c*=parseInt(d,10)-d;wpd.zoomView.setZoomImage(e,parseInt(p+l,10),parseInt(n+c,10),parseInt(q-p,10),parseInt(r-n,10))}function m(d){clearTimeout(Y);var c=setTimeout,f=b(d);d=f.x;var f=f.y,g=a(d,f);W&&(D.width=D.width,L.strokeStyle="rgba(0,0,0, 0.5)",L.beginPath(),L.moveTo(d,0),L.lineTo(d,N),L.moveTo(0,f),L.lineTo(y,f),L.stroke());p(g.x,g.y);wpd.zoomView.setCoords(g.x,g.y);Y=c(void 0,10)}function h(){F=
document.getElementById("mainCanvas");H=document.getElementById("dataCanvas");J=document.getElementById("drawCanvas");D=document.getElementById("hoverCanvas");E=document.getElementById("topCanvas");I=document.createElement("canvas");G=document.createElement("canvas");Q=F.getContext("2d");V=H.getContext("2d");L=D.getContext("2d");R=E.getContext("2d");U=J.getContext("2d");M=I.getContext("2d");O=G.getContext("2d");P=document.getElementById("canvasDiv");document.body.addEventListener("keydown",k,!1);
E.addEventListener("mousemove",m,!1);E.addEventListener("dragover",function(a){a.preventDefault()},!0);E.addEventListener("drop",function(a){a.preventDefault();a=a.dataTransfer.files;1===a.length&&l(a[0])},!0);E.addEventListener("mousemove",s,!1);E.addEventListener("click",t,!1);E.addEventListener("mouseup",w,!1);E.addEventListener("mousedown",v,!1);E.addEventListener("mouseout",z,!0);document.addEventListener("mouseup",u,!1);document.addEventListener("mousedown",function(a){Z=a.target===E?!0:!1},
!1);document.addEventListener("keydown",function(a){if(Z&&null!=x&&void 0!=x.onKeyDown)x.onKeyDown(a)},!0);wpd.zoomView.initZoom();document.getElementById("fileLoadBox").addEventListener("change",r);window.addEventListener("paste",function(a){if(void 0!==a.clipboardData&&(a=a.clipboardData.items,void 0!==a))for(var b=0;b<a.length;b++)if(-1!==a[b].type.indexOf("image")){var d=a[b].getAsFile();(window.URL||window.webkitURL).createObjectURL(d);l(d)}},!1)}function n(a){var b=document.createElement("img");
b.onload=function(){null==F&&h();wpd.appData.reset();wpd.sidebar.clear();q();e();C=b.width;B=b.height;T=C/(1*B);I.width=C;I.height=B;G.width=C;G.height=B;M.drawImage(b,0,0,C,B);S=M.getImageData(0,0,C,B);c();f();wpd.appData.plotLoaded(S);!1===$&&wpd.popup.show("axesList");$=!1};b.src=a}function l(a){if(a.type.match("image.*")){var b=new FileReader;b.onload=function(){n(b.result)};b.readAsDataURL(a)}}function r(){var a=document.getElementById("fileLoadBox");1==a.files.length&&l(a.files[0])}function q(){if(null!=
x&&void 0!=x.onRemove)x.onRemove();x=null}function s(d){if(null!=x&&void 0!=x.onMouseMove){var c=b(d),f=a(c.x,c.y);x.onMouseMove(d,c,f)}}function t(d){if(null!=x&&void 0!=x.onMouseClick){var c=b(d),f=a(c.x,c.y);x.onMouseClick(d,c,f)}}function u(d){if(null!=x&&void 0!=x.onDocumentMouseUp){var c=b(d),f=a(c.x,c.y);x.onDocumentMouseUp(d,c,f)}}function w(d){if(null!=x&&void 0!=x.onMouseUp){var c=b(d),f=a(c.x,c.y);x.onMouseUp(d,c,f)}}function v(d){if(null!=x&&void 0!=x.onMouseDown){var c=b(d),f=a(c.x,c.y);
x.onMouseDown(d,c,f)}}function z(d){if(null!=x&&void 0!=x.onMouseOut){var c=b(d),f=a(c.x,c.y);x.onMouseOut(d,c,f)}}var F,H,J,D,E,I,G,P,Q,V,U,L,R,M,O,y,N,C,B,T,X,S,K,W=!1,Y,x,A,Z=!1,$=!0;return{zoomIn:function(){g(1.2*K)},zoomOut:function(){g(K/1.2)},zoomFit:f,zoom100perc:function(){g(1)},setZoomRatio:g,getZoomRatio:function(){return K},loadImageFromURL:n,runImageOp:function(a){var b=a(S,C,B);a=b.imageData;var d=b.width,b=b.height;wpd.appData.reset();q();e();C=d;B=b;T=C/(1*B);I.width=C;I.height=B;
G.width=C;G.height=B;M.putImageData(a,0,0);S=a;c();f();wpd.appData.plotLoaded(S)},setTool:function(a){if(null!=x&&void 0!=x.onRemove)x.onRemove();x=a;if(null!=x&&void 0!=x.onAttach)x.onAttach()},removeTool:q,getAllContexts:function(){return{mainCtx:Q,dataCtx:V,drawCtx:U,hoverCtx:L,topCtx:R,oriImageCtx:M,oriDataCtx:O}},resetData:function(){G.width=G.width;H.width=H.width},resetHover:function(){D.width=D.width},imagePx:a,screenPx:function(a,b){return{x:a*K,y:b*K}},updateZoomOnEvent:function(d){d=b(d);
d=a(d.x,d.y);p(d.x,d.y);wpd.zoomView.setCoords(d.x,d.y)},updateZoomToImagePosn:function(a,b){p(a,b);wpd.zoomView.setCoords(a,b)},getDisplaySize:function(){return{width:y,height:N}},getImageSize:function(){return{width:C,height:B}},copyImageDataLayerToScreen:function(){V.drawImage(G,0,0,y,N)},setRepainter:function(a){if(null==A||void 0==A.painterName||null==a||void 0==a.painterName||A.painterName!=a.painterName){if(null!=A&&void 0!=A.onRemove)A.onRemove();A=a;if(null!=A&&void 0!=A.onAttach)A.onAttach()}},
removeRepainter:e,forceHandlerRepaint:function(){if(null!=A&&void 0!=A.onForcedRedraw)A.onForcedRedraw()},getRepainter:function(){return A},saveImage:function(){var a=document.createElement("canvas"),b=a.getContext("2d"),d,c,f;a.width=C;a.height=B;b.drawImage(I,0,0,C,B);d=b.getImageData(0,0,C,B);f=O.getImageData(0,0,C,B);for(c=0;c<d.data.length;c+=4)if(0!=f.data[c]||0!=f.data[c+1]||0!=f.data[c+2])d.data[c]=f.data[c],d.data[c+1]=f.data[c+1],d.data[c+2]=f.data[c+2];b.putImageData(d,0,0);window.open(a.toDataURL(),
"_blank")}}}();wpd=wpd||{};
wpd.layoutManager=function(){function b(){var a=parseInt(document.body.offsetWidth,10),b=parseInt(document.body.offsetHeight,10);e.style.height=b+"px";f.style.height=b-280+"px";g.style.width=a-e.offsetWidth-5+"px";g.style.height=b+"px";c.style.height=b-44+"px";wpd.sidebar.resize()}function a(a){clearTimeout(d);d=setTimeout(b,80)}var d,c,e,f,g;return{initialLayout:function(){c=document.getElementById("graphicsContainer");e=document.getElementById("sidebarContainer");f=document.getElementById("sidebarControlsContainer");g=
document.getElementById("mainContainer");b();window.addEventListener("resize",a,!1)},getGraphicsViewportSize:function(){return{width:c.offsetWidth,height:c.offsetHeight}}}}();wpd=wpd||{};
wpd.popup=function(){return{show:function(b){document.getElementById("shadow").style.visibility="visible";b=document.getElementById(b);var a=parseInt(window.innerWidth),d=parseInt(window.innerHeight),c=parseInt(b.offsetWidth),e=parseInt(b.offsetHeight),d=(d-e)/2;b.style.left=(a-c)/2+"px";b.style.top=(60<d?60:d)+"px";b.style.visibility="visible"},close:function(b){document.getElementById("shadow").style.visibility="hidden";document.getElementById(b).style.visibility="hidden"}}}();
wpd.busyNote=function(){return{show:function(){document.getElementById("wait").style.visibility="visible"},close:function(){document.getElementById("wait").style.visibility="hidden"}}}();wpd.messagePopup=function(){var b;return{show:function(a,d,c){wpd.popup.show("messagePopup");document.getElementById("message-popup-heading").innerHTML=a;document.getElementById("message-popup-text").innerHTML=d;b=c},close:function(){wpd.popup.close("messagePopup");null!=b&&b()}}}();
wpd.unsupported=function(){wpd.messagePopup.show("Unsupported Feature!","This feature has not been implemented in the current version. This may be available in a future release.")};wpd=wpd||{};
wpd.sidebar=function(){function b(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)a[b].style.display="none"}return{show:function(a){b();a=document.getElementById(a);a.style.display="inline-block";a.style.height=parseInt(document.body.offsetHeight,10)-280+"px"},clear:b,resize:function(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)"inline-block"===a[b].style.display&&(a[b].style.height=parseInt(document.body.offsetHeight,10)-280+"px")}}}();
wpd=wpd||{};wpd.toolbar=function(){function b(){var a=document.getElementsByClassName("toolbar"),b;for(b=0;b<a.length;b++)a[b].style.visibility="hidden"}return{show:function(a){b();document.getElementById(a).style.visibility="visible"},clear:b}}();wpd=wpd||{};
wpd.webcamCapture=function(){function b(){void 0!=a&&a.stop();wpd.popup.close("webcamCapture")}var a;return{start:function(){if(null==(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia))wpd.messagePopup.show("Webcam Capture","Your browser does not support webcam capture using HTML5 APIs. A recent version of Google Chrome is recommended.");else{wpd.popup.show("webcamCapture");var b=document.getElementById("webcamVideo");navigator.getUserMedia=
navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;navigator.getUserMedia({video:!0},function(c){a=c;b.src=window.URL.createObjectURL(c)},function(){})}},cancel:function(){b()},capture:function(){var a=document.createElement("canvas"),c=document.getElementById("webcamVideo"),e=a.getContext("2d"),f;a.width=c.videoWidth;a.height=c.videoHeight;e.drawImage(c,0,0);f=e.getImageData(0,0,a.width,a.height);b();wpd.graphicsWidget.runImageOp(function(){return{imageData:f,
width:a.width,height:a.height}})}}}();wpd=wpd||{};
wpd.zoomView=function(){function b(){var a=document.getElementById("zoomCrossHair"),b=a.getContext("2d");a.width=a.width;b.strokeStyle="black"===m?"rgba(0,0,0,1)":"red"===m?"rgba(255,0,0,1)":"yellow"===m?"rgba(255,255,0,1)":"rgba(0,0,0,1)";b.beginPath();b.moveTo(f/2,0);b.lineTo(f/2,g);b.moveTo(0,g/2);b.lineTo(f,g/2);b.stroke()}var a,d,c,e,f=250,g=250,k,p,m="black";return{initZoom:function(){a=document.getElementById("zoomCanvas");d=a.getContext("2d");c=document.createElement("canvas");e=c.getContext("2d");
k=document.getElementById("mousePosition");p=5;b()},setZoomImage:function(b,f,g,k,m){c.width=k/p;c.height=m/p;e.putImageData(b,0,0);a.width=a.width;d.drawImage(c,f,g,k,m)},setCoords:function(a,b){if(wpd.appData.isAligned()){var c=wpd.appData.getPlotData();k.innerHTML=c.axes.pixelToLiveString(a,b)}else k.innerHTML=a.toFixed(2)+", "+b.toFixed(2)},setZoomRatio:function(a){p=a},getZoomRatio:function(){return p},getSize:function(){return{width:f,height:g}},showSettingsWindow:function(){document.getElementById("zoom-magnification-value").value=
p;document.getElementById("zoom-crosshair-color-value").value=m;wpd.popup.show("zoom-settings-popup")},applySettings:function(){p=document.getElementById("zoom-magnification-value").value;m=document.getElementById("zoom-crosshair-color-value").value;b();wpd.popup.close("zoom-settings-popup")}}}();wpd=wpd||{};
wpd.xyCalibration=function(){function b(){wpd.popup.show("xyAlignment")}return{start:function(){wpd.popup.show("xyAxesInfo")},pickCorners:function(){wpd.popup.close("xyAxesInfo");var a=new wpd.AxesCornersTool(4,2,["X1","X2","Y1","Y2"]);wpd.graphicsWidget.setTool(a)},getCornerValues:b,align:function(){var a=document.getElementById("xmin").value,d=document.getElementById("xmax").value,c=document.getElementById("ymin").value,e=document.getElementById("ymax").value,f=document.getElementById("xlog").checked,
g=document.getElementById("ylog").checked,k=new wpd.XYAxes,p=wpd.alignAxes.getActiveCalib();p.setDataAt(0,a,c);p.setDataAt(1,d,c);p.setDataAt(2,a,c);p.setDataAt(3,d,e);if(!k.calibrate(p,f,g))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show("Invalid Inputs","Please enter valid values for calibration.",b),!1;wpd.appData.getPlotData().axes=k;wpd.popup.close("xyAlignment");return!0}}}();
wpd.polarCalibration=function(){return{start:function(){wpd.popup.show("polarAxesInfo")},pickCorners:function(){wpd.popup.close("polarAxesInfo");var b=new wpd.AxesCornersTool(3,2,["Origin","P1","P2"]);wpd.graphicsWidget.setTool(b)},getCornerValues:function(){wpd.popup.show("polarAlignment")},align:function(){var b=parseFloat(document.getElementById("rpoint1").value),a=parseFloat(document.getElementById("thetapoint1").value),d=parseFloat(document.getElementById("rpoint2").value),c=parseFloat(document.getElementById("thetapoint2").value),
e=document.getElementById("degrees").checked;document.getElementById("radians");var f=document.getElementById("clockwise").checked,g=new wpd.PolarAxes,k=wpd.alignAxes.getActiveCalib();k.setDataAt(1,b,a);k.setDataAt(2,d,c);g.calibrate(k,e,f);wpd.appData.getPlotData().axes=g;wpd.popup.close("polarAlignment");return!0}}}();
wpd.ternaryCalibration=function(){return{start:function(){wpd.popup.show("ternaryAxesInfo")},pickCorners:function(){wpd.popup.close("ternaryAxesInfo");var b=new wpd.AxesCornersTool(3,3,["A","B","C"]);wpd.graphicsWidget.setTool(b)},getCornerValues:function(){wpd.popup.show("ternaryAlignment")},align:function(){document.getElementById("range0to1");var b=document.getElementById("range0to100").checked,a=document.getElementById("ternarynormal").checked,d=new wpd.TernaryAxes,c=wpd.alignAxes.getActiveCalib();
d.calibrate(c,b,a);wpd.appData.getPlotData().axes=d;wpd.popup.close("ternaryAlignment");return!0}}}();
wpd.mapCalibration=function(){function b(){wpd.popup.show("mapAlignment")}return{start:function(){wpd.popup.show("mapAxesInfo")},pickCorners:function(){wpd.popup.close("mapAxesInfo");var a=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(a);a.onComplete=b},getCornerValues:b,align:function(){var a=parseFloat(document.getElementById("scaleLength").value),b=document.getElementById("scaleUnits").value,c=new wpd.MapAxes,e=wpd.alignAxes.getActiveCalib();c.calibrate(e,a,b);wpd.appData.getPlotData().axes=
c;wpd.popup.close("mapAlignment");return!0}}}();
wpd.AxesCornersTool=function(){return function(b,a,d){var c=0;a=new wpd.Calibration(a);var e=!0;a.labels=d;wpd.alignAxes.setActiveCalib(a);wpd.graphicsWidget.resetData();this.onMouseClick=function(a,d,k){e?(c+=1,d=wpd.alignAxes.getActiveCalib(),d.addPoint(k.x,k.y,0,0),d.unselectAll(),d.selectPoint(c-1),wpd.graphicsWidget.forceHandlerRepaint(),c===b&&(e=!1,wpd.alignAxes.calibrationCompleted())):(d=wpd.alignAxes.getActiveCalib(),d.unselectAll(),d.selectNearestPoint(k.x,k.y),wpd.graphicsWidget.forceHandlerRepaint());
wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){var b=wpd.alignAxes.getActiveCalib();if(0!==b.getSelectedPoints().length){var d=b.getPoint(b.getSelectedPoints()[0]),c=d.px,d=d.py,e=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))d-=e;else if(wpd.keyCodes.isDown(a.keyCode))d+=e;else if(wpd.keyCodes.isLeft(a.keyCode))c-=e;else if(wpd.keyCodes.isRight(a.keyCode))c+=e;else return;b.changePointPx(b.getSelectedPoints()[0],
c,d);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(c,d);a.preventDefault();a.stopPropagation()}}}}();
wpd.AlignmentCornersRepainter=function(){return function(){var b=wpd.graphicsWidget.getAllContexts();this.painterName="AlignmentCornersReptainer";this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()};this.onRedraw=function(){var a=wpd.alignAxes.getActiveCalib();if(null!=a){var d,c,e;for(d=0;d<a.getCount();d++)e=a.getPoint(d),c=wpd.graphicsWidget.screenPx(e.px,e.py),b.dataCtx.fillStyle="rgba(255,255,255,0.7)",b.dataCtx.fillRect(c.x-10,c.y-10,20,40),b.dataCtx.beginPath(),a.isPointSelected(d)?
b.dataCtx.fillStyle="rgba(0,200,0,1)":b.dataCtx.fillStyle="rgba(200,0,0,1)",b.dataCtx.arc(c.x,c.y,3,0,2*Math.PI,!0),b.dataCtx.fill(),b.dataCtx.font="14px sans-serif",b.dataCtx.fillText(a.labels[d],c.x-10,c.y+18),b.oriDataCtx.beginPath(),a.isPointSelected(d)?b.oriDataCtx.fillStyle="rgb(0,200,0)":b.oriDataCtx.fillStyle="rgb(200,0,0)",b.oriDataCtx.arc(e.px,e.py,3,0,2*Math.PI,!0),b.oriDataCtx.fill(),b.oriDataCtx.font="14px sans-serif",b.oriDataCtx.fillText(a.labels[d],parseInt(e.px-10,10),parseInt(e.py+
18,10))}}}}();
wpd.alignAxes=function(){var b,a;return{start:function(){xyEl=document.getElementById("r_xy");polarEl=document.getElementById("r_polar");ternaryEl=document.getElementById("r_ternary");mapEl=document.getElementById("r_map");imageEl=document.getElementById("r_image");wpd.popup.close("axesList");if(!0===xyEl.checked)a=wpd.xyCalibration;else if(!0===polarEl.checked)a=wpd.polarCalibration;else if(!0===ternaryEl.checked)a=wpd.ternaryCalibration;else if(!0===mapEl.checked)a=wpd.mapCalibration;else if(!0===
imageEl.checked){a=null;var b=new wpd.ImageAxes;b.calibrate();wpd.appData.getPlotData().axes=b;wpd.appData.isAligned(!0);wpd.acquireData.load()}null!=a&&(a.start(),wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter))},calibrationCompleted:function(){wpd.sidebar.show("axes-calibration-sidebar")},getCornerValues:function(){a.getCornerValues()},align:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();a.align()&&(wpd.appData.isAligned(!0),
wpd.acquireData.load())},getActiveCalib:function(){return b},setActiveCalib:function(a){b=a}}}();wpd=wpd||{};
wpd.autoExtraction=function(){function b(){var a=wpd.appData.getPlotData().getAutoDetector(),b=document.getElementById("auto-extract-algo-name").value;if("averagingWindow"===b)a.algorithm=new wpd.AveragingWindowAlgo;else if("XStep"===b||"XStepWithInterpolation"===b){var c=wpd.appData.getPlotData().axes;c instanceof wpd.XYAxes&&!1===c.isLogX()&&!1===c.isLogY()?"XStep"===b?a.algorithm=new wpd.AveragingWindowWithStepSizeAlgo:"XStepWithInterpolation"===b&&(a.algorithm=new wpd.XStepWithInterpolationAlgo):
(wpd.messagePopup.show("Not supported!","This algorithm is only supported for non log scale XY plots."),document.getElementById("auto-extract-algo-name").value="averagingWindow",a.algorithm=new wpd.AveragingWindowAlgo)}else"blobDetector"===b&&(a.algorithm=new wpd.BlobDetectorAlgo);for(var b=a.algorithm,a=document.getElementById("algo-parameter-container"),b=b.getParamList(),e="<table>",c=0;c<b.length;c++)e+="<tr><td>"+b[c][0]+'</td><td><input type="text" size=3 id="algo-param-'+c+'" class="algo-params" value="'+
b[c][2]+'"/></td><td>'+b[c][1]+"</td></tr>";a.innerHTML=e+"</table>"}return{start:function(){wpd.sidebar.show("auto-extraction-sidebar");wpd.colorPicker.init();b()},changeAlgorithm:b,runAlgo:function(){var a=wpd.appData.getPlotData().getAutoDetector(),b=a.algorithm,c=new wpd.DataPointsRepainter,e=document.getElementsByClassName("algo-params"),f,g,k=wpd.graphicsWidget.getAllContexts(),p=wpd.graphicsWidget.getImageSize();for(f=0;f<e.length;f++)g=e[f].id,g=parseInt(g.replace("algo-param-",""),10),b.setParam(g,
parseFloat(e[f].value));wpd.graphicsWidget.removeTool();a.imageData=k.oriImageCtx.getImageData(0,0,p.width,p.height);a.generateBinaryData();wpd.graphicsWidget.setRepainter(c);b.run(wpd.appData.getPlotData());wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()}}}();wpd=wpd||{};
wpd.colorPicker=function(){function b(){var a=document.getElementById("color-button"),b=document.getElementById("color-distance-value"),c=wpd.appData.getPlotData().getAutoDetector(),d=document.getElementById("color-detection-mode-select"),e;e="fg"===c.colorDetectionMode?c.fgColor:c.bgColor;color_distance=c.colorDistance;a.style.backgroundColor="rgb("+e[0]+","+e[1]+","+e[2]+")";b.value=color_distance;d.value=c.colorDetectionMode}function a(){var a=wpd.appData.getPlotData().getAutoDetector().fgColor;
document.getElementById("selectedFGColorBox").style.backgroundColor="rgb("+a[0]+","+a[1]+","+a[2]+")";document.getElementById("color_red_fg").value=a[0];document.getElementById("color_green_fg").value=a[1];document.getElementById("color_blue_fg").value=a[2];c("fg");wpd.popup.show("colorPickerFG")}function d(){var a=wpd.appData.getPlotData().getAutoDetector().bgColor;document.getElementById("selectedBGColorBox").style.backgroundColor="rgb("+a[0]+","+a[1]+","+a[2]+")";document.getElementById("color_red_bg").value=
a[0];document.getElementById("color_green_bg").value=a[1];document.getElementById("color_blue_bg").value=a[2];c("bg");wpd.popup.show("colorPickerBG")}function c(a){var b=document.getElementById("fg"===a?"fgColorOptions":"bgColorOptions"),c=wpd.appData.getPlotData().topColors,d=10<c.length?10:c.length,e,h="",n,l;for(e=0;e<d;e++)l="rgb("+c[e].r+","+c[e].g+","+c[e].b+");",n=c[e].percentage.toFixed(3)+"%",h+='<div class="colorOptionBox" style="background-color: '+l+'" title="'+n+'" onclick="wpd.colorPicker.selectTopColor('+
e+",'"+a+"');\"></div>";b.innerHTML=h}function e(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getAutoDetector(),c=wpd.graphicsWidget.getImageSize(),d,e,h;h=a.oriDataCtx.getImageData(0,0,c.width,c.height);b.imageData=a.oriImageCtx.getImageData(0,0,c.width,c.height);b.generateBinaryData();if(null!=b.mask&&0!==b.mask.length){for(d=0;d<b.mask.length;d++)e=b.mask[d],!0===b.binaryData[e]?(parseInt(e/c.width,10),h.data[4*e]=255,h.data[4*e+1]=255,h.data[4*e+2]=0,h.data[4*e+3]=255):
(h.data[4*e]=0,h.data[4*e+1]=0,h.data[4*e+2]=0,h.data[4*e+3]=150);a.oriDataCtx.putImageData(h,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}}return{startPicker:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();"fg"===wpd.appData.getPlotData().getAutoDetector().colorDetectionMode?a():d()},changeDetectionMode:function(){var a=document.getElementById("color-detection-mode-select");wpd.appData.getPlotData().getAutoDetector().colorDetectionMode=
a.value;b()},pickFGColor:function(){wpd.popup.close("colorPickerFG");var b=new wpd.ColorPickerTool;b.onComplete=function(b){wpd.appData.getPlotData().getAutoDetector().fgColor=b;wpd.graphicsWidget.removeTool();a()};wpd.graphicsWidget.setTool(b)},pickBGColor:function(){wpd.popup.close("colorPickerBG");var a=new wpd.ColorPickerTool;a.onComplete=function(a){wpd.appData.getPlotData().getAutoDetector().bgColor=a;wpd.graphicsWidget.removeTool();d()};wpd.graphicsWidget.setTool(a)},setFGColor:function(){var a=
[];a[0]=parseInt(document.getElementById("color_red_fg").value,10);a[1]=parseInt(document.getElementById("color_green_fg").value,10);a[2]=parseInt(document.getElementById("color_blue_fg").value,10);wpd.appData.getPlotData().getAutoDetector().fgColor=a;wpd.popup.close("colorPickerFG");b()},setBGColor:function(){var a=[];a[0]=parseInt(document.getElementById("color_red_bg").value,10);a[1]=parseInt(document.getElementById("color_green_bg").value,10);a[2]=parseInt(document.getElementById("color_blue_bg").value,
10);wpd.appData.getPlotData().getAutoDetector().bgColor=a;wpd.popup.close("colorPickerBG");b()},changeColorDistance:function(){var a=parseFloat(document.getElementById("color-distance-value").value);wpd.appData.getPlotData().getAutoDetector().colorDistance=a},init:b,testColorDetection:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.ColorFilterRepainter);e()},paintFilteredColor:e,selectTopColor:function(b,c){var e=[],p=wpd.appData.getPlotData().topColors;
e[0]=p[b].r;e[1]=p[b].g;e[2]=p[b].b;"fg"===c?(wpd.appData.getPlotData().getAutoDetector().fgColor=e,a()):(wpd.appData.getPlotData().getAutoDetector().bgColor=e,d())}}}();wpd.ColorPickerTool=function(){return function(){var b=wpd.graphicsWidget.getAllContexts();this.onMouseClick=function(a,d,c){a=b.oriImageCtx.getImageData(c.x,c.y,1,1);this.onComplete([a.data[0],a.data[1],a.data[2]])};this.onComplete=function(a){}}}();
wpd.ColorFilterRepainter=function(){return function(){this.painterName="colorFilterRepainter";this.onRedraw=function(){wpd.colorPicker.paintFilteredColor()}}}();wpd=wpd||{};
wpd.imageOps=function(){function b(a,b,e){var f,g,k,p,m,h;for(f=0;f<e;f++)for(g=0;g<b/2;g++)for(k=4*(f*b+g),p=4*((f+1)*b-(g+1)),h=0;4>h;h++)m=a.data[k+h],a.data[k+h]=a.data[p+h],a.data[p+h]=m;return{imageData:a,width:b,height:e}}function a(a,b,e){var f,g,k,p,m,h;for(f=0;f<e/2;f++)for(g=0;g<b;g++)for(k=4*(f*b+g),p=4*((e-(f+2))*b+g),h=0;4>h;h++)m=a.data[k+h],a.data[k+h]=a.data[p+h],a.data[p+h]=m;return{imageData:a,width:b,height:e}}return{hflip:function(){wpd.graphicsWidget.runImageOp(b)},vflip:function(){wpd.graphicsWidget.runImageOp(a)}}}();
wpd=wpd||{};wpd.keyCodes=function(){return{isUp:function(b){return 38===b},isDown:function(b){return 40===b},isLeft:function(b){return 37===b},isRight:function(b){return 39===b},isAlphabet:function(b,a){return 90<b||65>b?!1:String.fromCharCode(b).toLowerCase()===a}}}();wpd=wpd||{};
wpd.acquireData=function(){function b(){var a=new wpd.ManualSelectionTool;wpd.graphicsWidget.setTool(a)}function a(){var a=new wpd.DeleteDataPointTool;wpd.graphicsWidget.setTool(a)}function d(){wpd.graphicsWidget.setTool(new wpd.AdjustDataPointTool)}return{load:function(){wpd.appData.isAligned()?(wpd.sidebar.show("acquireDataSidebar"),wpd.dataPointCounter.setCount(),wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter),b()):wpd.messagePopup.show("Acquire Data",
"Please calibrate the axes before acquiring data.")},manualSelection:b,adjustPoints:d,deletePoint:a,clearAll:function(){wpd.appData.getPlotData().getActiveDataSeries().clearAll();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.dataPointCounter.setCount();wpd.graphicsWidget.removeRepainter()},undo:function(){wpd.appData.getPlotData().getActiveDataSeries().removeLastPixel();wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},showSidebar:function(){wpd.sidebar.show("acquireDataSidebar")},
switchToolOnKeyPress:function(c){switch(c){case "d":a();break;case "a":b();break;case "s":d()}}}}();
wpd.ManualSelectionTool=function(){return function(){var b=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("manual-select-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(d,c,e){a.getActiveDataSeries().addPixel(e.x,e.y);b.dataCtx.beginPath();b.dataCtx.fillStyle="rgb(200,0,0)";b.dataCtx.arc(c.x,c.y,3,0,2*Math.PI,!0);b.dataCtx.fill();b.oriDataCtx.beginPath();
b.oriDataCtx.fillStyle="rgb(200,0,0)";b.oriDataCtx.arc(e.x,e.y,3,0,2*Math.PI,!0);b.oriDataCtx.fill();wpd.graphicsWidget.updateZoomOnEvent(d);wpd.dataPointCounter.setCount()};this.onRemove=function(){document.getElementById("manual-select-button").classList.remove("pressed-button")};this.onKeyDown=function(b){var c=a.getActiveDataSeries(),e=c.getCount()-1,f=c.getPixel(e),g=0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(b.keyCode))f.y-=g;else if(wpd.keyCodes.isDown(b.keyCode))f.y+=g;else if(wpd.keyCodes.isLeft(b.keyCode))f.x-=
g;else if(wpd.keyCodes.isRight(b.keyCode))f.x+=g;else{(wpd.keyCodes.isAlphabet(b.keyCode,"a")||wpd.keyCodes.isAlphabet(b.keyCode,"s")||wpd.keyCodes.isAlphabet(b.keyCode,"d"))&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(b.keyCode).toLowerCase());return}c.setPixelAt(e,f.x,f.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(f.x,f.y);b.preventDefault()}}}();
wpd.DeleteDataPointTool=function(){return function(){wpd.graphicsWidget.getAllContexts();var b=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("delete-point-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(a,d,c){b.getActiveDataSeries().removeNearestPixel(c.x,c.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a);wpd.dataPointCounter.setCount()};
this.onKeyDown=function(a){(wpd.keyCodes.isAlphabet(a.keyCode,"a")||wpd.keyCodes.isAlphabet(a.keyCode,"s")||wpd.keyCodes.isAlphabet(a.keyCode,"d"))&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(a.keyCode).toLowerCase())};this.onRemove=function(){document.getElementById("delete-point-button").classList.remove("pressed-button")}}}();
wpd.DataPointsRepainter=function(){return function(){var b=function(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getActiveDataSeries(),c,e,f,g;for(c=0;c<b.getCount();c++)e=b.getPixel(c),g=0<=b.getSelectedPixels().indexOf(c),f=wpd.graphicsWidget.screenPx(e.x,e.y),a.dataCtx.beginPath(),a.dataCtx.fillStyle=g?"rgb(0,200,0)":"rgb(200,0,0)",a.dataCtx.arc(f.x,f.y,3,0,2*Math.PI,!0),a.dataCtx.fill(),a.oriDataCtx.beginPath(),a.oriDataCtx.fillStyle=g?"rgb(0,200,0)":"rgb(200,0,0)",
a.oriDataCtx.arc(e.x,e.y,3,0,2*Math.PI,!0),a.oriDataCtx.fill()};this.painterName="dataPointsRepainter";this.onAttach=function(){wpd.graphicsWidget.resetData();b()};this.onRedraw=function(){b()};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();b()}}}();
wpd.AdjustDataPointTool=function(){return function(){this.onAttach=function(){document.getElementById("manual-adjust-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onRemove=function(){wpd.appData.getPlotData().getActiveDataSeries().unselectAll();wpd.graphicsWidget.forceHandlerRepaint();document.getElementById("manual-adjust-button").classList.remove("pressed-button")};this.onMouseClick=function(b,a,d){a=wpd.appData.getPlotData().getActiveDataSeries();
a.unselectAll();a.selectNearestPixel(d.x,d.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(b)};this.onKeyDown=function(b){if(wpd.keyCodes.isAlphabet(b.keyCode,"a")||wpd.keyCodes.isAlphabet(b.keyCode,"s")||wpd.keyCodes.isAlphabet(b.keyCode,"d"))wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(b.keyCode).toLowerCase());else{var a=wpd.appData.getPlotData().getActiveDataSeries(),d=a.getSelectedPixels()[0];if(null!=d){var c=a.getPixel(d),e=c.x,c=c.y,f=!0===b.shiftKey?
5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(b.keyCode))c-=f;else if(wpd.keyCodes.isDown(b.keyCode))c+=f;else if(wpd.keyCodes.isLeft(b.keyCode))e-=f;else if(wpd.keyCodes.isRight(b.keyCode))e+=f;else return;a.setPixelAt(d,e,c);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e,c);b.preventDefault();b.stopPropagation()}}}}}();
wpd.dataPointCounter=function(){return{setCount:function(){var b=document.getElementsByClassName("data-point-counter"),a;for(a=0;a<b.length;a++)b[a].innerHTML=wpd.appData.getPlotData().getActiveDataSeries().getCount()}}}();wpd=wpd||{};
wpd.dataMask=function(){return{grabMask:function(){var b=wpd.graphicsWidget.getAllContexts(),a=wpd.graphicsWidget.getImageSize(),b=b.oriDataCtx.getImageData(0,0,a.width,a.height),a=[],d,c=0,e=wpd.appData.getPlotData().getAutoDetector();for(d=0;d<b.data.length;d+=4)255===b.data[d]&&255===b.data[d+1]&&0===b.data[d+2]&&(a[c]=d/4,c++);e.mask=a},drawMask:function(){var b=wpd.appData.getPlotData().getAutoDetector().mask;if(null!=b&&0!==b.length){var a,d,c=wpd.graphicsWidget.getAllContexts(),e=wpd.graphicsWidget.getImageSize(),
f=c.oriDataCtx.getImageData(0,0,e.width,e.height);for(a=0;a<b.length;a++)d=b[a],parseInt(d/e.height,10),f.data[4*d]=255,f.data[4*d+1]=255,f.data[4*d+2]=0,f.data[4*d+3]=200;c.oriDataCtx.putImageData(f,0,0,e.width,e.height);wpd.graphicsWidget.copyImageDataLayerToScreen()}},markBox:function(){var b=new wpd.BoxMaskTool;wpd.graphicsWidget.setTool(b)},markPen:function(){var b=new wpd.PenMaskTool;wpd.graphicsWidget.setTool(b)},eraseMarks:function(){var b=new wpd.EraseMaskTool;wpd.graphicsWidget.setTool(b)},
viewMask:function(){var b=new wpd.ViewMaskTool;wpd.graphicsWidget.setTool(b)}}}();
wpd.BoxMaskTool=function(){return function(){var b=!1,a,d,c=wpd.graphicsWidget.getAllContexts(),e,f,g=function(){wpd.graphicsWidget.resetHover();c.hoverCtx.strokeStyle="rgb(0,0,0)";c.hoverCtx.strokeRect(d.x,d.y,f.x-d.x,f.y-d.y)},k=function(f,g,k){!1!==b&&(clearTimeout(e),b=!1,wpd.graphicsWidget.resetHover(),c.dataCtx.fillStyle="rgba(255,255,0,0.8)",c.dataCtx.fillRect(d.x,d.y,g.x-d.x,g.y-d.y),c.oriDataCtx.fillStyle="rgba(255,255,0,0.8)",c.oriDataCtx.fillRect(a.x,a.y,k.x-a.x,k.y-a.y))},p=null,m=null;
this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("box-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button")};this.onMouseDown=function(c,e,f){!0!==b&&(b=!0,a=f,d=e)};this.onMouseMove=function(a,c,d){!1!==b&&(f=c,clearTimeout(e),e=setTimeout(g,2))};this.onMouseOut=function(a,c,d){!0===b&&(clearTimeout(e),p=c,m=d)};this.onDocumentMouseUp=function(a,b,c){null!=p&&null!=m?k(a,p,m):k(a,b,c);m=p=null};
this.onMouseUp=function(a,b,c){k(a,b,c)};this.onRemove=function(){document.getElementById("box-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.PenMaskTool=function(){return function(){var b=wpd.graphicsWidget.getAllContexts(),a=!1,d,c,e,f=function(){b.dataCtx.strokeStyle="rgba(255,255,0,0.8)";b.dataCtx.lineTo(c.x,c.y);b.dataCtx.stroke();b.oriDataCtx.strokeStyle="rgba(255,255,0,0.8)";b.oriDataCtx.lineTo(e.x,e.y);b.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("pen-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button");
wpd.toolbar.show("paintToolbar")};this.onMouseDown=function(c,d,e){!0!==a&&(c=parseInt(document.getElementById("paintThickness").value,10),a=!0,b.dataCtx.strokeStyle="rgba(255,255,0,0.8)",b.dataCtx.lineWidth=c*wpd.graphicsWidget.getZoomRatio(),b.dataCtx.beginPath(),b.dataCtx.moveTo(d.x,d.y),b.oriDataCtx.strokeStyle="rgba(255,255,0,0.8)",b.oriDataCtx.lineWidth=c,b.oriDataCtx.beginPath(),b.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(b,k,p){!1!==a&&(c=k,e=p,clearTimeout(d),d=setTimeout(f,
2))};this.onMouseUp=function(c,e,f){clearTimeout(d);b.dataCtx.closePath();b.dataCtx.lineWidth=1;b.oriDataCtx.closePath();b.oriDataCtx.lineWidth=1;a=!1};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onRemove=function(){document.getElementById("pen-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();
wpd.EraseMaskTool=function(){return function(){var b=wpd.graphicsWidget.getAllContexts(),a=!1,d,c,e,f=function(){b.dataCtx.globalCompositeOperation="destination-out";b.oriDataCtx.globalCompositeOperation="destination-out";b.dataCtx.strokeStyle="rgba(255,255,0,1)";b.dataCtx.lineTo(c.x,c.y);b.dataCtx.stroke();b.oriDataCtx.strokeStyle="rgba(255,255,0,1)";b.oriDataCtx.lineTo(e.x,e.y);b.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("erase-mask").classList.add("pressed-button");
document.getElementById("view-mask").classList.add("pressed-button");wpd.toolbar.show("paintToolbar")};this.onMouseDown=function(c,d,e){!0!==a&&(c=parseInt(document.getElementById("paintThickness").value,10),a=!0,b.dataCtx.globalCompositeOperation="destination-out",b.oriDataCtx.globalCompositeOperation="destination-out",b.dataCtx.strokeStyle="rgba(0,0,0,1)",b.dataCtx.lineWidth=c*wpd.graphicsWidget.getZoomRatio(),b.dataCtx.beginPath(),b.dataCtx.moveTo(d.x,d.y),b.oriDataCtx.strokeStyle="rgba(0,0,0,1)",
b.oriDataCtx.lineWidth=c,b.oriDataCtx.beginPath(),b.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(b,k,p){!1!==a&&(c=k,e=p,clearTimeout(d),d=setTimeout(f,2))};this.onMouseOut=function(a,b,c){this.onMouseUp(a,b,c)};this.onMouseUp=function(c,e,f){clearTimeout(d);b.dataCtx.closePath();b.dataCtx.lineWidth=1;b.oriDataCtx.closePath();b.oriDataCtx.lineWidth=1;b.dataCtx.globalCompositeOperation="source-over";b.oriDataCtx.globalCompositeOperation="source-over";a=!1};this.onRemove=function(){document.getElementById("erase-mask").classList.remove("pressed-button");
document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();wpd.ViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("view-mask").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.MaskPainter=function(){return function(){var b=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData().getAutoDetector(),d=function(){if(null!=a.mask&&0!==a.mask.length){var c,d;c=wpd.graphicsWidget.getImageSize();imgData=b.oriDataCtx.getImageData(0,0,c.width,c.height);for(c=0;c<a.mask.length;c++)d=a.mask[c],imgData.data[4*d]=255,imgData.data[4*d+1]=255,imgData.data[4*d+2]=0,imgData.data[4*d+3]=200;b.oriDataCtx.putImageData(imgData,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}};
this.painterName="dataMaskPainter";this.onRedraw=function(){wpd.dataMask.grabMask();d()};this.onAttach=function(){wpd.graphicsWidget.resetData();d()}}}();wpd=wpd||{};
wpd.distanceMeasurement=function(){return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();var b=wpd.appData.getPlotData();null==b.distanceMeasurementData&&(b.distanceMeasurementData=new wpd.ConnectedPoints(2));wpd.sidebar.show("measure-distances-sidebar");wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("distance"));wpd.graphicsWidget.forceHandlerRepaint()},addPair:function(){wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("distance"))},deletePair:function(){wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool("distance"))},
clearAll:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.appData.getPlotData().distanceMeasurementData=new wpd.ConnectedPoints(2)}}}();
wpd.angleMeasurement=function(){return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();var b=wpd.appData.getPlotData();null==b.angleMeasurementData&&(b.angleMeasurementData=new wpd.ConnectedPoints(3));wpd.sidebar.show("measure-angles-sidebar");wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("angle"));wpd.graphicsWidget.forceHandlerRepaint()},addAngle:function(){wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("angle"))},deleteAngle:function(){wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool("angle"))},
clearAll:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.appData.getPlotData().angleMeasurementData=new wpd.ConnectedPoints(3)}}}();
wpd.measurementData=function(){var b;return{showAngleData:function(){wpd.popup.show("measurement-data-window");var a=wpd.appData.getPlotData().angleMeasurementData,d=a.connectionCount(),c,e=document.getElementById("measurement-data-table");b="";for(c=0;c<d;c++)b+=c.toString()+", "+a.getAngle(c)+"\n";e.value=b},showDistanceData:function(){wpd.popup.show("measurement-data-window");var a=wpd.appData.getPlotData().distanceMeasurementData,d=a.connectionCount(),c,e=document.getElementById("measurement-data-table"),
f=wpd.appData.getPlotData().axes;b="";for(c=0;c<d;c++)b=!0===wpd.appData.isAligned()&&f instanceof wpd.MapAxes?b+(c.toString()+", "+f.pixelToDataDistance(a.getDistance(c))+"\n"):b+(c.toString()+", "+a.getDistance(c)+"\n");e.value=b},selectAll:function(){var a=document.getElementById("measurement-data-table");a.focus();a.select()},generateCSV:function(){var a,d,c,e=JSON.stringify(b);a=document.createElement("div");d=document.createElement("form");c=document.createElement("input");d.setAttribute("method",
"post");d.setAttribute("action","php/csvexport.php");c.setAttribute("type","text");c.setAttribute("name","data");d.appendChild(c);a.appendChild(d);document.body.appendChild(a);a.style.display="none";c.setAttribute("value",e);d.submit();document.body.removeChild(a)},close:function(){b="";wpd.popup.close("measurement-data-window")}}}();
wpd.AddMeasurementTool=function(){return function(b){var a="distance"===b,d=wpd.graphicsWidget.getAllContexts(),c=wpd.appData.getPlotData(),e=0,f=!0,g=[],k=a?2:3;this.onAttach=function(){document.getElementById(!0===a?"add-pair-button":"add-angle-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(b))};this.onRemove=function(){document.getElementById(!0===a?"add-pair-button":"add-angle-button").classList.remove("pressed-button")};this.onMouseClick=
function(p,m,h){if(f){wpd.graphicsWidget.resetHover();g[2*e]=h.x;g[2*e+1]=h.y;e+=1;e===k&&(f=!1,a?c.distanceMeasurementData.addConnection(g):c.angleMeasurementData.addConnection(g),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(b)));if(1<e){var n=wpd.graphicsWidget.screenPx(g[2*(e-2)],g[2*(e-2)+1]);d.dataCtx.beginPath();d.dataCtx.strokeStyle="rgb(0,0,10)";d.dataCtx.moveTo(n.x,n.y);d.dataCtx.lineTo(m.x,m.y);d.dataCtx.stroke();d.oriDataCtx.beginPath();
d.oriDataCtx.strokeStyle="rgb(0,0,10)";d.oriDataCtx.moveTo(g[2*(e-2)],g[2*(e-2)+1]);d.oriDataCtx.lineTo(h.x,h.y);d.oriDataCtx.stroke()}d.dataCtx.beginPath();d.dataCtx.fillStyle="rgb(200, 0, 0)";d.dataCtx.arc(m.x,m.y,3,0,2*Math.PI,!0);d.dataCtx.fill();d.oriDataCtx.beginPath();d.oriDataCtx.fillStyle="rgb(200,0,0)";d.oriDataCtx.arc(h.x,h.y,3,0,2*Math.PI,!0);d.oriDataCtx.fill()}wpd.graphicsWidget.updateZoomOnEvent(p)};this.onMouseMove=function(a,b,c){f&&1<=e&&(wpd.graphicsWidget.resetHover(),a=wpd.graphicsWidget.screenPx(g[2*
(e-1)],g[2*(e-1)+1]),d.hoverCtx.beginPath(),d.hoverCtx.strokeStyle="rgb(0,0,0)",d.hoverCtx.moveTo(a.x,a.y),d.hoverCtx.lineTo(b.x,b.y),d.hoverCtx.stroke())};this.onKeyDown=function(a){}}}();
wpd.DeleteMeasurementTool=function(){return function(b){var a="distance"===b;wpd.graphicsWidget.getAllContexts();var d=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById(!0===a?"delete-pair-button":"delete-angle-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(b))};this.onRemove=function(){document.getElementById(!0===a?"delete-pair-button":"delete-angle-button").classList.remove("pressed-button")};this.onMouseClick=function(c,
e,f){a?d.distanceMeasurementData.deleteNearestConnection(f.x,f.y):d.angleMeasurementData.deleteNearestConnection(f.x,f.y);wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(b));wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(c)}}}();
wpd.AdjustMeasurementTool=function(){return function(b){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(b))};this.onMouseClick=function(a,d,c){d=wpd.appData.getPlotData();"distance"===b?d.distanceMeasurementData.selectNearestPoint(c.x,c.y):"angle"===b&&d.angleMeasurementData.selectNearestPoint(c.x,c.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){if(wpd.keyCodes.isAlphabet(a.keyCode,"a"))wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(b));
else if(wpd.keyCodes.isAlphabet(a.keyCode,"d"))wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(b));else{var d=wpd.appData.getPlotData(),d="distance"===b?d.distanceMeasurementData:d.angleMeasurementData,c=d.getSelectedConnectionAndPoint();if(0<=c.connectionIndex&&0<=c.pointIndex){var e=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio(),f=d.getPointAt(c.connectionIndex,c.pointIndex);if(wpd.keyCodes.isUp(a.keyCode))f.y-=e;else if(wpd.keyCodes.isDown(a.keyCode))f.y+=
e;else if(wpd.keyCodes.isLeft(a.keyCode))f.x-=e;else if(wpd.keyCodes.isRight(a.keyCode))f.x+=e;else return;d.setPointAt(c.connectionIndex,c.pointIndex,f.x,f.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(f.x,f.y);a.preventDefault();a.stopPropagation()}}}}}();
wpd.MeasurementRepainter=function(){return function(b){var a="distance"===b,d="angle"===b,c=wpd.graphicsWidget.getAllContexts(),e=function(a,b,d,e,f,g,r,q){c.dataCtx.beginPath();c.dataCtx.strokeStyle="rgb(0,0,10)";c.dataCtx.moveTo(a,b);c.dataCtx.lineTo(d,e);c.dataCtx.stroke();c.oriDataCtx.beginPath();c.oriDataCtx.strokeStyle="rgb(0,0,10)";c.oriDataCtx.moveTo(f,g);c.oriDataCtx.lineTo(r,q);c.oriDataCtx.stroke()},f=function(a,b,d,e,f){c.dataCtx.beginPath();c.dataCtx.fillStyle=f?"rgb(0, 200, 0)":"rgb(200, 0, 0)";
c.dataCtx.arc(a,b,3,0,2*Math.PI,!0);c.dataCtx.fill();c.oriDataCtx.beginPath();c.oriDataCtx.fillStyle=f?"rgb(0,200,0)":"rgb(200,0,0)";c.oriDataCtx.arc(d,e,3,0,2*Math.PI,!0);c.oriDataCtx.fill()},g=function(a,b,d,e,f){c.dataCtx.font="14px sans-serif";c.dataCtx.fillText(f,parseInt(a,10),parseInt(b,10));c.oriDataCtx.font="14px sans-serif";c.oriDataCtx.fillText(f,parseInt(d,10),parseInt(e,10))};this.painterName="measurementRepainter-"+b;this.onAttach=function(){wpd.graphicsWidget.resetData()};this.onRedraw=
function(){if(a){var b=wpd.appData.getPlotData().distanceMeasurementData,p=b.connectionCount(),m,h,n,l,r,q,s,t,u,w,v=wpd.appData.getPlotData().axes;for(m=0;m<p;m++)h=b.getConnectionAt(m),n=h[0],l=h[1],r=h[2],h=h[3],u=b.isPointSelected(m,0),w=b.isPointSelected(m,1),t=!0===wpd.appData.isAligned()&&v instanceof wpd.MapAxes?"["+m.toString()+"]: "+v.pixelToDataDistance(b.getDistance(m)).toFixed(2)+" "+v.getUnits():"["+m.toString()+"]: "+b.getDistance(m).toFixed(2)+" px",q=wpd.graphicsWidget.screenPx(n,
l),s=wpd.graphicsWidget.screenPx(r,h),e(q.x,q.y,s.x,s.y,n,l,r,h),f(q.x,q.y,n,l,u),f(s.x,s.y,r,h,w),g(0.5*(q.x+s.x),0.5*(q.y+s.y),0.5*(n+r),0.5*(l+h),t)}if(d){var b=wpd.appData.getPlotData().angleMeasurementData,p=b.connectionCount(),z,F,H,J,D;for(m=0;m<p;m++)r=b.getConnectionAt(m),s=r[0],t=r[1],n=r[2],l=r[3],u=r[4],w=r[5],H=b.isPointSelected(m,0),J=b.isPointSelected(m,1),D=b.isPointSelected(m,2),v="["+m.toString()+"]: "+b.getAngle(m).toFixed(2)+"\u00b0",q=Math.atan2(t-l,s-n),h=Math.atan2(w-l,u-n),
z=wpd.graphicsWidget.screenPx(s,t),r=wpd.graphicsWidget.screenPx(n,l),F=wpd.graphicsWidget.screenPx(u,w),e(z.x,z.y,r.x,r.y,s,t,n,l),e(r.x,r.y,F.x,F.y,n,l,u,w),f(z.x,z.y,s,t,H),f(r.x,r.y,n,l,J),f(F.x,F.y,u,w,D),s=r.x,t=r.y,u=n,w=l,c.dataCtx.beginPath(),c.dataCtx.strokeStyle="rgb(0,0,10)",c.dataCtx.arc(s,t,15,q,h,!0),c.dataCtx.stroke(),c.oriDataCtx.beginPath(),c.oriDataCtx.strokeStyle="rgb(0,0,10)",c.oriDataCtx.arc(u,w,15,q,h,!0),c.oriDataCtx.stroke(),g(r.x+10,r.y+15,n+10,l+15,v)}};this.onForcedRedraw=
function(){wpd.graphicsWidget.resetData();this.onRedraw()}}}();wpd=wpd||{};wpd.saveResume=function(){return{save:function(){var b=wpd.appData.getPlotData().getAutoDetector().imageData,a=new XMLHttpRequest,d=new FormData;a.open("POST","php/test.php",!0);a.onload=function(a){console.log("done")};b=new Blob(BSON.serialize(b),{type:"application/bson"});d.append("file.bson",b,"file.bson");a.send(d)}}}();wpd=wpd||{};
wpd.scriptInjector=function(){return{start:function(){wpd.popup.show("runScriptPopup")},cancel:function(){wpd.popup.close("runScriptPopup")},load:function(){var b=document.getElementById("runScriptFileInput");wpd.popup.close("runScriptPopup");if(1==b.files.length){var a=new FileReader;a.onload=function(){eval(a.result);wpdscript.run();window.wpdscript=wpdscript};a.readAsText(b.files[0])}}}}();wpd=wpd||{};wpd.browserInfo=function(){return{checkBrowser:function(){window.FileReader||alert("\tWARNING!\nYour web browser is not supported. This program might not behave as intended. Please use a recent version of Google Chrome, Firefox or Safari browser.")}}}();

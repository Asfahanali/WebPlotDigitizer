var wpd=wpd||{};wpd.initApp=function(){wpd.browserInfo.checkBrowser();wpd.layoutManager.initialLayout();wpd.loadRemoteData()||(wpd.graphicsWidget.loadImageFromURL("start.png"),wpd.messagePopup.show("Unstable Version Warning!","You are using a beta version of WebPlotDigitizer. There may be some issues with the software that are expected."));document.getElementById("loadingCurtain").style.display="none"};
wpd.loadRemoteData=function(){return"undefined"===typeof wpdremote?!1:null!=wpdremote.status&&"fail"===wpdremote.status?(wpd.messagePopup.show("Remote Upload Failed!","Remote Upload Failed!"),!1):"success"===wpdremote.status&&null!=wpdremote.localUrl?(wpd.graphicsWidget.loadImageFromURL(wpdremote.localUrl),wpd.popup.show("axesList"),!0):!1};document.addEventListener("DOMContentLoaded",wpd.initApp,!0);wpd=wpd||{};
wpd.detectionAlgoManager=function(){return{setActiveAlgo:function(c){},getActiveAlgo:function(){return null},getAllApplicableAlgorithms:function(){}}}();wpd=wpd||{};wpd.appData=function(){function c(){null==b&&(b=new wpd.PlotData);return b}var a=!1,b;return{isAligned:function(b){null!=b&&(a=b);return a},getPlotData:c,reset:function(){a=!1;b=null},plotLoaded:function(a){c().topColors=wpd.colorAnalyzer.getTopColors(a)}}}();wpd=wpd||{};
wpd.AutoDetector=function(){return function(){this.fgColor=[0,0,200];this.bgColor=[255,255,255];this.mask=null;this.gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};this.gridLineColor=[150,150,150];this.gridColorDistance=150;this.gridData=null;this.colorDetectionMode="fg";this.colorDistance=120;this.imageData=this.gridBinaryData=this.binaryData=this.algorithm=null;this.imageHeight=this.imageWidth=0;this.reset=function(){this.gridData=this.imageData=this.binaryData=this.mask=null;this.gridMask=
{xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]}};this.generateBinaryDataFromMask=function(){var c,a,b,d="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(c=0;c<this.mask.length;c++)a=this.mask[c],b=Math.sqrt((this.imageData.data[4*a]-d[0])*(this.imageData.data[4*a]-d[0])+(this.imageData.data[4*a+1]-d[1])*(this.imageData.data[4*a+1]-d[1])+(this.imageData.data[4*a+2]-d[2])*(this.imageData.data[4*a+2]-d[2])),"fg"===this.colorDetectionMode?b<=this.colorDistance&&(this.binaryData[a]=!0):
b>=this.colorDistance&&(this.binaryData[a]=!0)};this.generateBinaryDataUsingFullImage=function(){var c,a,b="fg"===this.colorDetectionMode?this.fgColor:this.bgColor;for(a=0;a<this.imageData.data.length/4;a++)c=Math.sqrt((this.imageData.data[4*a]-b[0])*(this.imageData.data[4*a]-b[0])+(this.imageData.data[4*a+1]-b[1])*(this.imageData.data[4*a+1]-b[1])+(this.imageData.data[4*a+2]-b[2])*(this.imageData.data[4*a+2]-b[2])),"fg"===this.colorDetectionMode?c<=this.colorDistance&&(this.binaryData[a]=!0):c>=
this.colorDistance&&(this.binaryData[a]=!0)};this.generateBinaryData=function(){this.binaryData=[];null==this.imageData?this.imageWidth=this.imageHeight=0:(this.imageHeight=this.imageData.height,this.imageWidth=this.imageData.width,null==this.mask||0===this.mask.length?this.generateBinaryDataUsingFullImage():this.generateBinaryDataFromMask())};this.generateGridBinaryData=function(){this.gridBinaryData=[];if(null!=this.gridMask.pixels&&0!==this.gridMask.pixels.length)if(null==this.imageData)this.imageHeight=
this.imageWidth=0;else{this.imageWidth=this.imageData.width;this.imageHeight=this.imageData.height;var c,a,b;for(c=0;c<this.gridMask.pixels.length;c++)a=this.gridMask.pixels[c],b=wpd.dist3d(this.gridLineColor[0],this.gridLineColor[1],this.gridLineColor[2],this.imageData.data[4*a],this.imageData.data[4*a+1],this.imageData.data[4*a+2]),b<this.gridColorDistance&&(this.gridBinaryData[a]=!0)}}}}();wpd=wpd||{};
wpd.Calibration=function(){return function(c){var a=[],b=[],d=null==c?2:c,f=[],e=[];this.labels=[];this.getCount=function(){return a.length};this.getDimensions=function(){return d};this.addPoint=function(e,c,l,q,m){var k=a.length,n=f.length;a[k]=e;b[k]=c;f[n]=l;f[n+1]=q;3===d&&(f[n+2]=m)};this.getPoint=function(e){return 0>e||e>=a.length?null:{px:a[e],py:b[e],dx:f[d*e],dy:f[d*e+1],dz:2===d?null:f[d*e+2]}};this.changePointPx=function(d,e,c){0>d||d>=a.length||(a[d]=e,b[d]=c)};this.setDataAt=function(b,
e,c,q){0>b||b>=a.length||(f[d*b]=e,f[d*b+1]=c,3===d&&(f[d*b+2]=q))};this.findNearestPoint=function(d,e,c){c=null==c?50:parseFloat(c);var f,m=-1,k,n;for(k=0;k<a.length;k++)if(n=Math.sqrt((d-a[k])*(d-a[k])+(e-b[k])*(e-b[k])),0>m&&n<=c||0<=m&&n<f)m=k,f=n;return m};this.selectPoint=function(a){0>e.indexOf(a)&&(e[e.length]=a)};this.selectNearestPoint=function(a,b,d){a=this.findNearestPoint(a,b,d);0<=a&&this.selectPoint(a)};this.getSelectedPoints=function(){return e};this.unselectAll=function(){e=[]};this.isPointSelected=
function(a){return 0<=e.indexOf(a)};this.dump=function(){console.log(a);console.log(b);console.log(f)}}}();wpd=wpd||{};wpd.ColorGroup=function(){return function(c){var a=0,b={r:0,g:0,b:0};c=null==c?100:c;this.getPixelCount=function(){return a};this.getAverageColor=function(){return b};this.isColorInGroup=function(d,f,e){return 0===a?!0:(b.r-d)*(b.r-d)+(b.g-f)*(b.g-f)+(b.b-e)*(b.b-e)<=c*c};this.addPixel=function(d,c,e){b.r=(b.r*a+d)/(a+1);b.g=(b.g*a+c)/(a+1);b.b=(b.b*a+e)/(a+1);a+=1}}}();
wpd.colorAnalyzer=function(){return{getTopColors:function(c){var a=[],b,d,f,e,g,h,l=[];a[0]=new wpd.ColorGroup(120);for(b=0;b<c.data.length;b+=4){d=c.data[b];f=c.data[b+1];e=c.data[b+2];h=!1;for(g=0;g<a.length;g++)if(a[g].isColorInGroup(d,f,e)){a[g].addPixel(d,f,e);h=!0;break}h||(a[a.length]=new wpd.ColorGroup(120),a[a.length-1].addPixel(d,f,e))}a.sort(function(a,b){return a.getPixelCount()>b.getPixelCount()?-1:a.getPixelCount()<b.getPixelCount()?1:0});for(g=0;g<a.length;g++)b=a[g].getAverageColor(),
l[g]={r:parseInt(b.r,10),g:parseInt(b.g,10),b:parseInt(b.b,10),pixels:a[g].getPixelCount(),percentage:100*a[g].getPixelCount()/(0.25*c.data.length)};return l}}}();wpd=wpd||{};
wpd.ConnectedPoints=function(){return function(c){var a=[],b=-1,d=-1;this.addConnection=function(b){a[a.length]=b};this.clearAll=function(){a=[]};this.getConnectionAt=function(b){if(b<a.length)return a[b]};this.replaceConnectionAt=function(b,d){b<a.length&&(a[b]=d)};this.deleteConnectionAt=function(b){b<a.length&&a.splice(b,1)};this.connectionCount=function(){return a.length};this.getDistance=function(b){if(b<a.length&&2===c)return Math.sqrt((a[b][0]-a[b][2])*(a[b][0]-a[b][2])+(a[b][1]-a[b][3])*(a[b][1]-
a[b][3]))};this.getAngle=function(b){if(b<a.length&&3===c){var d=wpd.taninverse(-(a[b][5]-a[b][3]),a[b][4]-a[b][2]);b=wpd.taninverse(-(a[b][1]-a[b][3]),a[b][0]-a[b][2]);d=180*(d-b)/Math.PI;return d=0>d?d+360:d}};this.findNearestPointAndConnection=function(b,d){var g=-1,h=-1,l,q,m,k;for(m=0;m<a.length;m++)for(k=0;k<2*c;k+=2)if(q=(a[m][k]-b)*(a[m][k]-b)+(a[m][k+1]-d)*(a[m][k+1]-d),-1===h||q<l)g=m,h=k/2,l=q;return{connectionIndex:g,pointIndex:h}};this.selectNearestPoint=function(a,e){var c=this.findNearestPointAndConnection(a,
e);0<=c.connectionIndex&&(b=c.connectionIndex,d=c.pointIndex)};this.deleteNearestConnection=function(a,b){var d=this.findNearestPointAndConnection(a,b);0<=d.connectionIndex&&this.deleteConnectionAt(d.connectionIndex)};this.isPointSelected=function(a,e){return d===e&&b===a?!0:!1};this.getSelectedConnectionAndPoint=function(){return{connectionIndex:b,pointIndex:d}};this.unselectConnectionAndPoint=function(){d=b=-1};this.setPointAt=function(b,d,c,h){a[b][2*d]=c;a[b][2*d+1]=h};this.getPointAt=function(b,
d){return{x:a[b][2*d],y:a[b][2*d+1]}}}}();wpd=wpd||{};wpd.dataEventNames={axesAligned:"axesAligned",imageLoaded:"imageLoaded"};wpd.dataEventManager=function(){return{fireEvent:function(c,a){},subscribe:function(c,a){},unsubscribe:function(c,a){},removeAllSubscriptionsForEvent:function(c){}}}();wpd=wpd||{};
wpd.Calibration=function(){return function(c){var a=[],b=[],d=null==c?2:c,f=[],e=[];this.labels=[];this.getCount=function(){return a.length};this.getDimensions=function(){return d};this.addPoint=function(e,c,l,q,m){var k=a.length,n=f.length;a[k]=e;b[k]=c;f[n]=l;f[n+1]=q;3===d&&(f[n+2]=m)};this.getPoint=function(e){return 0>e||e>=a.length?null:{px:a[e],py:b[e],dx:f[d*e],dy:f[d*e+1],dz:2===d?null:f[d*e+2]}};this.changePointPx=function(d,e,c){0>d||d>=a.length||(a[d]=e,b[d]=c)};this.setDataAt=function(b,
e,c,q){0>b||b>=a.length||(f[d*b]=e,f[d*b+1]=c,3===d&&(f[d*b+2]=q))};this.findNearestPoint=function(d,e,c){c=null==c?50:parseFloat(c);var f,m=-1,k,n;for(k=0;k<a.length;k++)if(n=Math.sqrt((d-a[k])*(d-a[k])+(e-b[k])*(e-b[k])),0>m&&n<=c||0<=m&&n<f)m=k,f=n;return m};this.selectPoint=function(a){0>e.indexOf(a)&&(e[e.length]=a)};this.selectNearestPoint=function(a,b,d){a=this.findNearestPoint(a,b,d);0<=a&&this.selectPoint(a)};this.getSelectedPoints=function(){return e};this.unselectAll=function(){e=[]};this.isPointSelected=
function(a){return 0<=e.indexOf(a)};this.dump=function(){console.log(a);console.log(b);console.log(f)}}}();
wpd.DataSeries=function(){return function(c){var a=[],b=[],d=!1,f=[];this.name="Default Dataset";this.variableNames=["x","y"];this.hasMetadata=function(){return d};this.setMetadataKeys=function(a){f=a};this.getMetadataKeys=function(){return f};this.addPixel=function(b,c,f){a[a.length]={x:b,y:c,metadata:f};null!=f&&(d=!0)};this.getPixel=function(b){return a[b]};this.setPixelAt=function(b,d,c){b<a.length&&(a[b].x=d,a[b].y=c)};this.setMetadataAt=function(b,d){b<a.length&&(a[b].metadata=d)};this.insertPixel=
function(b,d,c,f){a.splice(b,0,{x:d,y:c,metadata:f})};this.removePixelAtIndex=function(b){b<a.length&&a.splice(b,1)};this.removeLastPixel=function(){this.removePixelAtIndex(a.length-1)};this.findNearestPixel=function(b,d,c){c=null==c?50:parseFloat(c);var f,q=-1,m,k;for(m=0;m<a.length;m++)if(k=Math.sqrt((b-a[m].x)*(b-a[m].x)+(d-a[m].y)*(d-a[m].y)),0>q&&k<=c||0<=q&&k<f)q=m,f=k;return q};this.removeNearestPixel=function(a,b,d){a=this.findNearestPixel(a,b,d);0<=a&&this.removePixelAtIndex(a)};this.clearAll=
function(){a=[];d=!1;f=[]};this.getCount=function(){return a.length};this.selectPixel=function(a){0<=b.indexOf(a)||(b[b.length]=a)};this.unselectAll=function(){b=[]};this.selectNearestPixel=function(a,b,d){a=this.findNearestPixel(a,b,d);0<=a&&this.selectPixel(a)};this.selectNextPixel=function(){for(var d=0;d<b.length;d++)b[d]=(b[d]+1)%a.length};this.selectPreviousPixel=function(){var d,c;for(d=0;d<b.length;d++)c=b[d],c=0==c?a.length-1:c-1,b[d]=c};this.getSelectedPixels=function(){return b}}}();
wpd.PlotData=function(){return function(){var c=0,a=new wpd.AutoDetector;this.axes=this.topColors=null;this.dataSeriesColl=[];this.distanceMeasurementData=this.angleMeasurementData=this.calibration=this.gridData=null;this.getActiveDataSeries=function(){null==this.dataSeriesColl[c]&&(this.dataSeriesColl[c]=new wpd.DataSeries);return this.dataSeriesColl[c]};this.getDataSeriesCount=function(){return this.dataSeriesColl.length};this.setActiveDataSeriesIndex=function(a){c=a};this.getActiveDataSeriesIndex=
function(){return c};this.getAutoDetector=function(){return a};this.getDataSeriesNames=function(){for(var a=[],d=0;d<this.dataSeriesColl.length;d++)a[d]=this.dataSeriesColl[d].name;return a};this.getDataFromActiveSeries=function(){var a=this.getActiveDataSeries();if(null==a||null==this.axes)return null;var d,f,e,g=[],h;d=a.hasMetadata();f=a.getMetadataKeys();var l=!0===d?f.length:0;for(d=0;d<a.getCount();d++){f=this.dataSeriesColl[c].getPixel(d);e=this.axes.pixelToData(f.x,f.y);g[d]=[];for(h=0;h<
e.length;h++)g[d][h]=e[h];for(h=0;h<l;h++)g[d][e.length+h]=f.metadata[h]}return g};this.reset=function(){this.distanceMeasurementData=this.angleMeasurementData=this.axes=null;this.dataSeriesColl=[];this.calibration=this.gridData=null;c=0;a=new wpd.AutoDetector}}}();
wpd.ConnectedPoints=function(){return function(c){var a=[],b=-1,d=-1;this.addConnection=function(b){a[a.length]=b};this.clearAll=function(){a=[]};this.getConnectionAt=function(b){if(b<a.length)return a[b]};this.replaceConnectionAt=function(b,d){b<a.length&&(a[b]=d)};this.deleteConnectionAt=function(b){b<a.length&&a.splice(b,1)};this.connectionCount=function(){return a.length};this.getDistance=function(b){if(b<a.length&&2===c)return Math.sqrt((a[b][0]-a[b][2])*(a[b][0]-a[b][2])+(a[b][1]-a[b][3])*(a[b][1]-
a[b][3]))};this.getAngle=function(b){if(b<a.length&&3===c){var d=wpd.taninverse(-(a[b][5]-a[b][3]),a[b][4]-a[b][2]);b=wpd.taninverse(-(a[b][1]-a[b][3]),a[b][0]-a[b][2]);d=180*(d-b)/Math.PI;return d=0>d?d+360:d}};this.findNearestPointAndConnection=function(b,d){var g=-1,h=-1,l,q,m,k;for(m=0;m<a.length;m++)for(k=0;k<2*c;k+=2)if(q=(a[m][k]-b)*(a[m][k]-b)+(a[m][k+1]-d)*(a[m][k+1]-d),-1===h||q<l)g=m,h=k/2,l=q;return{connectionIndex:g,pointIndex:h}};this.selectNearestPoint=function(a,c){var g=this.findNearestPointAndConnection(a,
c);0<=g.connectionIndex&&(b=g.connectionIndex,d=g.pointIndex)};this.deleteNearestConnection=function(b,a){var d=this.findNearestPointAndConnection(b,a);0<=d.connectionIndex&&this.deleteConnectionAt(d.connectionIndex)};this.isPointSelected=function(a,c){return d===c&&b===a?!0:!1};this.getSelectedConnectionAndPoint=function(){return{connectionIndex:b,pointIndex:d}};this.unselectConnectionAndPoint=function(){d=b=-1};this.setPointAt=function(b,d,c,h){a[b][2*d]=c;a[b][2*d+1]=h};this.getPointAt=function(b,
d){return{x:a[b][2*d],y:a[b][2*d+1]}}}}();wpd=wpd||{};
wpd.DataSeries=function(){return function(c){var a=[],b=[],d=!1,f=[];this.name="Default Dataset";this.variableNames=["x","y"];this.hasMetadata=function(){return d};this.setMetadataKeys=function(b){f=b};this.getMetadataKeys=function(){return f};this.addPixel=function(b,c,f){a[a.length]={x:b,y:c,metadata:f};null!=f&&(d=!0)};this.getPixel=function(b){return a[b]};this.setPixelAt=function(b,d,c){b<a.length&&(a[b].x=d,a[b].y=c)};this.setMetadataAt=function(b,d){b<a.length&&(a[b].metadata=d)};this.insertPixel=
function(b,d,c,f){a.splice(b,0,{x:d,y:c,metadata:f})};this.removePixelAtIndex=function(b){b<a.length&&a.splice(b,1)};this.removeLastPixel=function(){this.removePixelAtIndex(a.length-1)};this.findNearestPixel=function(b,d,c){c=null==c?50:parseFloat(c);var f,q=-1,m,k;for(m=0;m<a.length;m++)if(k=Math.sqrt((b-a[m].x)*(b-a[m].x)+(d-a[m].y)*(d-a[m].y)),0>q&&k<=c||0<=q&&k<f)q=m,f=k;return q};this.removeNearestPixel=function(b,a,d){b=this.findNearestPixel(b,a,d);0<=b&&this.removePixelAtIndex(b)};this.clearAll=
function(){a=[];d=!1;f=[]};this.getCount=function(){return a.length};this.selectPixel=function(a){0<=b.indexOf(a)||(b[b.length]=a)};this.unselectAll=function(){b=[]};this.selectNearestPixel=function(b,a,d){b=this.findNearestPixel(b,a,d);0<=b&&this.selectPixel(b)};this.selectNextPixel=function(){for(var d=0;d<b.length;d++)b[d]=(b[d]+1)%a.length};this.selectPreviousPixel=function(){var d,c;for(d=0;d<b.length;d++)c=b[d],c=0==c?a.length-1:c-1,b[d]=c};this.getSelectedPixels=function(){return b}}}();
wpd=wpd||{};
wpd.dateConverter=function(){function c(a,b){var d;d=b.replace("YYYY","yyyy");d=d.replace("YY","yy");d=d.replace("MMMM","mmmm");d=d.replace("MMM","mmm");d=d.replace("MM","mm");d=d.replace("DD","dd");d=d.replace("yyyy",a.getUTCFullYear());var c=a.getUTCFullYear()%100;d=d.replace("yy",10>c?"0"+c:c);d=d.replace("mmmm","January February March April May June July August September October November December".split(" ")[a.getUTCMonth()]);d=d.replace("mmm","Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]);d=
d.replace("mm",a.getUTCMonth()+1);return d=d.replace("dd",a.getUTCDate())}return{parse:function(a){if(null==a||0>a.indexOf("/"))a=null;else{var b=a.split("/"),d;0>=b.length||3<b.length?a=null:(a=parseInt(b[0],10),d=parseInt(void 0===b[1]?0:b[1],10),date=parseInt(void 0===b[2]?1:b[2],10),isNaN(a)||isNaN(d)||isNaN(date)||12<d||1>d||31<date||1>date?a=null:(b=new Date,b.setUTCFullYear(a),b.setUTCMonth(d-1),b.setUTCDate(date),a=parseFloat(Date.parse(b)),a=isNaN(a)?null:a))}return a},getFormatString:function(a){a=
a.split("/");var b="yyyy/mm/dd";1<=a.length&&(b="yyyy");2<=a.length&&(b+="/mm");3===a.length&&(b+="/dd");return b},formatDate:c,formatDateNumber:function(a,b){var d;d=parseFloat(a);d=parseInt(864E5*Math.round(d/864E5),10);return c(new Date(d),b)}}}();wpd=wpd||{};
wpd.gridDetectionCore=function(){var c,a,b,d;return{run:function(){var f=[],e,g,h,l=wpd.appData.getPlotData().getAutoDetector(),q=l.gridMask.xmin,m=l.gridMask.xmax,k=l.gridMask.ymin,n=l.gridMask.ymax,p,u=l.imageWidth,r,t,s;if(a)for(e=q;e<=m;e+=b){h=[];t=[];r=0;for(p=e-b;p<=e+b;p++)for(g=k;g<=n;g++)s=g*u+parseInt(p,10),!0===l.gridBinaryData[s]&&(h[h.length]=s,!0!==t[g]&&(r++,t[g]=!0));if(r>0.3*(n-k))for(r=0;r<h.length;r++)f[h[r]]=!0}if(c)for(g=k;g<=n;g+=d){h=[];t=[];r=0;for(k=g-d;k<=g+d;k++)for(e=
q;e<=m;e++)s=parseInt(k,10)*u+e,!0===l.gridBinaryData[s]&&(h[h.length]=s,!0!==t[e]&&(r++,t[e]=!0));if(r>0.3*(m-q))for(r=0;r<h.length;r++)f[h[r]]=!0}wpd.appData.getPlotData().gridData=f},setHorizontalParameters:function(b,a,g){c=b;d=a},setVerticalParameters:function(d,c,g){a=d;b=c}}}();wpd=wpd||{};
wpd.InputParser=function(){return function(){this.parse=function(c){this.isDate=this.isValid=!1;this.formatting=null;if(null==c)return null;c=c.trim();if(0<=c.indexOf("^"))return null;var a=wpd.dateConverter.parse(c);if(null!=a)return this.isDate=this.isValid=!0,this.formatting=wpd.dateConverter.getFormatString(c),a;c=parseFloat(c);return isNaN(c)?null:(this.isValid=!0,c)};this.isDate=this.isValid=!1;this.formatting=null}}();wpd=wpd||{};
wpd.taninverse=function(c,a){var b;0<c?b=Math.atan2(c,a):0>=c&&(b=Math.atan2(c,a)+2*Math.PI);b>=2*Math.PI&&(b=0);return b};wpd.sqDist2d=function(c,a,b,d){return(c-b)*(c-b)+(a-d)*(a-d)};wpd.sqDist3d=function(c,a,b,d,f,e){return(c-d)*(c-d)+(a-f)*(a-f)+(b-e)*(b-e)};wpd.dist2d=function(c,a,b,d){return Math.sqrt(wpd.sqDist2d(c,a,b,d))};wpd.dist3d=function(c,a,b,d,f,e){return Math.sqrt(wpd.sqDist3d(c,a,b,d,f,e))};
wpd.mat=function(){function c(a){return a[0]*a[3]-a[1]*a[2]}return{det2x2:c,inv2x2:function(a){var b=c(a);return[a[3]/b,-a[1]/b,-a[2]/b,a[0]/b]},mult2x2:function(a,b){return[a[0]*b[0]+a[1]*b[2],a[0]*b[1]+a[1]*b[3],a[2]*b[0]+a[3]*b[2],a[2]*b[1]+a[3]*b[3]]},mult2x2Vec:function(a,b){return[a[0]*b[0]+a[1]*b[1],a[2]*b[0]+a[3]*b[1]]},multVec2x2:function(a,b){return[b[0]*a[0]+b[2]*a[1],b[1]*a[0]+b[3]*a[1]]}}}();wpd=wpd||{};
wpd.PlotData=function(){return function(){var c=0,a=new wpd.AutoDetector;this.axes=this.topColors=null;this.dataSeriesColl=[];this.distanceMeasurementData=this.angleMeasurementData=this.calibration=this.gridData=null;this.getActiveDataSeries=function(){null==this.dataSeriesColl[c]&&(this.dataSeriesColl[c]=new wpd.DataSeries);return this.dataSeriesColl[c]};this.getDataSeriesCount=function(){return this.dataSeriesColl.length};this.setActiveDataSeriesIndex=function(b){c=b};this.getActiveDataSeriesIndex=
function(){return c};this.getAutoDetector=function(){return a};this.getDataSeriesNames=function(){for(var b=[],a=0;a<this.dataSeriesColl.length;a++)b[a]=this.dataSeriesColl[a].name;return b};this.getDataFromActiveSeries=function(){var b=this.getActiveDataSeries();if(null==b||null==this.axes)return null;var a,f,e,g=[],h;a=b.hasMetadata();f=b.getMetadataKeys();var l=!0===a?f.length:0;for(a=0;a<b.getCount();a++){f=this.dataSeriesColl[c].getPixel(a);e=this.axes.pixelToData(f.x,f.y);g[a]=[];for(h=0;h<
e.length;h++)g[a][h]=e[h];for(h=0;h<l;h++)g[a][e.length+h]=f.metadata[h]}return g};this.reset=function(){this.distanceMeasurementData=this.angleMeasurementData=this.axes=null;this.dataSeriesColl=[];this.calibration=this.gridData=null;c=0;a=new wpd.AutoDetector}}}();wpd=wpd||{};
wpd.AveragingWindowAlgo=function(){return function(){var c=5,a=5;this.getParamList=function(){return[["\u0394X","Px",10],["\u0394Y","Px",10]]};this.setParam=function(b,d){0===b?c=d:1===b&&(a=d)};this.run=function(b){var d=b.getAutoDetector();b=b.getActiveDataSeries();(new wpd.AveragingWindowCore(d.binaryData,d.imageHeight,d.imageWidth,c,a,b)).run()}}}();wpd=wpd||{};
wpd.AveragingWindowCore=function(){return function(c,a,b,d,f,e){this.run=function(){var g=[],h=0,l=[],q,m,k,n,p,u,r,t,s;e.clearAll();for(q=0;q<b;q++){p=-1;k=-2*f;for(m=n=0;m<a;m++)!0===c[m*b+q]&&(m>k+f?(p+=1,n=1,k=l[p]=m):(n+=1,l[p]=parseFloat((l[p]*(n-1)+m)/parseFloat(n))));if(0<=p)for(k=q,m=0;m<=p;m++)n=l[m],g[h]=[],g[h][0]=parseFloat(k),g[h][1]=parseFloat(n),g[h][2]=!0,h+=1}if(0!==h){for(l=0;l<h;l++)if(!0===g[l][2]){q=!0;p=l+1;m=g[l][0];k=g[l][1];n=m;u=k;for(s=1;!0===q&&p<h;)r=g[p][0],t=g[p][1],
Math.abs(r-m)<=d&&Math.abs(t-k)<=f&&!0===g[p][2]&&(n=(n*s+r)/(s+1),u=(u*s+t)/(s+1),s+=1,g[p][2]=!1),r>m+2*d&&(q=!1),p+=1;g[l][2]=!1;e.addPixel(parseFloat(n),parseFloat(u))}return e}}}}();wpd=wpd||{};
wpd.AveragingWindowWithStepSizeAlgo=function(){return function(){var c,a,b,d,f,e;this.getParamList=function(){var b=wpd.appData.isAligned(),a=wpd.appData.getPlotData().axes;return b&&a instanceof wpd.XYAxes?(b=a.getBounds(),[["X_min","Units",b.x1],["\u0394X Step","Units",0.1],["X_max","Units",b.x2],["Y_min","Units",b.y3],["Y_max","Units",b.y4],["Line width","Px",30]]):[["X_min","Units",0],["\u0394X Step","Units",0.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Line width","Px",30]]};
this.setParam=function(g,h){0===g?c=h:1===g?a=h:2===g?b=h:3===g?f=h:4===g?e=h:5===g&&(d=h)};this.run=function(g){var h=g.getAutoDetector(),l=g.getActiveDataSeries();g=g.axes;var q=h.imageWidth,m=h.imageHeight,k,n,p,u,r,t,s,v,w;l.clearAll();for(k=c;k<=b;k+=a)for(w=g.dataToPixel(k,f),n=w.x,u=w.y,w=g.dataToPixel(k,e),p=w.x,r=w.y,n=Math.sqrt((r-u)*(r-u)+(p-n)*(p-n)),p=(e-f)/n,u=!1,t=r=0,s=!1,v=0;v<=n;v++)w=1*-v*p+e,w=g.dataToPixel(k,w),xi_pix=w.x,yi_pix=w.y,0<=xi_pix&&xi_pix<q&&0<=yi_pix&&yi_pix<m&&(!0===
h.binaryData[parseInt(yi_pix,10)*q+parseInt(xi_pix,10)]?(!1===u&&(t=r=v,u=!0,s=!1),!0===s&&(t=v,s=!1)):!1===s&&(t=v,s=!0),!0===u&&(v>r+d||v==n-1)&&(u=!1,r>t&&(t=v),w=(r+t)/2,w=1*-w*p+e,w=g.dataToPixel(k,w),l.addPixel(parseFloat(w.x),parseFloat(w.y))))}}}();wpd=wpd||{};
wpd.BlobDetectorAlgo=function(){return function(){var c,a;this.getParamList=function(){var b=wpd.appData.isAligned(),a=wpd.appData.getPlotData().axes;return b&&a instanceof wpd.MapAxes?[["Min Diameter","Units",0],["Max Diameter","Units",5E3]]:[["Min Diameter","Px",0],["Max Diameter","Px",5E3]]};this.setParam=function(b,d){0===b?c=parseFloat(d):1===b&&(a=parseFloat(d))};this.run=function(b){var d=b.getAutoDetector(),f=b.getActiveDataSeries(),e=d.imageWidth,g=d.imageHeight,h=[],l=[],q,m,k,n,p,u,r,t,
s;if(!(0>=e||0>=g||null==d.binaryData||0===d.binaryData.length)){f.clearAll();f.setMetadataKeys(["area","moment"]);for(q=0;q<e;q++)for(m=0;m<g;m++)if(!0===d.binaryData[m*e+q]&&!0!==h[m*e+q])for(h[m*e+q]=!0,n=l.length,l[n]={pixels:[{x:q,y:m}],centroid:{x:q,y:m},area:1,moment:0},k=0;k<l[n].pixels.length;){r=l[n].pixels[k].x;t=l[n].pixels[k].y;for(p=r-1;p<=r+1;p++)for(u=t-1;u<=t+1;u++)0<=p&&0<=u&&p<e&&u<g&&!0!==h[u*e+p]&&!0===d.binaryData[u*e+p]&&(h[u*e+p]=!0,s=l[n].pixels.length,l[n].pixels[s]={x:p,
y:u},l[n].centroid.x=(l[n].centroid.x*s+p)/(s+1),l[n].centroid.y=(l[n].centroid.y*s+u)/(s+1),l[n].area+=1);k+=1}for(n=0;n<l.length;n++){for(k=l[n].moment=0;k<l[n].pixels.length;k++)l[n].moment=l[n].moment+(l[n].pixels[k].x-l[n].centroid.x)*(l[n].pixels[k].x-l[n].centroid.x)+(l[n].pixels[k].y-l[n].centroid.y)*(l[n].pixels[k].y-l[n].centroid.y);b.axes instanceof wpd.MapAxes&&(l[n].area=b.axes.pixelToDataArea(l[n].area));d=2*Math.sqrt(l[n].area/Math.PI);d<=a&&d>=c&&f.addPixel(l[n].centroid.x,l[n].centroid.y,
[l[n].area,l[n].moment])}}}}}();wpd=wpd||{};
wpd.XStepWithInterpolationAlgo=function(){return function(){var c,a,b,d,f,e;this.getParamList=function(){var b=wpd.appData.isAligned(),a=wpd.appData.getPlotData().axes;return b&&a instanceof wpd.XYAxes?(b=a.getBounds(),[["X_min","Units",b.x1],["\u0394X Step","Units",(b.x2-b.x1)/50],["X_max","Units",b.x2],["Y_min","Units",b.y3],["Y_max","Units",b.y4],["Smoothing","% of \u0394X",0]]):[["X_min","Units",0],["\u0394X Step","Units",0.1],["X_max","Units",0],["Y_min","Units",0],["Y_max","Units",0],["Smoothing",
"% of \u0394X",0]]};this.setParam=function(g,h){0===g?c=h:1===g?a=h:2===g?b=h:3===g?f=h:4===g?e=h:5===g&&(d=h)};this.run=function(g){var h=g.getAutoDetector(),l=g.getActiveDataSeries();g=g.axes;var q=0,m=h.imageWidth,k=h.imageHeight,n,p,u,r,t,s,v=[],w=[];s=[];var x=[],y=Math.abs(d/100*a);l.clearAll();n=g.dataToPixel(c,f);p=g.dataToPixel(c,e);p=Math.sqrt((n.x-p.x)*(n.x-p.x)+(n.y-p.y)*(n.y-p.y));x=(e-f)/p;p=g.dataToPixel(b,f);n=Math.sqrt((n.x-p.x)*(n.x-p.x)+(n.y-p.y)*(n.y-p.y));p=(b-c)/n;0<Math.abs(y/
p)&&1>Math.abs(y/p)&&(y=p);for(n=c;0<p&&n<=b||0>p&&n>=b;){t=r=0;for(u=f;0<x&&u<=e||0>x&&u>=e;)s=g.dataToPixel(n,u),0<s.x&&0<s.y&&s.x<m&&s.y<k&&!0===h.binaryData[parseInt(s.y,10)*m+parseInt(s.x,10)]&&(r=(r*t+u)/parseFloat(t+1),t++),u+=x;0<t&&(v[q]=parseFloat(n),w[q]=parseFloat(r),q+=1);n+=p}if(!(0>=v.length||0>=w.length)){if(0<y)for(s=[],x=[],n=v[0];0<p&&n<=v[v.length-1]||0>p&&n>=v[v.length-1];){for(h=t=m=q=0;h<v.length;h++)v[h]<=n+y&&v[h]>=n-y&&(q=(q*t+v[h])/parseFloat(t+1),m=(m*t+w[h])/parseFloat(t+
1),t++);0<t&&(s[s.length]=q,x[x.length]=m);n=0<p?n+y:n-y}else s=v,x=w;if(!(0>=s.length||0>=x.length||(v=[],h=0,n=c,0>p&&0<a||0<p&&0>a))){for(;0<p&&n<=b||0>p&&n>=b;)v[h]=n,h++,n+=a;0>p&&(s=s.reverse(),x=x.reverse());w=numeric.spline(s,x).at(v);for(h=0;h<w.length;h++)isNaN(v[h])||isNaN(w[h])||(s=g.dataToPixel(v[h],w[h]),l.addPixel(s.x,s.y))}}}}}();wpd=wpd||{};
wpd.BarAxes=function(){var c=function(){var a=!1,b=!1,d,c,e,g,h,l;this.isCalibrated=function(){return a};this.calibrate=function(q,m){a=!1;var k=q.getPoint(0),n=q.getPoint(1);d=k.px;c=k.py;e=n.px;g=n.py;h=parseFloat(k.dy);l=parseFloat(n.dy);m?(b=!0,h=Math.log(h)/Math.log(10),l=Math.log(l)/Math.log(10)):b=!1;return a=!0};this.pixelToData=function(a,m){var k=[],n=((m-c)*(g-c)+(e-d)*(a-d))/((g-c)*(g-c)+(e-d)*(e-d));k[0]=a;k[1]=(l-h)*n+h;b&&(k[1]=Math.pow(10,k[1]));return k};this.dataToPixel=function(b,
a){return{x:0,y:0}};this.pixelToLiveString=function(b,a){return this.pixelToData(b,a)[1].toExponential(4)};this.isLog=function(){return b};this.getTransformationEquations=function(){return{pixelToData:["",""],dataToPixel:["",""]}}};c.prototype.numCalibrationPointsRequired=function(){return 2};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["Label","Y"]};return c}();wpd=wpd||{};
wpd.ImageAxes=function(){var c=function(){this.isCalibrated=function(){return!0};this.calibrate=function(){return!0};this.pixelToData=function(a,b){return[a,b]};this.dataToPixel=function(a,b){return{x:a,y:b}};this.pixelToLiveString=function(a,b){var d=this.pixelToData(a,b);return d[0].toFixed(2)+", "+d[1].toFixed(2)};this.getTransformationEquations=function(){return{pixelToData:["x_data = x_pixel","y_data = y_pixel"],dataToPixel:["x_pixel = x_data","y_pixel = y_data"]}}};c.prototype.numCalibrationPointsRequired=
function(){return 0};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X","Y"]};return c}();wpd=wpd||{};
wpd.MapAxes=function(){var c=function(){var a=!1,b,d,c;this.isCalibrated=function(){return a};this.calibrate=function(e,g,h){var l=e.getPoint(0);e=e.getPoint(1);c=Math.sqrt((l.px-e.px)*(l.px-e.px)+(l.py-e.py)*(l.py-e.py));b=parseFloat(g);d=h;return a=!0};this.pixelToData=function(a,d){var h=[];h[0]=a*b/c;h[1]=d*b/c;return h};this.pixelToDataDistance=function(a){return a*b/c};this.pixelToDataArea=function(a){return a*b*b/(c*c)};this.dataToPixel=function(b,a,d){return{x:0,y:0}};this.pixelToLiveString=
function(b,a){var d=this.pixelToData(b,a);return d[0].toExponential(4)+", "+d[1].toExponential(4)};this.getScaleLength=function(){return b};this.getUnits=function(){return d};this.getTransformationEquations=function(){return{pixelToData:["x_data = "+b/c+"*x_pixel","y_data = "+b/c+"*y_pixel"],dataToPixel:["x_pixel = "+c/b+"*x_data","y_pixel = "+c/b+"*y_data"]}}};c.prototype.numCalibrationPointsRequired=function(){return 2};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X",
"Y"]};return c}();wpd=wpd||{};
wpd.PolarAxes=function(){var c=function(){var a=!1,b=!1,d=!1,c,e,g,h,l,q,m,k,n,p,u,r,t,s;processCalibration=function(a,w,x){var y=a.getPoint(0),H=a.getPoint(1);a=a.getPoint(2);c=y.px;e=y.py;g=H.px;h=H.py;l=a.px;q=a.py;m=H.dx;k=H.dy;n=a.dx;b=w;d=x;!0===b&&(k*=Math.PI/180);p=Math.sqrt((g-c)*(g-c)+(h-e)*(h-e));u=Math.sqrt((l-c)*(l-c)+(q-e)*(q-e));r=u-p;t=wpd.taninverse(-(h-e),g-c);s=d?t+k:t-k;return!0};this.isCalibrated=function(){return a};this.calibrate=function(b,d,c){return a=processCalibration(b,
d,c)};this.isThetaDegrees=function(){return b};this.isThetaClockwise=function(){return d};this.pixelToData=function(a,g){var h=[],l,k;xp=parseFloat(a);yp=parseFloat(g);l=(n-m)/r*(Math.sqrt((xp-c)*(xp-c)+(yp-e)*(yp-e))-p)+m;k=d?s-wpd.taninverse(-(yp-e),xp-c):wpd.taninverse(-(yp-e),xp-c)-s;0>k&&(k+=2*Math.PI);!0==b&&(k=180*k/Math.PI);h[0]=l;h[1]=k;return h};this.dataToPixel=function(b,a){return{x:0,y:0}};this.pixelToLiveString=function(b,a){var d=this.pixelToData(b,a);return d[0].toExponential(4)+", "+
d[1].toExponential(4)};this.getTransformationEquations=function(){var a="r = ("+(n-m)/r+")*sqrt((x_pixel - "+c+")^2 + (y_pixel - "+e+")^2) + ("+(m-p*(n-m)/r)+")",g;g=d?s-NaN+e+" - y_pixel), (x_pixel - "+c+"))":"atan2(("+e+" - y_pixel), (x_pixel - "+c+")) - ("+s+")";g=b?"theta = (180/PI)*("+g+"), theta = theta + 360 if theta < 0":"theta = "+g+" theta = theta + 2*PI if theta < 0";return{pixelToData:[a,g]}}};c.prototype.numCalibrationPointsRequired=function(){return 3};c.prototype.getDimensions=function(){return 2};
c.prototype.getAxesLabels=function(){return["r","\u03b8"]};return c}();wpd=wpd||{};
wpd.TernaryAxes=function(){var c=function(){var a=!1,b,d,c,e,g,h,l,q,m;this.isCalibrated=function(){return a};this.calibrate=function(k,n,p){var u=k.getPoint(0),r=k.getPoint(1);k.getPoint(2);b=u.px;d=u.py;c=r.px;e=r.py;g=Math.sqrt((b-c)*(b-c)+(d-e)*(d-e));h=wpd.taninverse(-(e-d),c-b);l=Math.sqrt(3);q=n;m=p;return a=!0};this.isRange100=function(){return q};this.isNormalOrientation=function(){return m};this.pixelToData=function(a,c){var e=[],f,r,t,s;xp=parseFloat(a);yp=parseFloat(c);f=Math.sqrt((xp-
b)*(xp-b)+(yp-d)*(yp-d));r=wpd.taninverse(-(yp-d),xp-b)-h;t=f*Math.cos(r)/g;r=f*Math.sin(r)/g;f=1-t-r/l;t-=r/l;r=2*r/l;!1==m&&(s=t,t=f,f=r,r=s);!0==q&&(f*=100,t*=100,r*=100);e[0]=f;e[1]=t;e[2]=r;return e};this.dataToPixel=function(b,a,d){return{x:0,y:0}};this.pixelToLiveString=function(b,a){var d=this.pixelToData(b,a);return d[0].toExponential(4)+", "+d[1].toExponential(4)+", "+d[2].toExponential(4)};this.getTransformationEquations=function(){var a="rp = sqrt((x_pixel - "+b+")^2 + (y_pixel - "+d+
")^2)/("+g+")",h="thetap = atan2(("+d+" -  y_pixel), (x_pixel - "+b+")) - ("+Math.atan2(-(e-d),c-b)+")",l="1 - rp*(cos(thetap) - sin(thetap)/sqrt(3))",u="rp*(cos(thetap) - sin(thetap)/sqrt(3))",r="2*rp*sin(thetap)/sqrt(3)",t;q&&(l="100*("+l+")",u="100*("+u+")",r="100*("+r+")");l="a_data = "+l;u="b_data = "+u;r="c_data = "+r;m||(t=u,u=l,l=r,r=t);return{pixelToData:[a,h,l,u,r]}}};c.prototype.numCalibrationPointsRequired=function(){return 3};c.prototype.getDimensions=function(){return 3};c.prototype.getAxesLabels=
function(){return["a","b","c"]};return c}();wpd=wpd||{};
wpd.XYAxes=function(){var c=function(){var a=!1,b=!1,d=!1,c=!1,e=!1,g,h,l,q,m,k,n,p,u,r,t,s,v,w,x=[0,0,0,0],y=[0,0,0,0];c_vec=[0,0];processCalibration=function(a,F,D){if(4>a.getCount())return!1;var I=a.getPoint(0),G=a.getPoint(1),N=a.getPoint(2);a=a.getPoint(3);var E=new wpd.InputParser;l=I.px;n=I.py;q=G.px;p=G.py;m=N.px;u=N.py;k=a.px;r=a.py;t=I.dx;s=G.dx;v=N.dy;w=a.dy;t=E.parse(t);if(!E.isValid)return!1;c=E.isDate;s=E.parse(s);if(!E.isValid||E.isDate!=c)return!1;g=E.formatting;v=E.parse(v);if(!E.isValid)return!1;
e=E.isDate;w=E.parse(w);if(!E.isValid||E.isDate!=e)return!1;h=E.formatting;b=F;d=D;!0===b&&(t=Math.log(t)/Math.log(10),s=Math.log(s)/Math.log(10));!0===d&&(v=Math.log(v)/Math.log(10),w=Math.log(w)/Math.log(10));x=wpd.mat.mult2x2([t-s,0,0,v-w],wpd.mat.inv2x2([l-q,m-k,n-p,u-r]));y=wpd.mat.inv2x2(x);c_vec[0]=t-x[0]*l-x[1]*n;c_vec[1]=v-x[2]*m-x[3]*u;return!0};this.getBounds=function(){return{x1:t,x2:s,y3:v,y4:w}};this.isCalibrated=function(){return a};this.calibrate=function(b,d,c){return a=processCalibration(b,
d,c)};this.pixelToData=function(a,c){var e=[],f,g;f=parseFloat(a);g=parseFloat(c);g=wpd.mat.mult2x2Vec(x,[f,g]);g[0]+=c_vec[0];g[1]+=c_vec[1];f=g[0];g=g[1];!0===b&&(f=Math.pow(10,f));!0===d&&(g=Math.pow(10,g));e[0]=f;e[1]=g;return e};this.dataToPixel=function(a,b){var d;d=wpd.mat.mult2x2Vec(y,[a-c_vec[0],b-c_vec[1]]);return{x:d[0],y:d[1]}};this.pixelToLiveString=function(a,b){var d="",l=this.pixelToData(a,b),d=c?d+wpd.dateConverter.formatDateNumber(l[0],g):d+l[0].toExponential(4),d=d+", ";return d=
e?d+wpd.dateConverter.formatDateNumber(l[1],h):d+l[1].toExponential(4)};this.isDate=function(a){return 0===a?c:e};this.getInitialDateFormat=function(a){return 0===a?g:h};this.isLogX=function(){return b};this.isLogY=function(){return d};this.getTransformationEquations=function(){var a="("+x[0]+")*x_pixel + ("+x[1]+")*y_pixel + ("+c_vec[0]+")",c="("+x[2]+")*x_pixel + ("+x[3]+")*y_pixel + ("+c_vec[1]+")",e="x_pixel = ("+y[0]+")*x_data + ("+y[1]+")*y_data + ("+(-y[0]*c_vec[0]-y[1]*c_vec[1])+")",g="y_pixel = ("+
y[2]+")*x_data + ("+y[3]+")*y_data + ("+(-y[2]*c_vec[0]-y[3]*c_vec[1])+")",a=b?"x_data = pow(10, "+a+")":"x_data = "+a,c=d?"y_data = pow(10, "+c+")":"y_data = "+c;return b||d?{pixelToData:[a,c]}:{pixelToData:[a,c],dataToPixel:[e,g]}}};c.prototype.numCalibrationPointsRequired=function(){return 4};c.prototype.getDimensions=function(){return 2};c.prototype.getAxesLabels=function(){return["X","Y"]};return c}();wpd=wpd||{};
wpd.dataTable=function(){function c(){e=wpd.appData.getPlotData().getDataFromActiveSeries()}function a(){g=e.slice(0);var a=document.getElementById("data-sort-variables").value,b="ascending"===document.getElementById("data-sort-order").value,d="raw"===a,c="NearestNeighbor"===a,f,h=wpd.appData.getPlotData().axes.getDimensions();if(!d)if(!c)f=parseInt(a,10),g.sort(function(a,d){return a[f]>d[f]?b?1:-1:a[f]<d[f]?b?-1:1:0});else if(c){var u,c=[1,1,1],r,t,s=e.length;for(r=0;r<s-1;r++){d=-1;for(t=r+1;t<
s;t++)if(a=(g[r][0]-g[t][0])*(g[r][0]-g[t][0])+(g[r][1]-g[t][1])*(g[r][1]-g[t][1]),3===h&&(a+=(g[r][2]-g[t][2])*(g[r][2]-g[t][2])),a<u||-1===d)u=a,d=t;c[0]=g[d][0];g[d][0]=g[r+1][0];g[r+1][0]=c[0];c[1]=g[d][1];g[d][1]=g[r+1][1];g[r+1][1]=c[1];3===h&&(c[2]=g[d][2],g[d][2]=g[r+1][2],g[r+1][2]=c[2])}}}function b(){var a=document.getElementById("data-sort-variables").value,b=document.getElementById("data-sort-order");"NearestNeighbor"===a||"raw"===a?b.setAttribute("disabled",!0):b.removeAttribute("disabled")}
function d(){if(null!=e){var a=wpd.appData.getPlotData().axes,b=wpd.appData.getPlotData().getActiveDataSeries(),d=a.getDimensions(),b=b.getMetadataKeys().length,c=e.length,f,p,u,r=document.getElementById("digitizedDataTable"),t=[],s=parseInt(document.getElementById("data-number-format-digits").value,10),v=document.getElementById("data-number-format-style").value,w=document.getElementById("data-number-format-separator").value,w=w.replace(/[^\\]\\t/,"\t").replace(/^\\t/,"\t");h="";for(f=0;f<c;f++){u=
[];for(p=0;p<d+b;p++)p<d&&null!=a.isDate&&a.isDate(p)?(void 0===t[p]&&(t[p]=document.getElementById("data-format-string-"+p).value),u[p]=wpd.dateConverter.formatDateNumber(g[f][p],t[p])):u[p]="fixed"===v&&0<=s?g[f][p].toFixed(s):"precision"===v&&0<=s?g[f][p].toPrecision(s):"exponential"===v&&0<=s?g[f][p].toExponential(s):g[f][p];h+=u.join(w);h+="\n"}r.value=h}}function f(){if(wpd.appData.isAligned()){wpd.popup.show("csvWindow");c();var e=document.getElementById("data-sort-variables"),f=document.getElementById("dataVariables"),
g=document.getElementById("data-date-formatting-container"),h=document.getElementById("data-date-formatting"),n=wpd.appData.getPlotData().axes,p=wpd.appData.getPlotData().getActiveDataSeries(),u=n.getAxesLabels(),r="",t=u.join(", "),s="";isAnyVariableDate=!1;tableVariables=u;dimCount=n.getDimensions();p.hasMetadata()&&(tableVariables=u.concat(p.getMetadataKeys()),t=tableVariables.join(", "));g.style.display="none";r+='<option value="raw">Raw</option>';for(p=0;p<tableVariables.length;p++)r+='<option value="'+
p+'">'+tableVariables[p]+"</option>",p<dimCount&&null!=n.isDate&&null!=n.getInitialDateFormat&&n.isDate(p)&&(s+="<p>"+u[p]+' <input type="text" length="15" value="'+n.getInitialDateFormat(p)+'" id="data-format-string-'+p+'"/></p>',isAnyVariableDate=!0);e.innerHTML=r+'<option value="NearestNeighbor">Nearest Neighbor</option>';f.innerHTML=t;isAnyVariableDate&&(g.style.display="inline-block",h.innerHTML=s);a();d();b();for(var e=document.getElementById("data-table-dataset-list"),f=wpd.appData.getPlotData(),
g=f.getActiveDataSeriesIndex(),v,h=0;h<f.dataSeriesColl.length;h++)v+="<option>"+f.dataSeriesColl[h].name+"</option>";e.innerHTML=v;e.selectedIndex=g}}var e,g,h;return{getSeriesData:c,showTable:f,updateSortingControls:b,reSort:function(){b();a();d()},selectAll:function(){var a=document.getElementById("digitizedDataTable");a.focus();a.select()},generateCSV:function(){wpd.download.csv(JSON.stringify(h))},exportToPlotly:function(){if(null!=e&&0!==e.length){var a=document.createElement("div"),b=document.createElement("form"),
d=document.createElement("textarea");b.setAttribute("method","post");b.setAttribute("action","https://plot.ly/external");b.setAttribute("target","_blank");d.setAttribute("name","data");d.setAttribute("id","data");b.appendChild(d);a.appendChild(b);document.body.appendChild(a);a.style.display="none";var c={data:[]},f=wpd.appData.getPlotData().axes,h=wpd.appData.getPlotData().getActiveDataSeries().getMetadataKeys(),u=h.length,r=f.getDimensions(),t=e.length,s,v,w=["x","y","z"];c.data[0]={};for(s=0;s<
t;s++)for(rowValues=[],v=0;v<r+u;v++)0===s&&(v<r?c.data[0][w[v]]=[]:c.data[0][h[v-r]]=[]),v<r&&null!=f.isDate&&f.isDate(v)?c.data[0][w[v]][s]=wpd.dateConverter.formatDateNumber(g[s][v],"yyyy-mm-dd"):v<r?c.data[0][w[v]][s]=g[s][v]:c.data[0][h[v-r]][s]=g[s][v];d.innerHTML=JSON.stringify(c);b.submit();document.body.removeChild(a)}},changeDataset:function(){var a=document.getElementById("data-table-dataset-list");wpd.appData.getPlotData().setActiveDataSeriesIndex(a.selectedIndex);wpd.graphicsWidget.forceHandlerRepaint();
wpd.dataPointCounter.setCount();wpd.popup.close("csvWindow");f()}}}();wpd=wpd||{};
wpd.graphicsWidget=function(){function c(a){var b=x.getBoundingClientRect();return{x:parseInt(a.pageX-(b.left+window.pageXOffset),10),y:parseInt(a.pageY-(b.top+window.pageYOffset),10)}}function a(a,b){return{x:a/J,y:b/J}}function b(a,b){a=parseInt(a,10);b=parseInt(b,10);N.style.width=a+"px";N.style.height=b+"px";x.width=a;y.width=a;H.width=a;F.width=a;D.width=a;x.height=b;y.height=b;H.height=b;F.height=b;D.height=b;V=a/(1*b);K=a;L=b;if(null!=O){E.fillStyle="rgb(255, 255, 255)";E.fillRect(0,0,K,L);
E.drawImage(I,0,0,K,L);if(null!=A&&void 0!=A.onRedraw)A.onRedraw();if(null!=z&&void 0!=z.onRedraw)z.onRedraw()}}function d(){x.width=x.width;y.width=y.width;H.width=H.width;F.width=F.width;D.width=D.width;G.width=G.width}function f(){if(null!=A&&void 0!=A.onRemove)A.onRemove();A=null}function e(){var a=wpd.layoutManager.getGraphicsViewportSize();b(a.width,a.height);V>Q?(J=L/(1*B),b(L*Q,L)):(J=K/(1*C),b(K,K/Q))}function g(a){J=a;b(C*J,B*J)}function h(a,b){var d=wpd.zoomView.getSize(),c=wpd.zoomView.getZoomRatio(),
e,f,g,h,l,m,k,n=0,q=0,p=d.width,r=d.height;g=d.width/c;h=d.height/c;e=a-g/2;f=b-h/2;m=e;d=f;l=e+g;k=f+h;0>e&&(m=0,n=-e*c);0>f&&(d=0,q=-f*c);e+g>=C&&(l=C,p-=c*(C-(e+g)));f+h>=B&&(k=B,r-=c*(B-(f+h)));g=P.getImageData(parseInt(m,10),parseInt(d,10),parseInt(l-m,10),parseInt(k-d,10));l=R.getImageData(parseInt(m,10),parseInt(d,10),parseInt(l-m,10),parseInt(k-d,10));for(k=0;k<l.data.length;k+=4)if(0!=l.data[k]||0!=l.data[k+1]||0!=l.data[k+2])g.data[k]=l.data[k],g.data[k+1]=l.data[k+1],g.data[k+2]=l.data[k+
2];m=c*(parseInt(m,10)-m);c*=parseInt(d,10)-d;wpd.zoomView.setZoomImage(g,parseInt(n+m,10),parseInt(q+c,10),parseInt(p-n,10),parseInt(r-q,10))}function l(b){clearTimeout(W);var d=setTimeout,e=c(b);b=e.x;var e=e.y,f=a(b,e);S&&(F.width=F.width,M.strokeStyle="rgba(0,0,0, 0.5)",M.beginPath(),M.moveTo(b,0),M.lineTo(b,L),M.moveTo(0,e),M.lineTo(K,e),M.stroke());h(f.x,f.y);wpd.zoomView.setCoords(f.x,f.y);W=d(void 0,10)}function q(){x=document.getElementById("mainCanvas");y=document.getElementById("dataCanvas");
H=document.getElementById("drawCanvas");F=document.getElementById("hoverCanvas");D=document.getElementById("topCanvas");I=document.createElement("canvas");G=document.createElement("canvas");E=x.getContext("2d");T=y.getContext("2d");M=F.getContext("2d");X=D.getContext("2d");Y=H.getContext("2d");P=I.getContext("2d");R=G.getContext("2d");N=document.getElementById("canvasDiv");document.addEventListener("keydown",function(a){U&&220===a.keyCode&&(a.preventDefault(),S=!S,F.width=F.width)},!1);D.addEventListener("mousemove",
l,!1);D.addEventListener("dragover",function(a){a.preventDefault()},!0);D.addEventListener("drop",function(a){a.preventDefault();wpd.busyNote.show();a=a.dataTransfer.files;1===a.length&&k(a[0])},!0);D.addEventListener("mousemove",u,!1);D.addEventListener("click",r,!1);D.addEventListener("mouseup",s,!1);D.addEventListener("mousedown",v,!1);D.addEventListener("mouseout",w,!0);document.addEventListener("mouseup",t,!1);document.addEventListener("mousedown",function(a){U=a.target===D?!0:!1},!1);document.addEventListener("keydown",
function(a){if(U&&null!=z&&void 0!=z.onKeyDown)z.onKeyDown(a)},!0);wpd.zoomView.initZoom();document.getElementById("fileLoadBox").addEventListener("change",n);window.addEventListener("paste",function(a){if(void 0!==a.clipboardData&&(a=a.clipboardData.items,void 0!==a))for(var b=0;b<a.length;b++)if(-1!==a[b].type.indexOf("image")){wpd.busyNote.show();var d=a[b].getAsFile();(window.URL||window.webkitURL).createObjectURL(d);k(d)}},!1)}function m(a){var b=document.createElement("img");b.onload=function(){null==
x&&q();wpd.appData.reset();wpd.sidebar.clear();p();f();C=b.width;B=b.height;Q=C/(1*B);I.width=C;I.height=B;G.width=C;G.height=B;P.drawImage(b,0,0,C,B);O=P.getImageData(0,0,C,B);d();e();wpd.appData.plotLoaded(O);wpd.busyNote.close();!1===Z&&wpd.popup.show("axesList");Z=!1};b.src=a}function k(a){if(a.type.match("image.*")){var b=new FileReader;b.onload=function(){m(b.result)};b.readAsDataURL(a)}}function n(){var a=document.getElementById("fileLoadBox");1==a.files.length&&(a=a.files[0],wpd.busyNote.show(),
k(a));wpd.popup.close("loadNewImage")}function p(){if(null!=z&&void 0!=z.onRemove)z.onRemove();z=null}function u(b){if(null!=z&&void 0!=z.onMouseMove){var d=c(b),e=a(d.x,d.y);z.onMouseMove(b,d,e)}}function r(b){if(null!=z&&void 0!=z.onMouseClick){var d=c(b),e=a(d.x,d.y);z.onMouseClick(b,d,e)}}function t(b){if(null!=z&&void 0!=z.onDocumentMouseUp){var d=c(b),e=a(d.x,d.y);z.onDocumentMouseUp(b,d,e)}}function s(b){if(null!=z&&void 0!=z.onMouseUp){var d=c(b),e=a(d.x,d.y);z.onMouseUp(b,d,e)}}function v(b){if(null!=
z&&void 0!=z.onMouseDown){var d=c(b),e=a(d.x,d.y);z.onMouseDown(b,d,e)}}function w(b){if(null!=z&&void 0!=z.onMouseOut){var d=c(b),e=a(d.x,d.y);z.onMouseOut(b,d,e)}}var x,y,H,F,D,I,G,N,E,T,Y,M,X,P,R,K,L,C,B,Q,V,O,J,S=!1,W,z,A,U=!1,Z=!0;return{zoomIn:function(){g(1.2*J)},zoomOut:function(){g(J/1.2)},zoomFit:e,zoom100perc:function(){g(1)},setZoomRatio:g,getZoomRatio:function(){return J},loadImageFromURL:m,load:n,runImageOp:function(a){var b=a(O,C,B);a=b.imageData;var c=b.width,b=b.height;wpd.appData.reset();
p();f();C=c;B=b;Q=C/(1*B);I.width=C;I.height=B;G.width=C;G.height=B;P.putImageData(a,0,0);O=a;d();e();wpd.appData.plotLoaded(O)},setTool:function(a){if(null!=z&&void 0!=z.onRemove)z.onRemove();z=a;if(null!=z&&void 0!=z.onAttach)z.onAttach()},removeTool:p,getAllContexts:function(){return{mainCtx:E,dataCtx:T,drawCtx:Y,hoverCtx:M,topCtx:X,oriImageCtx:P,oriDataCtx:R}},resetData:function(){G.width=G.width;y.width=y.width},resetHover:function(){F.width=F.width},imagePx:a,screenPx:function(a,b){return{x:a*
J,y:b*J}},updateZoomOnEvent:function(b){b=c(b);b=a(b.x,b.y);h(b.x,b.y);wpd.zoomView.setCoords(b.x,b.y)},updateZoomToImagePosn:function(a,b){h(a,b);wpd.zoomView.setCoords(a,b)},getDisplaySize:function(){return{width:K,height:L}},getImageSize:function(){return{width:C,height:B}},copyImageDataLayerToScreen:function(){T.drawImage(G,0,0,K,L)},setRepainter:function(a){if(null==A||void 0==A.painterName||null==a||void 0==a.painterName||A.painterName!=a.painterName){if(null!=A&&void 0!=A.onRemove)A.onRemove();
A=a;if(null!=A&&void 0!=A.onAttach)A.onAttach()}},removeRepainter:f,forceHandlerRepaint:function(){if(null!=A&&void 0!=A.onForcedRedraw)A.onForcedRedraw()},getRepainter:function(){return A},saveImage:function(){var a=document.createElement("canvas"),b=a.getContext("2d"),d,c,e;a.width=C;a.height=B;b.drawImage(I,0,0,C,B);d=b.getImageData(0,0,C,B);e=R.getImageData(0,0,C,B);for(c=0;c<d.data.length;c+=4)if(0!=e.data[c]||0!=e.data[c+1]||0!=e.data[c+2])d.data[c]=e.data[c],d.data[c+1]=e.data[c+1],d.data[c+
2]=e.data[c+2];b.putImageData(d,0,0);window.open(a.toDataURL(),"_blank")}}}();wpd=wpd||{};
wpd.layoutManager=function(){function c(){var a=parseInt(document.body.offsetWidth,10),b=parseInt(document.body.offsetHeight,10);f.style.height=b+"px";e.style.height=b-280+"px";g.style.width=a-f.offsetWidth-5+"px";g.style.height=b+"px";d.style.height=b-44+"px";wpd.sidebar.resize()}function a(a){clearTimeout(b);b=setTimeout(c,80)}var b,d,f,e,g;return{initialLayout:function(){d=document.getElementById("graphicsContainer");f=document.getElementById("sidebarContainer");e=document.getElementById("sidebarControlsContainer");
g=document.getElementById("mainContainer");c();window.addEventListener("resize",a,!1)},getGraphicsViewportSize:function(){return{width:d.offsetWidth,height:d.offsetHeight}}}}();wpd=wpd||{};
wpd.popup=function(){function c(d){var c=document.createElement("div");c.className="popup-drag-mask";c.style.display="inline-block";c.addEventListener("mousemove",a,!1);c.addEventListener("mouseup",b,!1);c.addEventListener("mouseout",f,!1);document.body.appendChild(c);g={dragMaskDiv:c,initialMouseX:d.pageX,initialMouseY:d.pageY,initialWindowX:h.offsetLeft,initialWindowY:h.offsetTop};d.preventDefault();d.stopPropagation()}function a(a){d(a);a.stopPropagation();a.preventDefault()}function b(a){d(a);
e();a.stopPropagation();a.preventDefault()}function d(a){var b=g.initialWindowX+a.pageX-g.initialMouseX;a=g.initialWindowY+a.pageY-g.initialMouseY;var d=parseInt(document.body.offsetWidth,10),c=parseInt(document.body.offsetHeight,10),e=parseInt(h.offsetWidth,10),f=parseInt(h.offsetHeight,10);b+0.7*e<d&&0<b&&0<a&&a+0.5*f<c&&(h.style.top=a+"px",h.style.left=b+"px")}function f(a){e()}function e(){null!=g&&null!=g.dragMaskDiv&&(g.dragMaskDiv.removeEventListener("mouseout",f,!1),g.dragMaskDiv.removeEventListener("mouseup",
b,!1),g.dragMaskDiv.removeEventListener("mousemove",a,!1),g.dragMaskDiv.style.display="none",document.body.removeChild(g.dragMaskDiv),g=null)}var g=null,h=null;return{show:function(a){document.getElementById("shadow").style.visibility="visible";a=document.getElementById(a);var b=parseInt(window.innerWidth,10),d=parseInt(window.innerHeight,10),e=parseInt(a.offsetWidth,10),f=parseInt(a.offsetHeight,10),d=(d-f)/2;a.style.left=(b-e)/2+"px";a.style.top=(60<d?60:d)+"px";a.style.visibility="visible";for(b=
0;b<a.childNodes.length;b++)if("popupheading"===a.childNodes[b].className){a.childNodes[b].addEventListener("mousedown",c,!1);break}h=a},close:function(a){document.getElementById("shadow").style.visibility="hidden";document.getElementById(a).style.visibility="hidden";e();h=null}}}();
wpd.busyNote=function(){var c,a=!1;return{show:function(){a||(null==c&&(c=document.createElement("div"),c.id="wait",c.innerHTML='<p align="center">Processing...</p>'),document.body.appendChild(c),a=!0)},close:function(){null!=c&&!0===a&&(document.body.removeChild(c),a=!1)}}}();
wpd.messagePopup=function(){var c;return{show:function(a,b,d){wpd.popup.show("messagePopup");document.getElementById("message-popup-heading").innerHTML=a;document.getElementById("message-popup-text").innerHTML=b;c=d},close:function(){wpd.popup.close("messagePopup");null!=c&&c()}}}();
wpd.okCancelPopup=function(){var c,a;return{show:function(b,d,f,e){wpd.popup.show("okCancelPopup");document.getElementById("ok-cancel-popup-heading").innerHTML=b;document.getElementById("ok-cancel-popup-text").innerHTML=d;c=f;a=e},ok:function(){wpd.popup.close("okCancelPopup");c()},cancel:function(){wpd.popup.close("okCancelPopup");a()}}}();wpd.unsupported=function(){wpd.messagePopup.show("Unsupported Feature!","This feature has not been implemented in the current version. This may be available in a future release.")};
wpd=wpd||{};
wpd.sidebar=function(){function c(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)a[b].style.display="none"}return{show:function(a){c();a=document.getElementById(a);a.style.display="inline-block";a.style.height=parseInt(document.body.offsetHeight,10)-280+"px"},clear:c,resize:function(){var a=document.getElementsByClassName("sidebar"),b;for(b=0;b<a.length;b++)"inline-block"===a[b].style.display&&(a[b].style.height=parseInt(document.body.offsetHeight,10)-280+"px")}}}();
wpd=wpd||{};wpd.toolbar=function(){function c(){var a=document.getElementsByClassName("toolbar"),b;for(b=0;b<a.length;b++)a[b].style.visibility="hidden"}return{show:function(a){c();document.getElementById(a).style.visibility="visible"},clear:c}}();wpd=wpd||{};
wpd.transformationEquations=function(){return{show:function(){if(!1===wpd.appData.isAligned())wpd.messagePopup.show("Transformation Equations","Transformation equations are available only after axes have been calibrated.");else{wpd.popup.show("axes-transformation-equations-window");var c=document.getElementById("axes-transformation-equation-list"),a="",b=wpd.appData.getPlotData().axes,d=b.getTransformationEquations(),a=a+"<p><b>Axes Type</b>: ";b instanceof wpd.XYAxes?a+="XY</p>":b instanceof wpd.PolarAxes?
a+="Polar</p>":b instanceof wpd.TernaryAxes?a+="Ternary</p>":b instanceof wpd.MapAxes?a+="Map</p>":b instanceof wpd.ImageAxes&&(a+="Image</p>");if(null!=d.pixelToData){a+="<p><b>Pixel to Data</b></p><ol>";for(b=0;b<d.pixelToData.length;b++)a+='<li><p class="footnote">'+d.pixelToData[b]+"</p></li>";a+="</ol>"}a+="<p>&nbsp;</p>";if(null!=d.dataToPixel){a+="<p><b>Data to Pixel</b></p><ol>";for(b=0;b<d.dataToPixel.length;b++)a+='<li><p class="footnote">'+d.dataToPixel[b]+"</p></li>";a+="</ol>"}c.innerHTML=
a}}}}();wpd=wpd||{};
wpd.webcamCapture=function(){function c(){void 0!=a&&a.stop();wpd.popup.close("webcamCapture")}var a;return{start:function(){if(null==(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia))wpd.messagePopup.show("Webcam Capture","Your browser does not support webcam capture using HTML5 APIs. A recent version of Google Chrome is recommended.");else{wpd.popup.show("webcamCapture");var b=document.getElementById("webcamVideo");navigator.getUserMedia=navigator.getUserMedia||
navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;navigator.getUserMedia({video:!0},function(d){a=d;b.src=window.URL.createObjectURL(d)},function(){})}},cancel:function(){c()},capture:function(){var a=document.createElement("canvas"),d=document.getElementById("webcamVideo"),f=a.getContext("2d"),e;a.width=d.videoWidth;a.height=d.videoHeight;f.drawImage(d,0,0);e=f.getImageData(0,0,a.width,a.height);c();wpd.graphicsWidget.runImageOp(function(){return{imageData:e,width:a.width,
height:a.height}})}}}();wpd=wpd||{};
wpd.zoomView=function(){function c(){var a=document.getElementById("zoomCrossHair"),b=a.getContext("2d");a.width=a.width;b.strokeStyle="black"===q?"rgba(0,0,0,1)":"red"===q?"rgba(255,0,0,1)":"yellow"===q?"rgba(255,255,0,1)":"rgba(0,0,0,1)";b.beginPath();b.moveTo(e/2,0);b.lineTo(e/2,g);b.moveTo(0,g/2);b.lineTo(e,g/2);b.stroke()}var a,b,d,f,e=250,g=250,h,l,q="black";return{initZoom:function(){a=document.getElementById("zoomCanvas");b=a.getContext("2d");d=document.createElement("canvas");f=d.getContext("2d");
h=document.getElementById("mousePosition");l=5;c()},setZoomImage:function(c,e,g,h,q){d.width=h/l;d.height=q/l;f.putImageData(c,0,0);a.width=a.width;b.drawImage(d,e,g,h,q)},setCoords:function(a,b){if(wpd.appData.isAligned()){var d=wpd.appData.getPlotData();h.innerHTML=d.axes.pixelToLiveString(a,b)}else h.innerHTML=a.toFixed(2)+", "+b.toFixed(2)},setZoomRatio:function(a){l=a},getZoomRatio:function(){return l},getSize:function(){return{width:e,height:g}},showSettingsWindow:function(){document.getElementById("zoom-magnification-value").value=
l;document.getElementById("zoom-crosshair-color-value").value=q;wpd.popup.show("zoom-settings-popup")},applySettings:function(){l=document.getElementById("zoom-magnification-value").value;q=document.getElementById("zoom-crosshair-color-value").value;c();wpd.popup.close("zoom-settings-popup")}}}();wpd=wpd||{};
wpd.xyCalibration=function(){function c(){wpd.popup.show("xyAlignment")}return{start:function(){wpd.popup.show("xyAxesInfo")},pickCorners:function(){wpd.popup.close("xyAxesInfo");var a=new wpd.AxesCornersTool(4,2,["X1","X2","Y1","Y2"]);wpd.graphicsWidget.setTool(a)},getCornerValues:c,align:function(){var a=document.getElementById("xmin").value,b=document.getElementById("xmax").value,d=document.getElementById("ymin").value,f=document.getElementById("ymax").value,e=document.getElementById("xlog").checked,
g=document.getElementById("ylog").checked,h=new wpd.XYAxes,l=wpd.alignAxes.getActiveCalib();l.setDataAt(0,a,d);l.setDataAt(1,b,d);l.setDataAt(2,a,d);l.setDataAt(3,b,f);if(!h.calibrate(l,e,g))return wpd.popup.close("xyAlignment"),wpd.messagePopup.show("Invalid Inputs","Please enter valid values for calibration.",c),!1;a=wpd.appData.getPlotData();a.axes=h;a.calibration=l;wpd.popup.close("xyAlignment");return!0}}}();
wpd.barCalibration=function(){function c(){wpd.popup.show("barAlignment")}return{start:function(){wpd.popup.show("barAxesInfo")},pickCorners:function(){wpd.popup.close("barAxesInfo");var a=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(a)},getCornerValues:c,align:function(){var a=document.getElementById("bar-axes-p1").value,b=document.getElementById("bar-axes-p2").value,d=document.getElementById("bar-axes-log-scale").checked,f=new wpd.BarAxes,e=wpd.alignAxes.getActiveCalib();
e.setDataAt(0,0,a);e.setDataAt(1,0,b);if(!f.calibrate(e,d))return wpd.popup.close("barAlignment"),wpd.messagePopup.show("Invalid Inputs","Please enter valid values for calibration.",c),!1;a=wpd.appData.getPlotData();a.axes=f;a.calibration=e;wpd.popup.close("barAlignment");return!0}}}();
wpd.polarCalibration=function(){return{start:function(){wpd.popup.show("polarAxesInfo")},pickCorners:function(){wpd.popup.close("polarAxesInfo");var c=new wpd.AxesCornersTool(3,2,["Origin","P1","P2"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("polarAlignment")},align:function(){var c=parseFloat(document.getElementById("rpoint1").value),a=parseFloat(document.getElementById("thetapoint1").value),b=parseFloat(document.getElementById("rpoint2").value),d=parseFloat(document.getElementById("thetapoint2").value),
f=document.getElementById("degrees").checked;document.getElementById("radians");var e=document.getElementById("clockwise").checked,g=new wpd.PolarAxes,h=wpd.alignAxes.getActiveCalib();h.setDataAt(1,c,a);h.setDataAt(2,b,d);g.calibrate(h,f,e);c=wpd.appData.getPlotData();c.axes=g;c.calibration=h;wpd.popup.close("polarAlignment");return!0}}}();
wpd.ternaryCalibration=function(){return{start:function(){wpd.popup.show("ternaryAxesInfo")},pickCorners:function(){wpd.popup.close("ternaryAxesInfo");var c=new wpd.AxesCornersTool(3,3,["A","B","C"]);wpd.graphicsWidget.setTool(c)},getCornerValues:function(){wpd.popup.show("ternaryAlignment")},align:function(){document.getElementById("range0to1");var c=document.getElementById("range0to100").checked,a=document.getElementById("ternarynormal").checked,b=new wpd.TernaryAxes,d=wpd.alignAxes.getActiveCalib();
b.calibrate(d,c,a);c=wpd.appData.getPlotData();c.axes=b;c.calibration=d;wpd.popup.close("ternaryAlignment");return!0}}}();
wpd.mapCalibration=function(){function c(){wpd.popup.show("mapAlignment")}return{start:function(){wpd.popup.show("mapAxesInfo")},pickCorners:function(){wpd.popup.close("mapAxesInfo");var a=new wpd.AxesCornersTool(2,2,["P1","P2"]);wpd.graphicsWidget.setTool(a);a.onComplete=c},getCornerValues:c,align:function(){var a=parseFloat(document.getElementById("scaleLength").value),b=document.getElementById("scaleUnits").value,d=new wpd.MapAxes,c=wpd.alignAxes.getActiveCalib();d.calibrate(c,a,b);a=wpd.appData.getPlotData();
a.axes=d;a.calibration=c;wpd.popup.close("mapAlignment");return!0}}}();
wpd.AxesCornersTool=function(){return function(c,a,b){var d=0;a=new wpd.Calibration(a);var f=!0;a.labels=b;wpd.alignAxes.setActiveCalib(a);wpd.graphicsWidget.resetData();this.onMouseClick=function(a,b,h){f?(d+=1,b=wpd.alignAxes.getActiveCalib(),b.addPoint(h.x,h.y,0,0),b.unselectAll(),b.selectPoint(d-1),wpd.graphicsWidget.forceHandlerRepaint(),d===c&&(f=!1,wpd.alignAxes.calibrationCompleted())):(b=wpd.alignAxes.getActiveCalib(),b.unselectAll(),b.selectNearestPoint(h.x,h.y),wpd.graphicsWidget.forceHandlerRepaint());
wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){var b=wpd.alignAxes.getActiveCalib();if(0!==b.getSelectedPoints().length){var d=b.getPoint(b.getSelectedPoints()[0]),c=d.px,d=d.py,f=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(a.keyCode))d-=f;else if(wpd.keyCodes.isDown(a.keyCode))d+=f;else if(wpd.keyCodes.isLeft(a.keyCode))c-=f;else if(wpd.keyCodes.isRight(a.keyCode))c+=f;else return;b.changePointPx(b.getSelectedPoints()[0],
c,d);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(c,d);a.preventDefault();a.stopPropagation()}}}}();
wpd.AlignmentCornersRepainter=function(){return function(){var c=wpd.graphicsWidget.getAllContexts();this.painterName="AlignmentCornersReptainer";this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();this.onRedraw()};this.onRedraw=function(){var a=wpd.alignAxes.getActiveCalib();if(null!=a){var b,d,f;for(b=0;b<a.getCount();b++)f=a.getPoint(b),d=wpd.graphicsWidget.screenPx(f.px,f.py),c.dataCtx.fillStyle="rgba(255,255,255,0.7)",c.dataCtx.fillRect(d.x-10,d.y-10,20,40),c.dataCtx.beginPath(),a.isPointSelected(b)?
c.dataCtx.fillStyle="rgba(0,200,0,1)":c.dataCtx.fillStyle="rgba(200,0,0,1)",c.dataCtx.arc(d.x,d.y,3,0,2*Math.PI,!0),c.dataCtx.fill(),c.dataCtx.font="14px sans-serif",c.dataCtx.fillText(a.labels[b],d.x-10,d.y+18),c.oriDataCtx.beginPath(),a.isPointSelected(b)?c.oriDataCtx.fillStyle="rgb(0,200,0)":c.oriDataCtx.fillStyle="rgb(200,0,0)",c.oriDataCtx.arc(f.px,f.py,3,0,2*Math.PI,!0),c.oriDataCtx.fill(),c.oriDataCtx.font="14px sans-serif",c.oriDataCtx.fillText(a.labels[b],parseInt(f.px-10,10),parseInt(f.py+
18,10))}}}}();
wpd.alignAxes=function(){var c,a;return{start:function(){xyEl=document.getElementById("r_xy");polarEl=document.getElementById("r_polar");ternaryEl=document.getElementById("r_ternary");mapEl=document.getElementById("r_map");imageEl=document.getElementById("r_image");barEl=document.getElementById("r_bar");wpd.popup.close("axesList");if(!0===xyEl.checked)a=wpd.xyCalibration;else if(!0===barEl.checked)a=wpd.barCalibration;else if(!0===polarEl.checked)a=wpd.polarCalibration;else if(!0===ternaryEl.checked)a=
wpd.ternaryCalibration;else if(!0===mapEl.checked)a=wpd.mapCalibration;else if(!0===imageEl.checked){a=null;var b=new wpd.ImageAxes;b.calibrate();wpd.appData.getPlotData().axes=b;wpd.appData.isAligned(!0);wpd.acquireData.load()}null!=a&&(a.start(),wpd.graphicsWidget.setRepainter(new wpd.AlignmentCornersRepainter))},calibrationCompleted:function(){wpd.sidebar.show("axes-calibration-sidebar")},getCornerValues:function(){a.getCornerValues()},align:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();
wpd.graphicsWidget.resetData();a.align()&&(wpd.appData.isAligned(!0),wpd.acquireData.load())},getActiveCalib:function(){return c},setActiveCalib:function(a){c=a}}}();wpd=wpd||{};
wpd.autoExtraction=function(){function c(){var a=wpd.appData.getPlotData();a.getActiveDataSeries();var d=a.getActiveDataSeriesIndex(),c=document.getElementById("automatic-sidebar-dataset-list"),e="",g;for(g=0;g<a.dataSeriesColl.length;g++)e+="<option>"+a.dataSeriesColl[g].name+"</option>";c.innerHTML=e;c.selectedIndex=d}function a(){var a=wpd.appData.getPlotData().getAutoDetector(),d=document.getElementById("auto-extract-algo-name").value;if("averagingWindow"===d)a.algorithm=new wpd.AveragingWindowAlgo;
else if("XStep"===d||"XStepWithInterpolation"===d){var c=wpd.appData.getPlotData().axes;c instanceof wpd.XYAxes&&!1===c.isLogX()&&!1===c.isLogY()?"XStep"===d?a.algorithm=new wpd.AveragingWindowWithStepSizeAlgo:"XStepWithInterpolation"===d&&(a.algorithm=new wpd.XStepWithInterpolationAlgo):(wpd.messagePopup.show("Not supported!","This algorithm is only supported for non log scale XY plots."),document.getElementById("auto-extract-algo-name").value="averagingWindow",a.algorithm=new wpd.AveragingWindowAlgo)}else"blobDetector"===
d&&(a.algorithm=new wpd.BlobDetectorAlgo);for(var d=a.algorithm,a=document.getElementById("algo-parameter-container"),d=d.getParamList(),e="<table>",c=0;c<d.length;c++)e+="<tr><td>"+d[c][0]+'</td><td><input type="text" size=3 id="algo-param-'+c+'" class="algo-params" value="'+d[c][2]+'"/></td><td>'+d[c][1]+"</td></tr>";a.innerHTML=e+"</table>"}return{start:function(){wpd.sidebar.show("auto-extraction-sidebar");c();wpd.colorPicker.init();a()},changeAlgorithm:a,runAlgo:function(){wpd.busyNote.show();
setTimeout(function(){var a=wpd.appData.getPlotData().getAutoDetector(),d=a.algorithm,c=new wpd.DataPointsRepainter,e=document.getElementsByClassName("algo-params"),g,h,l=wpd.graphicsWidget.getAllContexts(),q=wpd.graphicsWidget.getImageSize();for(g=0;g<e.length;g++)h=e[g].id,h=parseInt(h.replace("algo-param-",""),10),d.setParam(h,parseFloat(e[g].value));wpd.graphicsWidget.removeTool();a.imageData=l.oriImageCtx.getImageData(0,0,q.width,q.height);a.generateBinaryData();wpd.graphicsWidget.setRepainter(c);
d.run(wpd.appData.getPlotData());wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount();wpd.busyNote.close();return!0},10)},updateDatasetControl:c,changeDataset:function(){var a=document.getElementById("automatic-sidebar-dataset-list").selectedIndex;wpd.appData.getPlotData().setActiveDataSeriesIndex(a);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()}}}();wpd=wpd||{};
wpd.colorSelectionWidget=function(){function c(){document.getElementById("color-selection-selected-color-box").style.backgroundColor="rgb("+a[0]+","+a[1]+","+a[2]+")";document.getElementById("color-selection-red").value=a[0];document.getElementById("color-selection-green").value=a[1];document.getElementById("color-selection-blue").value=a[2];var b=document.getElementById("color-selection-options"),d=wpd.appData.getPlotData().topColors,c=10<d.length?10:d.length,f,q="",m,k;for(f=0;f<c;f++)k="rgb("+
d[f].r+","+d[f].g+","+d[f].b+");",m=d[f].percentage.toFixed(3)+"%",q+='<div class="colorOptionBox" style="background-color: '+k+'" title="'+m+'" onclick="wpd.colorSelectionWidget.selectTopColor('+f+');"></div>';b.innerHTML=q;wpd.popup.show("color-selection-widget")}var a,b,d,f;return{setParams:function(c){a=c.color;b=c.triggerElementId;d=c.title;f=c.setColorDelegate;document.getElementById("color-selection-title").innerHTML=d},startPicker:c,pickColor:function(){wpd.popup.close("color-selection-widget");
var b=new wpd.ColorPickerTool;b.onComplete=function(b){a=b;f(b);wpd.graphicsWidget.removeTool();c()};wpd.graphicsWidget.setTool(b)},setColor:function(){var d=[];d[0]=parseInt(document.getElementById("color-selection-red").value,10);d[1]=parseInt(document.getElementById("color-selection-green").value,10);d[2]=parseInt(document.getElementById("color-selection-blue").value,10);a=d;f(d);wpd.popup.close("color-selection-widget");document.getElementById(b).style.backgroundColor="rgb("+a[0]+","+a[1]+","+
a[2]+")"},selectTopColor:function(b){var d=[],h=wpd.appData.getPlotData().topColors;d[0]=h[b].r;d[1]=h[b].g;d[2]=h[b].b;a=d;f(d);c()},paintFilteredColor:function(a,b){var d=wpd.graphicsWidget.getAllContexts();wpd.appData.getPlotData().getAutoDetector();var c=wpd.graphicsWidget.getImageSize(),f,m,k;k=d.oriDataCtx.getImageData(0,0,c.width,c.height);if(null!=b&&0!==b.length){for(f=0;f<b.length;f++)m=b[f],!0===a[m]?(parseInt(m/c.width,10),k.data[4*m]=255,k.data[4*m+1]=255,k.data[4*m+2]=0,k.data[4*m+3]=
255):(k.data[4*m]=0,k.data[4*m+1]=0,k.data[4*m+2]=0,k.data[4*m+3]=150);d.oriDataCtx.putImageData(k,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}}}}();
wpd.colorPicker=function(){function c(){return{color:wpd.appData.getPlotData().getAutoDetector().fgColor,triggerElementId:"color-button",title:"Specify Plot (Foreground) Color",setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().fgColor=a}}}function a(){return{color:wpd.appData.getPlotData().getAutoDetector().bgColor,triggerElementId:"color-button",title:"Specify Background Color",setColorDelegate:function(a){wpd.appData.getPlotData().getAutoDetector().bgColor=a}}}function b(){var a=
document.getElementById("color-button"),b=document.getElementById("color-distance-value"),c=wpd.appData.getPlotData().getAutoDetector(),g=document.getElementById("color-detection-mode-select"),h;h="fg"===c.colorDetectionMode?c.fgColor:c.bgColor;color_distance=c.colorDistance;a.style.backgroundColor="rgb("+h[0]+","+h[1]+","+h[2]+")";b.value=color_distance;g.value=c.colorDetectionMode}return{startPicker:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();
"fg"===wpd.appData.getPlotData().getAutoDetector().colorDetectionMode?wpd.colorSelectionWidget.setParams(c()):wpd.colorSelectionWidget.setParams(a());wpd.colorSelectionWidget.startPicker()},changeDetectionMode:function(){var a=document.getElementById("color-detection-mode-select");wpd.appData.getPlotData().getAutoDetector().colorDetectionMode=a.value;b()},changeColorDistance:function(){var a=parseFloat(document.getElementById("color-distance-value").value);wpd.appData.getPlotData().getAutoDetector().colorDistance=
a},init:b,testColorDetection:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.ColorFilterRepainter);var a=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getAutoDetector(),c=wpd.graphicsWidget.getImageSize();b.imageData=a.oriImageCtx.getImageData(0,0,c.width,c.height);b.generateBinaryData();wpd.colorSelectionWidget.paintFilteredColor(b.binaryData,b.mask)}}}();
wpd.ColorPickerTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts();this.onMouseClick=function(a,b,d){a=c.oriImageCtx.getImageData(d.x,d.y,1,1);this.onComplete([a.data[0],a.data[1],a.data[2]])};this.onComplete=function(a){}}}();wpd.ColorFilterRepainter=function(){return function(){this.painterName="colorFilterRepainter";this.onRedraw=function(){var c=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(c.binaryData,c.mask)}}}();wpd=wpd||{};
wpd.dataSeriesManagement=function(){function c(){if(wpd.appData.isAligned()){var a=document.getElementById("manage-data-series-name"),b=document.getElementById("manage-data-series-point-count"),d=document.getElementById("manage-data-series-list"),c=wpd.appData.getPlotData(),l=c.getActiveDataSeries(),q=c.getDataSeriesNames(),c=c.getActiveDataSeriesIndex(),m="";a.value=l.name;b.innerHTML=l.getCount();for(a=0;a<q.length;a++)m+='<option value="'+a+'">'+q[a]+"</option>";d.innerHTML=m;d.selectedIndex=c;
wpd.popup.show("manage-data-series-window")}else wpd.messagePopup.show("Manage Datasets","Please calibrate the axes before managing datasets.")}function a(){wpd.graphicsWidget.forceHandlerRepaint();wpd.autoExtraction.updateDatasetControl();wpd.acquireData.updateDatasetControl();wpd.dataPointCounter.setCount()}function b(){wpd.popup.close("manage-data-series-window")}var d=1;return{manage:c,addSeries:function(){var f=wpd.appData.getPlotData(),e="Dataset "+d,g=f.dataSeriesColl.length;b();f.dataSeriesColl[g]=
new wpd.DataSeries;f.dataSeriesColl[g].name=e;f.setActiveDataSeriesIndex(g);a();d++;c()},deleteSeries:function(){b();1===wpd.appData.getPlotData().dataSeriesColl.length?wpd.messagePopup.show("Can Not Delete!","You can not delete this dataset as at least one dataset is required.",c):wpd.okCancelPopup.show("Delete Dataset","Are you sure that you want to delete the dataset and all containing data points?",function(){var a=wpd.appData.getPlotData(),b=a.getActiveDataSeriesIndex();a.dataSeriesColl.splice(b,
1);a.setActiveDataSeriesIndex(0);c()},function(){c()})},viewData:function(){b();wpd.dataTable.showTable()},changeSelectedSeries:function(){var d=document.getElementById("manage-data-series-list"),e=wpd.appData.getPlotData();b();e.setActiveDataSeriesIndex(d.selectedIndex);a();c()},editSeriesName:function(){var d=wpd.appData.getPlotData().getActiveDataSeries(),e=document.getElementById("manage-data-series-name");b();d.name=e.value;a();c()}}}();wpd=wpd||{};wpd.graphicsHelper=function(){return{}}();
wpd=wpd||{};
wpd.gridDetection=function(){return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData();wpd.sidebar.show("grid-detection-sidebar")},markBox:function(){var c=new wpd.GridBoxTool;wpd.graphicsWidget.setTool(c)},clearMask:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.appData.getPlotData().getAutoDetector().gridMask={xmin:null,xmax:null,ymin:null,ymax:null,pixels:[]};wpd.graphicsWidget.resetData()},viewMask:function(){var c=
new wpd.GridViewMaskTool;wpd.graphicsWidget.setTool(c)},grabMask:function(){var c=wpd.graphicsWidget.getAllContexts(),a=wpd.graphicsWidget.getImageSize(),c=c.oriDataCtx.getImageData(0,0,a.width,a.height),b=[],d,f=0,e=wpd.appData.getPlotData().getAutoDetector(),g,h;for(d=0;d<c.data.length;d+=4)255===c.data[d]&&255===c.data[d+1]&&0===c.data[d+2]&&(b[f]=d/4,f++,g=parseInt(d/4%a.width,10),h=parseInt(d/4/a.width,10),1===f?(e.gridMask.xmin=g,e.gridMask.xmax=g,e.gridMask.ymin=h,e.gridMask.ymax=h):(g<e.gridMask.xmin&&
(e.gridMask.xmin=g),g>e.gridMask.xmax&&(e.gridMask.xmax=g),h<e.gridMask.ymin&&(e.gridMask.ymin=h),h>e.gridMask.ymax&&(e.gridMask.ymax=h)));e.gridMask.pixels=b},startColorPicker:function(){wpd.colorSelectionWidget.setParams({color:wpd.appData.getPlotData().getAutoDetector().gridLineColor,triggerElementId:"grid-color-picker-button",title:"Specify Grid Line Color",setColorDelegate:function(c){wpd.appData.getPlotData().getAutoDetector().gridLineColor=c}});wpd.colorSelectionWidget.startPicker()},changeColorDistance:function(){var c=
parseFloat(document.getElementById("grid-color-distance").value);wpd.appData.getPlotData().getAutoDetector().gridColorDistance=c},testColor:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.graphicsWidget.setRepainter(new wpd.GridColorFilterRepainter);var c=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData().getAutoDetector(),b=wpd.graphicsWidget.getImageSize();a.imageData=c.oriImageCtx.getImageData(0,0,b.width,b.height);a.generateGridBinaryData();wpd.colorSelectionWidget.paintFilteredColor(a.gridBinaryData,
a.gridMask.pixels)},run:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();var c=wpd.appData.getPlotData().getAutoDetector(),a=wpd.graphicsWidget.getAllContexts(),b=wpd.graphicsWidget.getImageSize();c.imageData=a.oriImageCtx.getImageData(0,0,b.width,b.height);c.generateGridBinaryData();wpd.gridDetectionCore.setHorizontalParameters(!0,5,5);wpd.gridDetectionCore.setVerticalParameters(!0,5,5);wpd.gridDetectionCore.run()},clear:function(){wpd.graphicsWidget.removeTool();wpd.appData.getPlotData().gridData=
null;wpd.graphicsWidget.removeRepainter();wpd.graphicsWidget.resetData()}}}();wpd.GridColorFilterRepainter=function(){return function(){this.painterName="gridColorFilterRepainter";this.onRedraw=function(){var c=wpd.appData.getPlotData().getAutoDetector();wpd.colorSelectionWidget.paintFilteredColor(c.gridBinaryData,c.gridMask.pixels)}}}();
wpd.GridBoxTool=function(){return function(){var c=!1,a,b,d=wpd.graphicsWidget.getAllContexts(),f,e,g=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(b.x,b.y,e.x-b.x,e.y-b.y)},h=function(e,g,h){!1!==c&&(clearTimeout(f),c=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,0.8)",d.dataCtx.fillRect(b.x,b.y,g.x-b.x,g.y-b.y),d.oriDataCtx.fillStyle="rgba(255,255,0,0.8)",d.oriDataCtx.fillRect(a.x,a.y,h.x-a.x,h.y-a.y))},l=null,q=null;
this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-box").classList.add("pressed-button");document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onMouseDown=function(d,e,f){!0!==c&&(c=!0,a=f,b=e)};this.onMouseMove=function(a,b,d){!1!==c&&(e=b,clearTimeout(f),f=setTimeout(g,2))};this.onMouseOut=function(a,b,d){!0===c&&(clearTimeout(f),l=b,q=d)};this.onDocumentMouseUp=function(a,b,d){null!=l&&null!=q?h(a,l,q):
h(a,b,d);q=l=null};this.onMouseUp=function(a,b,d){h(a,b,d)};this.onRemove=function(){document.getElementById("grid-mask-box").classList.remove("pressed-button");document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.GridMaskPainter);document.getElementById("grid-mask-view").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("grid-mask-view").classList.remove("pressed-button");wpd.gridDetection.grabMask()}}}();
wpd.GridMaskPainter=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData().getAutoDetector(),b=function(){if(null!=a.gridMask.pixels&&0!==a.gridMask.pixels.length){var b,f;b=wpd.graphicsWidget.getImageSize();imgData=c.oriDataCtx.getImageData(0,0,b.width,b.height);for(b=0;b<a.gridMask.pixels.length;b++)f=a.gridMask.pixels[b],imgData.data[4*f]=255,imgData.data[4*f+1]=255,imgData.data[4*f+2]=0,imgData.data[4*f+3]=200;c.oriDataCtx.putImageData(imgData,0,0);
wpd.graphicsWidget.copyImageDataLayerToScreen()}};this.painterName="gridMaskPainter";this.onRedraw=function(){wpd.gridDetection.grabMask();b()};this.onAttach=function(){wpd.graphicsWidget.resetData();b()}}}();wpd=wpd||{};
wpd.imageOps=function(){function c(a,d,c){var e,g,h,l,q,m;for(e=0;e<c;e++)for(g=0;g<d/2;g++)for(h=4*(e*d+g),l=4*((e+1)*d-(g+1)),m=0;4>m;m++)q=a.data[h+m],a.data[h+m]=a.data[l+m],a.data[l+m]=q;return{imageData:a,width:d,height:c}}function a(a,d,c){var e,g,h,l,q,m;for(e=0;e<c/2;e++)for(g=0;g<d;g++)for(h=4*(e*d+g),l=4*((c-(e+2))*d+g),m=0;4>m;m++)q=a.data[h+m],a.data[h+m]=a.data[l+m],a.data[l+m]=q;return{imageData:a,width:d,height:c}}return{hflip:function(){wpd.graphicsWidget.runImageOp(c)},vflip:function(){wpd.graphicsWidget.runImageOp(a)}}}();
wpd=wpd||{};wpd.keyCodes=function(){return{isUp:function(c){return 38===c},isDown:function(c){return 40===c},isLeft:function(c){return 37===c},isRight:function(c){return 39===c},isTab:function(c){return 9===c},isDel:function(c){return 46===c},isBackspace:function(c){return 8===c},isAlphabet:function(c,a){return 90<c||65>c?!1:String.fromCharCode(c).toLowerCase()===a}}}();wpd=wpd||{};
wpd.acquireData=function(){function c(){var a=new wpd.ManualSelectionTool;wpd.graphicsWidget.setTool(a)}function a(){var a=new wpd.DeleteDataPointTool;wpd.graphicsWidget.setTool(a)}function b(){wpd.appData.getPlotData().getActiveDataSeries().clearAll();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.dataPointCounter.setCount();wpd.graphicsWidget.removeRepainter()}function d(){wpd.sidebar.show("acquireDataSidebar");f();wpd.dataPointCounter.setCount()}function f(){var a=wpd.appData.getPlotData();
a.getActiveDataSeries();var b=a.getActiveDataSeriesIndex(),d=document.getElementById("manual-sidebar-dataset-list"),c="",e;for(e=0;e<a.dataSeriesColl.length;e++)c+="<option>"+a.dataSeriesColl[e].name+"</option>";d.innerHTML=c;d.selectedIndex=b}function e(){wpd.graphicsWidget.setTool(new wpd.AdjustDataPointTool)}return{load:function(){wpd.appData.isAligned()?(d(),wpd.dataPointCounter.setCount(),wpd.graphicsWidget.removeTool(),wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter),c()):wpd.messagePopup.show("Acquire Data",
"Please calibrate the axes before acquiring data.")},manualSelection:c,adjustPoints:e,deletePoint:a,clearAll:function(){0>=wpd.appData.getPlotData().getActiveDataSeries().getCount()||wpd.okCancelPopup.show("Clear data points?","This will delete all data points from this dataset",b,function(){})},undo:function(){wpd.appData.getPlotData().getActiveDataSeries().removeLastPixel();wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()},showSidebar:d,switchToolOnKeyPress:function(b){switch(b){case "d":a();
break;case "a":c();break;case "s":e()}},updateDatasetControl:f,changeDataset:function(a){a=a.selectedIndex;wpd.appData.getPlotData().setActiveDataSeriesIndex(a);wpd.graphicsWidget.forceHandlerRepaint();wpd.dataPointCounter.setCount()}}}();
wpd.ManualSelectionTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("manual-select-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(b,d,f){a.getActiveDataSeries().addPixel(f.x,f.y);c.dataCtx.beginPath();c.dataCtx.fillStyle="rgb(200,0,0)";c.dataCtx.arc(d.x,d.y,3,0,2*Math.PI,!0);c.dataCtx.fill();c.oriDataCtx.beginPath();
c.oriDataCtx.fillStyle="rgb(200,0,0)";c.oriDataCtx.arc(f.x,f.y,3,0,2*Math.PI,!0);c.oriDataCtx.fill();wpd.graphicsWidget.updateZoomOnEvent(b);wpd.dataPointCounter.setCount()};this.onRemove=function(){document.getElementById("manual-select-button").classList.remove("pressed-button")};this.onKeyDown=function(b){var d=a.getActiveDataSeries(),c=d.getCount()-1,e=d.getPixel(c),g=0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(b.keyCode))e.y-=g;else if(wpd.keyCodes.isDown(b.keyCode))e.y+=g;else if(wpd.keyCodes.isLeft(b.keyCode))e.x-=
g;else if(wpd.keyCodes.isRight(b.keyCode))e.x+=g;else{(wpd.keyCodes.isAlphabet(b.keyCode,"a")||wpd.keyCodes.isAlphabet(b.keyCode,"s")||wpd.keyCodes.isAlphabet(b.keyCode,"d"))&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(b.keyCode).toLowerCase());return}d.setPixelAt(c,e.x,e.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e.x,e.y);b.preventDefault()}}}();
wpd.DeleteDataPointTool=function(){return function(){wpd.graphicsWidget.getAllContexts();var c=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById("delete-point-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter)};this.onMouseClick=function(a,b,d){c.getActiveDataSeries().removeNearestPixel(d.x,d.y);wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a);wpd.dataPointCounter.setCount()};
this.onKeyDown=function(a){(wpd.keyCodes.isAlphabet(a.keyCode,"a")||wpd.keyCodes.isAlphabet(a.keyCode,"s")||wpd.keyCodes.isAlphabet(a.keyCode,"d"))&&wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(a.keyCode).toLowerCase())};this.onRemove=function(){document.getElementById("delete-point-button").classList.remove("pressed-button")}}}();
wpd.DataPointsRepainter=function(){return function(){var c=function(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.appData.getPlotData().getActiveDataSeries(),d,c,e,g;for(d=0;d<b.getCount();d++)c=b.getPixel(d),g=0<=b.getSelectedPixels().indexOf(d),e=wpd.graphicsWidget.screenPx(c.x,c.y),a.dataCtx.beginPath(),a.dataCtx.fillStyle=g?"rgb(0,200,0)":"rgb(200,0,0)",a.dataCtx.arc(e.x,e.y,3,0,2*Math.PI,!0),a.dataCtx.fill(),a.oriDataCtx.beginPath(),a.oriDataCtx.fillStyle=g?"rgb(0,200,0)":"rgb(200,0,0)",
a.oriDataCtx.arc(c.x,c.y,3,0,2*Math.PI,!0),a.oriDataCtx.fill()};this.painterName="dataPointsRepainter";this.onAttach=function(){wpd.graphicsWidget.resetData();c()};this.onRedraw=function(){c()};this.onForcedRedraw=function(){wpd.graphicsWidget.resetData();c()}}}();
wpd.AdjustDataPointTool=function(){return function(){this.onAttach=function(){document.getElementById("manual-adjust-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.DataPointsRepainter);wpd.toolbar.show("adjustDataPointsToolbar")};this.onRemove=function(){wpd.appData.getPlotData().getActiveDataSeries().unselectAll();wpd.graphicsWidget.forceHandlerRepaint();document.getElementById("manual-adjust-button").classList.remove("pressed-button");wpd.toolbar.clear()};this.onMouseClick=
function(c,a,b){a=wpd.appData.getPlotData().getActiveDataSeries();a.unselectAll();a.selectNearestPixel(b.x,b.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(c)};this.onKeyDown=function(c){if(wpd.keyCodes.isAlphabet(c.keyCode,"a")||wpd.keyCodes.isAlphabet(c.keyCode,"s")||wpd.keyCodes.isAlphabet(c.keyCode,"d"))wpd.acquireData.switchToolOnKeyPress(String.fromCharCode(c.keyCode).toLowerCase());else{var a=wpd.appData.getPlotData().getActiveDataSeries(),b=a.getSelectedPixels()[0];
if(null!=b){var d=a.getPixel(b),f=d.x,d=d.y,e=!0===c.shiftKey?5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio();if(wpd.keyCodes.isUp(c.keyCode))d-=e;else if(wpd.keyCodes.isDown(c.keyCode))d+=e;else if(wpd.keyCodes.isLeft(c.keyCode))f-=e;else if(wpd.keyCodes.isRight(c.keyCode))f+=e;else if(wpd.keyCodes.isAlphabet(c.keyCode,"q"))a.selectPreviousPixel(),b=a.getSelectedPixels()[0],d=a.getPixel(b),f=d.x,d=d.y;else if(wpd.keyCodes.isAlphabet(c.keyCode,"w"))a.selectNextPixel(),b=
a.getSelectedPixels()[0],d=a.getPixel(b),f=d.x,d=d.y;else{if(wpd.keyCodes.isDel(c.keyCode)||wpd.keyCodes.isBackspace(c.keyCode))a.removePixelAtIndex(b),a.unselectAll(),0<=a.findNearestPixel(f,d)&&(a.selectNearestPixel(f,d),b=a.getSelectedPixels()[0],d=a.getPixel(b),f=d.x,d=d.y),wpd.graphicsWidget.resetData(),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.updateZoomToImagePosn(f,d),wpd.dataPointCounter.setCount(),c.preventDefault(),c.stopPropagation();return}a.setPixelAt(b,f,d);wpd.graphicsWidget.forceHandlerRepaint();
wpd.graphicsWidget.updateZoomToImagePosn(f,d);c.preventDefault();c.stopPropagation()}}}}}();wpd.dataPointCounter=function(){return{setCount:function(){var c=document.getElementsByClassName("data-point-counter"),a;for(a=0;a<c.length;a++)c[a].innerHTML=wpd.appData.getPlotData().getActiveDataSeries().getCount()}}}();wpd=wpd||{};
wpd.dataMask=function(){function c(){var a=wpd.graphicsWidget.getAllContexts(),b=wpd.graphicsWidget.getImageSize(),a=a.oriDataCtx.getImageData(0,0,b.width,b.height),b=[],d,c=0,e=wpd.appData.getPlotData().getAutoDetector();for(d=0;d<a.data.length;d+=4)255===a.data[d]&&255===a.data[d+1]&&0===a.data[d+2]&&(b[c]=d/4,c++);e.mask=b}return{grabMask:c,markBox:function(){var a=new wpd.BoxMaskTool;wpd.graphicsWidget.setTool(a)},markPen:function(){var a=new wpd.PenMaskTool;wpd.graphicsWidget.setTool(a)},eraseMarks:function(){var a=
new wpd.EraseMaskTool;wpd.graphicsWidget.setTool(a)},viewMask:function(){var a=new wpd.ViewMaskTool;wpd.graphicsWidget.setTool(a)},clearMask:function(){wpd.graphicsWidget.resetData();c()}}}();
wpd.BoxMaskTool=function(){return function(){var c=!1,a,b,d=wpd.graphicsWidget.getAllContexts(),f,e,g=function(){wpd.graphicsWidget.resetHover();d.hoverCtx.strokeStyle="rgb(0,0,0)";d.hoverCtx.strokeRect(b.x,b.y,e.x-b.x,e.y-b.y)},h=function(e,g,h){!1!==c&&(clearTimeout(f),c=!1,wpd.graphicsWidget.resetHover(),d.dataCtx.fillStyle="rgba(255,255,0,1)",d.dataCtx.fillRect(b.x,b.y,g.x-b.x,g.y-b.y),d.oriDataCtx.fillStyle="rgba(255,255,0,1)",d.oriDataCtx.fillRect(a.x,a.y,h.x-a.x,h.y-a.y))},l=null,q=null;this.onAttach=
function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("box-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button")};this.onMouseDown=function(d,e,f){!0!==c&&(c=!0,a=f,b=e)};this.onMouseMove=function(a,b,d){!1!==c&&(e=b,clearTimeout(f),f=setTimeout(g,2))};this.onMouseOut=function(a,b,d){!0===c&&(clearTimeout(f),l=b,q=d)};this.onDocumentMouseUp=function(a,b,d){null!=l&&null!=q?h(a,l,q):h(a,b,d);q=l=null};this.onMouseUp=
function(a,b,d){h(a,b,d)};this.onRemove=function(){document.getElementById("box-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.PenMaskTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=!1,b,d,f,e=function(){c.dataCtx.strokeStyle="rgba(255,255,0,1)";c.dataCtx.lineTo(d.x,d.y);c.dataCtx.stroke();c.oriDataCtx.strokeStyle="rgba(255,255,0,1)";c.oriDataCtx.lineTo(f.x,f.y);c.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("pen-mask").classList.add("pressed-button");document.getElementById("view-mask").classList.add("pressed-button");
wpd.toolbar.show("paintToolbar")};this.onMouseDown=function(b,d,e){!0!==a&&(b=parseInt(document.getElementById("paintThickness").value,10),a=!0,c.dataCtx.strokeStyle="rgba(255,255,0,1)",c.dataCtx.lineWidth=b*wpd.graphicsWidget.getZoomRatio(),c.dataCtx.beginPath(),c.dataCtx.moveTo(d.x,d.y),c.oriDataCtx.strokeStyle="rgba(255,255,0,1)",c.oriDataCtx.lineWidth=b,c.oriDataCtx.beginPath(),c.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(c,h,l){!1!==a&&(d=h,f=l,clearTimeout(b),b=setTimeout(e,2))};
this.onMouseUp=function(d,e,f){clearTimeout(b);c.dataCtx.closePath();c.dataCtx.lineWidth=1;c.oriDataCtx.closePath();c.oriDataCtx.lineWidth=1;a=!1};this.onMouseOut=function(a,b,d){this.onMouseUp(a,b,d)};this.onRemove=function(){document.getElementById("pen-mask").classList.remove("pressed-button");document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();
wpd.EraseMaskTool=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=!1,b,d,f,e=function(){c.dataCtx.globalCompositeOperation="destination-out";c.oriDataCtx.globalCompositeOperation="destination-out";c.dataCtx.strokeStyle="rgba(255,255,0,1)";c.dataCtx.lineTo(d.x,d.y);c.dataCtx.stroke();c.oriDataCtx.strokeStyle="rgba(255,255,0,1)";c.oriDataCtx.lineTo(f.x,f.y);c.oriDataCtx.stroke()};this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("erase-mask").classList.add("pressed-button");
document.getElementById("view-mask").classList.add("pressed-button");wpd.toolbar.show("eraseToolbar")};this.onMouseDown=function(b,d,e){!0!==a&&(b=parseInt(document.getElementById("eraseThickness").value,10),a=!0,c.dataCtx.globalCompositeOperation="destination-out",c.oriDataCtx.globalCompositeOperation="destination-out",c.dataCtx.strokeStyle="rgba(0,0,0,1)",c.dataCtx.lineWidth=b*wpd.graphicsWidget.getZoomRatio(),c.dataCtx.beginPath(),c.dataCtx.moveTo(d.x,d.y),c.oriDataCtx.strokeStyle="rgba(0,0,0,1)",
c.oriDataCtx.lineWidth=b,c.oriDataCtx.beginPath(),c.oriDataCtx.moveTo(e.x,e.y))};this.onMouseMove=function(c,h,l){!1!==a&&(d=h,f=l,clearTimeout(b),b=setTimeout(e,2))};this.onMouseOut=function(a,b,d){this.onMouseUp(a,b,d)};this.onMouseUp=function(d,e,f){clearTimeout(b);c.dataCtx.closePath();c.dataCtx.lineWidth=1;c.oriDataCtx.closePath();c.oriDataCtx.lineWidth=1;c.dataCtx.globalCompositeOperation="source-over";c.oriDataCtx.globalCompositeOperation="source-over";a=!1};this.onRemove=function(){document.getElementById("erase-mask").classList.remove("pressed-button");
document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask();wpd.toolbar.clear()}}}();wpd.ViewMaskTool=function(){return function(){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MaskPainter);document.getElementById("view-mask").classList.add("pressed-button")};this.onRemove=function(){document.getElementById("view-mask").classList.remove("pressed-button");wpd.dataMask.grabMask()}}}();
wpd.MaskPainter=function(){return function(){var c=wpd.graphicsWidget.getAllContexts(),a=wpd.appData.getPlotData().getAutoDetector(),b=function(){if(null!=a.mask&&0!==a.mask.length){var b,f;b=wpd.graphicsWidget.getImageSize();imgData=c.oriDataCtx.getImageData(0,0,b.width,b.height);for(b=0;b<a.mask.length;b++)f=a.mask[b],imgData.data[4*f]=255,imgData.data[4*f+1]=255,imgData.data[4*f+2]=0,imgData.data[4*f+3]=255;c.oriDataCtx.putImageData(imgData,0,0);wpd.graphicsWidget.copyImageDataLayerToScreen()}};
this.painterName="dataMaskPainter";this.onRedraw=function(){wpd.dataMask.grabMask();b()};this.onAttach=function(){wpd.graphicsWidget.resetData();b()}}}();wpd=wpd||{};
wpd.distanceMeasurement=function(){return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();var c=wpd.appData.getPlotData();null==c.distanceMeasurementData&&(c.distanceMeasurementData=new wpd.ConnectedPoints(2));wpd.sidebar.show("measure-distances-sidebar");wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("distance"));wpd.graphicsWidget.forceHandlerRepaint()},addPair:function(){wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("distance"))},deletePair:function(){wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool("distance"))},
clearAll:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.appData.getPlotData().distanceMeasurementData=new wpd.ConnectedPoints(2)}}}();
wpd.angleMeasurement=function(){return{start:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();var c=wpd.appData.getPlotData();null==c.angleMeasurementData&&(c.angleMeasurementData=new wpd.ConnectedPoints(3));wpd.sidebar.show("measure-angles-sidebar");wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("angle"));wpd.graphicsWidget.forceHandlerRepaint()},addAngle:function(){wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool("angle"))},deleteAngle:function(){wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool("angle"))},
clearAll:function(){wpd.graphicsWidget.removeTool();wpd.graphicsWidget.resetData();wpd.appData.getPlotData().angleMeasurementData=new wpd.ConnectedPoints(3)}}}();
wpd.measurementData=function(){var c;return{showAngleData:function(){wpd.popup.show("measurement-data-window");var a=wpd.appData.getPlotData().angleMeasurementData,b=a.connectionCount(),d,f=document.getElementById("measurement-data-table");c="";for(d=0;d<b;d++)c+=d.toString()+", "+a.getAngle(d)+"\n";f.value=c},showDistanceData:function(){wpd.popup.show("measurement-data-window");var a=wpd.appData.getPlotData().distanceMeasurementData,b=a.connectionCount(),d,f=document.getElementById("measurement-data-table"),
e=wpd.appData.getPlotData().axes;c="";for(d=0;d<b;d++)c=!0===wpd.appData.isAligned()&&e instanceof wpd.MapAxes?c+(d.toString()+", "+e.pixelToDataDistance(a.getDistance(d))+"\n"):c+(d.toString()+", "+a.getDistance(d)+"\n");f.value=c},selectAll:function(){var a=document.getElementById("measurement-data-table");a.focus();a.select()},generateCSV:function(){wpd.download.csv(JSON.stringify(c))},close:function(){c="";wpd.popup.close("measurement-data-window")}}}();
wpd.AddMeasurementTool=function(){return function(c){var a="distance"===c,b=wpd.graphicsWidget.getAllContexts(),d=wpd.appData.getPlotData(),f=0,e=!0,g=[],h=a?2:3;this.onAttach=function(){document.getElementById(!0===a?"add-pair-button":"add-angle-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onRemove=function(){document.getElementById(!0===a?"add-pair-button":"add-angle-button").classList.remove("pressed-button")};this.onKeyDown=function(a){wpd.keyCodes.isAlphabet(a.keyCode,
"a")?(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c))):wpd.keyCodes.isAlphabet(a.keyCode,"d")&&(wpd.graphicsWidget.resetHover(),wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c)))};this.onMouseClick=function(l,q,m){if(e){wpd.graphicsWidget.resetHover();g[2*f]=m.x;g[2*f+1]=m.y;f+=1;f===h&&(e=!1,a?d.distanceMeasurementData.addConnection(g):d.angleMeasurementData.addConnection(g),wpd.graphicsWidget.forceHandlerRepaint(),wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c)));
if(1<f){var k=wpd.graphicsWidget.screenPx(g[2*(f-2)],g[2*(f-2)+1]);b.dataCtx.beginPath();b.dataCtx.strokeStyle="rgb(0,0,10)";b.dataCtx.moveTo(k.x,k.y);b.dataCtx.lineTo(q.x,q.y);b.dataCtx.stroke();b.oriDataCtx.beginPath();b.oriDataCtx.strokeStyle="rgb(0,0,10)";b.oriDataCtx.moveTo(g[2*(f-2)],g[2*(f-2)+1]);b.oriDataCtx.lineTo(m.x,m.y);b.oriDataCtx.stroke()}b.dataCtx.beginPath();b.dataCtx.fillStyle="rgb(200, 0, 0)";b.dataCtx.arc(q.x,q.y,3,0,2*Math.PI,!0);b.dataCtx.fill();b.oriDataCtx.beginPath();b.oriDataCtx.fillStyle=
"rgb(200,0,0)";b.oriDataCtx.arc(m.x,m.y,3,0,2*Math.PI,!0);b.oriDataCtx.fill()}wpd.graphicsWidget.updateZoomOnEvent(l)};this.onMouseMove=function(a,d,c){e&&1<=f&&(wpd.graphicsWidget.resetHover(),a=wpd.graphicsWidget.screenPx(g[2*(f-1)],g[2*(f-1)+1]),b.hoverCtx.beginPath(),b.hoverCtx.strokeStyle="rgb(0,0,0)",b.hoverCtx.moveTo(a.x,a.y),b.hoverCtx.lineTo(d.x,d.y),b.hoverCtx.stroke())}}}();
wpd.DeleteMeasurementTool=function(){return function(c){var a="distance"===c;wpd.graphicsWidget.getAllContexts();var b=wpd.appData.getPlotData();this.onAttach=function(){document.getElementById(!0===a?"delete-pair-button":"delete-angle-button").classList.add("pressed-button");wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onRemove=function(){document.getElementById(!0===a?"delete-pair-button":"delete-angle-button").classList.remove("pressed-button")};this.onKeyDown=function(a){wpd.keyCodes.isAlphabet(a.keyCode,
"a")?wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c)):wpd.keyCodes.isAlphabet(a.keyCode,"d")&&wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c))};this.onMouseClick=function(d,f,e){a?b.distanceMeasurementData.deleteNearestConnection(e.x,e.y):b.angleMeasurementData.deleteNearestConnection(e.x,e.y);wpd.graphicsWidget.setTool(new wpd.AdjustMeasurementTool(c));wpd.graphicsWidget.resetData();wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(d)}}}();
wpd.AdjustMeasurementTool=function(){return function(c){this.onAttach=function(){wpd.graphicsWidget.setRepainter(new wpd.MeasurementRepainter(c))};this.onMouseClick=function(a,b,d){b=wpd.appData.getPlotData();"distance"===c?b.distanceMeasurementData.selectNearestPoint(d.x,d.y):"angle"===c&&b.angleMeasurementData.selectNearestPoint(d.x,d.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomOnEvent(a)};this.onKeyDown=function(a){if(wpd.keyCodes.isAlphabet(a.keyCode,"a"))wpd.graphicsWidget.setTool(new wpd.AddMeasurementTool(c));
else if(wpd.keyCodes.isAlphabet(a.keyCode,"d"))wpd.graphicsWidget.setTool(new wpd.DeleteMeasurementTool(c));else{var b=wpd.appData.getPlotData(),b="distance"===c?b.distanceMeasurementData:b.angleMeasurementData,d=b.getSelectedConnectionAndPoint();if(0<=d.connectionIndex&&0<=d.pointIndex){var f=!0===a.shiftKey?5/wpd.graphicsWidget.getZoomRatio():0.5/wpd.graphicsWidget.getZoomRatio(),e=b.getPointAt(d.connectionIndex,d.pointIndex);if(wpd.keyCodes.isUp(a.keyCode))e.y-=f;else if(wpd.keyCodes.isDown(a.keyCode))e.y+=
f;else if(wpd.keyCodes.isLeft(a.keyCode))e.x-=f;else if(wpd.keyCodes.isRight(a.keyCode))e.x+=f;else return;b.setPointAt(d.connectionIndex,d.pointIndex,e.x,e.y);wpd.graphicsWidget.forceHandlerRepaint();wpd.graphicsWidget.updateZoomToImagePosn(e.x,e.y);a.preventDefault();a.stopPropagation()}}}}}();
wpd.MeasurementRepainter=function(){return function(c){var a="distance"===c,b="angle"===c,d=wpd.graphicsWidget.getAllContexts(),f=function(a,b,c,e,f,g,p,u){d.dataCtx.beginPath();d.dataCtx.strokeStyle="rgb(0,0,10)";d.dataCtx.moveTo(a,b);d.dataCtx.lineTo(c,e);d.dataCtx.stroke();d.oriDataCtx.beginPath();d.oriDataCtx.strokeStyle="rgb(0,0,10)";d.oriDataCtx.moveTo(f,g);d.oriDataCtx.lineTo(p,u);d.oriDataCtx.stroke()},e=function(a,b,c,e,f){d.dataCtx.beginPath();d.dataCtx.fillStyle=f?"rgb(0, 200, 0)":"rgb(200, 0, 0)";
d.dataCtx.arc(a,b,3,0,2*Math.PI,!0);d.dataCtx.fill();d.oriDataCtx.beginPath();d.oriDataCtx.fillStyle=f?"rgb(0,200,0)":"rgb(200,0,0)";d.oriDataCtx.arc(c,e,3,0,2*Math.PI,!0);d.oriDataCtx.fill()},g=function(a,b,c,e,f){d.dataCtx.font="14px sans-serif";d.dataCtx.fillText(f,parseInt(a,10),parseInt(b,10));d.oriDataCtx.font="14px sans-serif";d.oriDataCtx.fillText(f,parseInt(c,10),parseInt(e,10))};this.painterName="measurementRepainter-"+c;this.onAttach=function(){wpd.graphicsWidget.resetData()};this.onRedraw=
function(){if(a){var c=wpd.appData.getPlotData().distanceMeasurementData,l=c.connectionCount(),q,m,k,n,p,u,r,t,s,v,w=wpd.appData.getPlotData().axes;for(q=0;q<l;q++)m=c.getConnectionAt(q),k=m[0],n=m[1],p=m[2],m=m[3],s=c.isPointSelected(q,0),v=c.isPointSelected(q,1),t=!0===wpd.appData.isAligned()&&w instanceof wpd.MapAxes?"["+q.toString()+"]: "+w.pixelToDataDistance(c.getDistance(q)).toFixed(2)+" "+w.getUnits():"["+q.toString()+"]: "+c.getDistance(q).toFixed(2)+" px",u=wpd.graphicsWidget.screenPx(k,
n),r=wpd.graphicsWidget.screenPx(p,m),f(u.x,u.y,r.x,r.y,k,n,p,m),e(u.x,u.y,k,n,s),e(r.x,r.y,p,m,v),g(0.5*(u.x+r.x),0.5*(u.y+r.y),0.5*(k+p),0.5*(n+m),t)}if(b){var c=wpd.appData.getPlotData().angleMeasurementData,l=c.connectionCount(),x,y,H,F,D;for(q=0;q<l;q++)p=c.getConnectionAt(q),r=p[0],t=p[1],k=p[2],n=p[3],s=p[4],v=p[5],H=c.isPointSelected(q,0),F=c.isPointSelected(q,1),D=c.isPointSelected(q,2),w="["+q.toString()+"]: "+c.getAngle(q).toFixed(2)+"\u00b0",u=Math.atan2(t-n,r-k),m=Math.atan2(v-n,s-k),
x=wpd.graphicsWidget.screenPx(r,t),p=wpd.graphicsWidget.screenPx(k,n),y=wpd.graphicsWidget.screenPx(s,v),f(x.x,x.y,p.x,p.y,r,t,k,n),f(p.x,p.y,y.x,y.y,k,n,s,v),e(x.x,x.y,r,t,H),e(p.x,p.y,k,n,F),e(y.x,y.y,s,v,D),r=p.x,t=p.y,s=k,v=n,d.dataCtx.beginPath(),d.dataCtx.strokeStyle="rgb(0,0,10)",d.dataCtx.arc(r,t,15,u,m,!0),d.dataCtx.stroke(),d.oriDataCtx.beginPath(),d.oriDataCtx.strokeStyle="rgb(0,0,10)",d.oriDataCtx.arc(s,v,15,u,m,!0),d.oriDataCtx.stroke(),g(p.x+10,p.y+15,k+10,n+15,w)}};this.onForcedRedraw=
function(){wpd.graphicsWidget.resetData();this.onRedraw()}}}();wpd=wpd||{};
wpd.download=function(){function c(a,b){var d,c,e;d=document.createElement("div");c=document.createElement("form");e=document.createElement("textarea");c.setAttribute("method","post");"json"===b?c.setAttribute("action","php/json.php"):"csv"===b&&c.setAttribute("action","php/csvexport.php");e.setAttribute("name","data");e.setAttribute("id","data");c.appendChild(e);d.appendChild(c);document.body.appendChild(d);d.style.display="none";e.innerHTML=a;c.submit();document.body.removeChild(d)}return{json:function(a){c(a,
"json")},csv:function(a){c(a,"csv")}}}();wpd=wpd||{};
wpd.saveResume=function(){function c(a){var d=wpd.appData.getPlotData();a=a.wpd;var c,e,g,h;d.reset();wpd.appData.isAligned(!1);if(null!=a.axesType&&("ImageAxes"===a.axesType||null!=a.calibration&&null!=a.axesParameters)){if("ImageAxes"!==a.axesType){c="TernaryAxes"===a.axesType?new wpd.Calibration(3):new wpd.Calibration(2);for(e=0;e<a.calibration.length;e++)c.addPoint(a.calibration[e].px,a.calibration[e].py,a.calibration[e].dx,a.calibration[e].dy,a.calibration[e].dz);d.calibration=c}if("XYAxes"===
a.axesType){if(d.axes=new wpd.XYAxes,!d.axes.calibrate(d.calibration,a.axesParameters.isLogX,a.axesParameters.isLogY))return}else if("PolarAxes"===a.axesType){if(d.axes=new wpd.PolarAxes,!d.axes.calibrate(d.calibration,a.axesParameters.isDegrees,a.axesParameters.isClockwise))return}else if("TernaryAxes"===a.axesType){if(d.axes=new wpd.TernaryAxes,!d.axes.calibrate(d.calibration,a.axesParameters.isRange100,a.axesParameters.isNormalOrientation))return}else if("MapAxes"===a.axesType){if(d.axes=new wpd.MapAxes,
!d.axes.calibrate(d.calibration,a.axesParameters.scaleLength,a.axesParameters.unitString))return}else"ImageAxes"===a.axesType&&(d.axes=new wpd.ImageAxes);wpd.appData.isAligned(!0);if(null!=a.dataSeries){for(e=0;e<a.dataSeries.length;e++)for(g=a.dataSeries[e],d.dataSeriesColl[e]=new wpd.DataSeries,h=d.dataSeriesColl[e],h.name=g.name,c=0;c<g.data.length;c++)h.addPixel(g.data[c].x,g.data[c].y,g.data[c].metadata);if(null!=a.distanceMeasurementData)for(d.distanceMeasurementData=new wpd.ConnectedPoints(2),
e=0;e<a.distanceMeasurementData.length;e++)d.distanceMeasurementData.addConnection(a.distanceMeasurementData[e]);if(null!=a.angleMeasurementData)for(d.angleMeasurementData=new wpd.ConnectedPoints(3),e=0;e<a.angleMeasurementData.length;e++)d.angleMeasurementData.addConnection(a.angleMeasurementData[e])}}}function a(){var a=wpd.appData.getPlotData(),d=a.calibration,c={wpd:{version:[3,5],axesType:null,axesParameters:null,calibration:null,dataSeries:[],distanceMeasurementData:null,angleMeasurementData:null}},
e="",g,h;if(null!=d)for(c.wpd.calibration=[],e=0;e<d.getCount();e++)c.wpd.calibration[e]=d.getPoint(e);null!=a.axes&&(a.axes instanceof wpd.XYAxes?(c.wpd.axesType="XYAxes",c.wpd.axesParameters={isLogX:a.axes.isLogX(),isLogY:a.axes.isLogY()}):a.axes instanceof wpd.PolarAxes?(c.wpd.axesType="PolarAxes",c.wpd.axesParameters={isDegrees:a.axes.isThetaDegrees(),isClockwise:a.axes.isThetaClockwise()}):a.axes instanceof wpd.TernaryAxes?(c.wpd.axesType="TernaryAxes",c.wpd.axesParameters={isRange100:a.axes.isRange100(),
isNormalOrientation:a.axes.isNormalOrientation()}):a.axes instanceof wpd.MapAxes?(c.wpd.axesType="MapAxes",c.wpd.axesParameters={scaleLength:a.axes.getScaleLength(),unitString:a.axes.getUnits()}):a.axes instanceof wpd.ImageAxes&&(c.wpd.axesType="ImageAxes"));for(e=0;e<a.dataSeriesColl.length;e++)for(g=a.dataSeriesColl[e],c.wpd.dataSeries[e]={name:g.name,data:[]},d=0;d<g.getCount();d++)h=g.getPixel(d),c.wpd.dataSeries[e].data[d]=h,c.wpd.dataSeries[e].data[d].value=a.axes.pixelToData(h.x,h.y);if(null!=
a.distanceMeasurementData)for(c.wpd.distanceMeasurementData=[],e=0;e<a.distanceMeasurementData.connectionCount();e++)c.wpd.distanceMeasurementData[e]=a.distanceMeasurementData.getConnectionAt(e);if(null!=a.angleMeasurementData)for(c.wpd.angleMeasurementData=[],e=0;e<a.angleMeasurementData.connectionCount();e++)c.wpd.angleMeasurementData[e]=a.angleMeasurementData.getConnectionAt(e);return e=JSON.stringify(c)}return{save:function(){wpd.popup.show("export-json-window")},load:function(){wpd.popup.show("import-json-window")},
download:function(){wpd.download.json(a());wpd.popup.close("export-json-window")},read:function(){var a=document.getElementById("import-json-file");wpd.popup.close("import-json-window");if(1===a.files.length){var d=new FileReader;d.onload=function(){var a=JSON.parse(d.result);c(a);wpd.graphicsWidget.resetData();wpd.graphicsWidget.removeTool();wpd.graphicsWidget.removeRepainter();wpd.appData.isAligned()&&wpd.acquireData.load();wpd.messagePopup.show("Import JSON","JSON data has been loaded!")};d.readAsText(a.files[0])}}}}();
wpd=wpd||{};wpd.scriptInjector=function(){return{start:function(){wpd.popup.show("runScriptPopup")},cancel:function(){wpd.popup.close("runScriptPopup")},load:function(){var c=document.getElementById("runScriptFileInput");wpd.popup.close("runScriptPopup");if(1==c.files.length){var a=new FileReader;a.onload=function(){"undefined"!==typeof wpdscript&&delete wpdscript;eval(a.result);"wpdscript"!==typeof wpdscript&&(window.wpdscript=wpdscript,wpdscript.run())};a.readAsText(c.files[0])}}}}();wpd=wpd||{};
wpd.browserInfo=function(){return{checkBrowser:function(){window.FileReader||alert("\tWARNING!\nYour web browser is not supported. This program might not behave as intended. Please use a recent version of Google Chrome, Firefox or Safari browser.")}}}();
